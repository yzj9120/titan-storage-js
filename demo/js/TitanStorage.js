/*! For license information please see TitanStorage.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.TitanStorage=e():t.TitanStorage=e()}(this,(()=>(()=>{var __webpack_modules__={45:t=>{"use strict";t.exports=function(t,e){var r=new Array(arguments.length-1),n=0,o=2,i=!0;for(;o<arguments.length;)r[n++]=arguments[o++];return new Promise((function(o,a){r[n]=function(t){if(i)if(i=!1,t)a(t);else{for(var e=new Array(arguments.length-1),r=0;r<e.length;)e[r++]=arguments[r];o.apply(null,e)}};try{t.apply(e||null,r)}catch(t){i&&(i=!1,a(t))}}))}},839:(t,e)=>{"use strict";var r=e;r.length=function(t){var e=t.length;if(!e)return 0;for(var r=0;--e%4>1&&"="===t.charAt(e);)++r;return Math.ceil(3*t.length)/4-r};for(var n=new Array(64),o=new Array(123),i=0;i<64;)o[n[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;r.encode=function(t,e,r){for(var o,i=null,a=[],s=0,u=0;e<r;){var c=t[e++];switch(u){case 0:a[s++]=n[c>>2],o=(3&c)<<4,u=1;break;case 1:a[s++]=n[o|c>>4],o=(15&c)<<2,u=2;break;case 2:a[s++]=n[o|c>>6],a[s++]=n[63&c],u=0}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),s=0)}return u&&(a[s++]=n[o],a[s++]=61,1===u&&(a[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,a.slice(0,s))),i.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var a="invalid encoding";r.decode=function(t,e,r){for(var n,i=r,s=0,u=0;u<t.length;){var c=t.charCodeAt(u++);if(61===c&&s>1)break;if(void 0===(c=o[c]))throw Error(a);switch(s){case 0:n=c,s=1;break;case 1:e[r++]=n<<2|(48&c)>>4,n=c,s=2;break;case 2:e[r++]=(15&n)<<4|(60&c)>>2,n=c,s=3;break;case 3:e[r++]=(3&n)<<6|c,s=0}}if(1===s)throw Error(a);return r-i},r.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}},358:t=>{"use strict";function e(){this._listeners={}}t.exports=e,e.prototype.on=function(t,e,r){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:r||this}),this},e.prototype.off=function(t,e){if(void 0===t)this._listeners={};else if(void 0===e)this._listeners[t]=[];else for(var r=this._listeners[t],n=0;n<r.length;)r[n].fn===e?r.splice(n,1):++n;return this},e.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<e.length;)e[n].fn.apply(e[n++].ctx,r)}return this}},410:t=>{"use strict";function e(t){return"undefined"!=typeof Float32Array?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=128===r[3];function o(t,n,o){e[0]=t,n[o]=r[0],n[o+1]=r[1],n[o+2]=r[2],n[o+3]=r[3]}function i(t,n,o){e[0]=t,n[o]=r[3],n[o+1]=r[2],n[o+2]=r[1],n[o+3]=r[0]}function a(t,n){return r[0]=t[n],r[1]=t[n+1],r[2]=t[n+2],r[3]=t[n+3],e[0]}function s(t,n){return r[3]=t[n],r[2]=t[n+1],r[1]=t[n+2],r[0]=t[n+3],e[0]}t.writeFloatLE=n?o:i,t.writeFloatBE=n?i:o,t.readFloatLE=n?a:s,t.readFloatBE=n?s:a}():function(){function e(t,e,r,n){var o=e<0?1:0;if(o&&(e=-e),0===e)t(1/e>0?0:2147483648,r,n);else if(isNaN(e))t(2143289344,r,n);else if(e>34028234663852886e22)t((o<<31|2139095040)>>>0,r,n);else if(e<11754943508222875e-54)t((o<<31|Math.round(e/1401298464324817e-60))>>>0,r,n);else{var i=Math.floor(Math.log(e)/Math.LN2);t((o<<31|i+127<<23|8388607&Math.round(e*Math.pow(2,-i)*8388608))>>>0,r,n)}}function a(t,e,r){var n=t(e,r),o=2*(n>>31)+1,i=n>>>23&255,a=8388607&n;return 255===i?a?NaN:o*(1/0):0===i?1401298464324817e-60*o*a:o*Math.pow(2,i-150)*(a+8388608)}t.writeFloatLE=e.bind(null,r),t.writeFloatBE=e.bind(null,n),t.readFloatLE=a.bind(null,o),t.readFloatBE=a.bind(null,i)}(),"undefined"!=typeof Float64Array?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=128===r[7];function o(t,n,o){e[0]=t,n[o]=r[0],n[o+1]=r[1],n[o+2]=r[2],n[o+3]=r[3],n[o+4]=r[4],n[o+5]=r[5],n[o+6]=r[6],n[o+7]=r[7]}function i(t,n,o){e[0]=t,n[o]=r[7],n[o+1]=r[6],n[o+2]=r[5],n[o+3]=r[4],n[o+4]=r[3],n[o+5]=r[2],n[o+6]=r[1],n[o+7]=r[0]}function a(t,n){return r[0]=t[n],r[1]=t[n+1],r[2]=t[n+2],r[3]=t[n+3],r[4]=t[n+4],r[5]=t[n+5],r[6]=t[n+6],r[7]=t[n+7],e[0]}function s(t,n){return r[7]=t[n],r[6]=t[n+1],r[5]=t[n+2],r[4]=t[n+3],r[3]=t[n+4],r[2]=t[n+5],r[1]=t[n+6],r[0]=t[n+7],e[0]}t.writeDoubleLE=n?o:i,t.writeDoubleBE=n?i:o,t.readDoubleLE=n?a:s,t.readDoubleBE=n?s:a}():function(){function e(t,e,r,n,o,i){var a=n<0?1:0;if(a&&(n=-n),0===n)t(0,o,i+e),t(1/n>0?0:2147483648,o,i+r);else if(isNaN(n))t(0,o,i+e),t(2146959360,o,i+r);else if(n>17976931348623157e292)t(0,o,i+e),t((a<<31|2146435072)>>>0,o,i+r);else{var s;if(n<22250738585072014e-324)t((s=n/5e-324)>>>0,o,i+e),t((a<<31|s/4294967296)>>>0,o,i+r);else{var u=Math.floor(Math.log(n)/Math.LN2);1024===u&&(u=1023),t(4503599627370496*(s=n*Math.pow(2,-u))>>>0,o,i+e),t((a<<31|u+1023<<20|1048576*s&1048575)>>>0,o,i+r)}}}function a(t,e,r,n,o){var i=t(n,o+e),a=t(n,o+r),s=2*(a>>31)+1,u=a>>>20&2047,c=4294967296*(1048575&a)+i;return 2047===u?c?NaN:s*(1/0):0===u?5e-324*s*c:s*Math.pow(2,u-1075)*(c+4503599627370496)}t.writeDoubleLE=e.bind(null,r,0,4),t.writeDoubleBE=e.bind(null,n,4,0),t.readDoubleLE=a.bind(null,o,0,4),t.readDoubleBE=a.bind(null,i,4,0)}(),t}function r(t,e,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function n(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=255&t}function o(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function i(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}t.exports=e(e)},153:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}module.exports=inquire},390:t=>{"use strict";t.exports=function(t,e,r){var n=r||8192,o=n>>>1,i=null,a=n;return function(r){if(r<1||r>o)return t(r);a+r>n&&(i=t(n),a=0);var s=e.call(i,a,a+=r);return 7&a&&(a=1+(7|a)),s}}},447:(t,e)=>{"use strict";var r=e;r.length=function(t){for(var e=0,r=0,n=0;n<t.length;++n)(r=t.charCodeAt(n))<128?e+=1:r<2048?e+=2:55296==(64512&r)&&56320==(64512&t.charCodeAt(n+1))?(++n,e+=4):e+=3;return e},r.read=function(t,e,r){if(r-e<1)return"";for(var n,o=null,i=[],a=0;e<r;)(n=t[e++])<128?i[a++]=n:n>191&&n<224?i[a++]=(31&n)<<6|63&t[e++]:n>239&&n<365?(n=((7&n)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536,i[a++]=55296+(n>>10),i[a++]=56320+(1023&n)):i[a++]=(15&n)<<12|(63&t[e++])<<6|63&t[e++],a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,i)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,i.slice(0,a))),o.join("")):String.fromCharCode.apply(String,i.slice(0,a))},r.write=function(t,e,r){for(var n,o,i=r,a=0;a<t.length;++a)(n=t.charCodeAt(a))<128?e[r++]=n:n<2048?(e[r++]=n>>6|192,e[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(o=t.charCodeAt(a+1)))?(n=65536+((1023&n)<<10)+(1023&o),++a,e[r++]=n>>18|240,e[r++]=n>>12&63|128,e[r++]=n>>6&63|128,e[r++]=63&n|128):(e[r++]=n>>12|224,e[r++]=n>>6&63|128,e[r++]=63&n|128);return r-i}},437:(t,e,r)=>{t.exports=r(327)},327:function(t,e){!function(r,n){"use strict";var o={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function i(t){if(!Array.isArray(t)&&!ArrayBuffer.isView(t))return!1;for(var e=0;e<t.length;e++)if(!Number.isInteger(t[e])||t[e]<0||t[e]>255)return!1;return!0}function a(t,e){return(65535&t)*e+(((t>>>16)*e&65535)<<16)}function s(t,e){return t<<e|t>>>32-e}function u(t){return t=a(t^=t>>>16,2246822507),t=a(t^=t>>>13,3266489909),t^=t>>>16}function c(t,e){t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]],e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]];var r=[0,0,0,0];return r[3]+=t[3]+e[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=t[2]+e[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=t[1]+e[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=t[0]+e[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function l(t,e){t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]],e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]];var r=[0,0,0,0];return r[3]+=t[3]*e[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=t[2]*e[3],r[1]+=r[2]>>>16,r[2]&=65535,r[2]+=t[3]*e[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=t[1]*e[3],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=t[2]*e[2],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=t[3]*e[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=t[0]*e[3]+t[1]*e[2]+t[2]*e[1]+t[3]*e[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function f(t,e){return 32===(e%=64)?[t[1],t[0]]:e<32?[t[0]<<e|t[1]>>>32-e,t[1]<<e|t[0]>>>32-e]:(e-=32,[t[1]<<e|t[0]>>>32-e,t[0]<<e|t[1]>>>32-e])}function h(t,e){return 0===(e%=64)?t:e<32?[t[0]<<e|t[1]>>>32-e,t[1]<<e]:[t[1]<<e-32,0]}function p(t,e){return[t[0]^e[0],t[1]^e[1]]}function d(t){return t=p(t,[0,t[0]>>>1]),t=p(t=l(t,[4283543511,3981806797]),[0,t[0]>>>1]),t=p(t=l(t,[3301882366,444984403]),[0,t[0]>>>1])}o.x86.hash32=function(t,e){if(o.inputValidation&&!i(t))return n;e=e||0;for(var r=t.length%4,c=t.length-r,l=e,f=0,h=3432918353,p=461845907,d=0;d<c;d+=4)f=a(f=t[d]|t[d+1]<<8|t[d+2]<<16|t[d+3]<<24,h),f=a(f=s(f,15),p),l=a(l=s(l^=f,13),5)+3864292196;switch(f=0,r){case 3:f^=t[d+2]<<16;case 2:f^=t[d+1]<<8;case 1:f=a(f^=t[d],h),l^=f=a(f=s(f,15),p)}return(l=u(l^=t.length))>>>0},o.x86.hash128=function(t,e){if(o.inputValidation&&!i(t))return n;e=e||0;for(var r=t.length%16,c=t.length-r,l=e,f=e,h=e,p=e,d=0,y=0,g=0,b=0,m=597399067,v=2869860233,w=951274213,k=2716044179,E=0;E<c;E+=16)d=t[E]|t[E+1]<<8|t[E+2]<<16|t[E+3]<<24,y=t[E+4]|t[E+5]<<8|t[E+6]<<16|t[E+7]<<24,g=t[E+8]|t[E+9]<<8|t[E+10]<<16|t[E+11]<<24,b=t[E+12]|t[E+13]<<8|t[E+14]<<16|t[E+15]<<24,d=s(d=a(d,m),15),l=s(l^=d=a(d,v),19),l=a(l+=f,5)+1444728091,y=s(y=a(y,v),16),f=s(f^=y=a(y,w),17),f=a(f+=h,5)+197830471,g=s(g=a(g,w),17),h=s(h^=g=a(g,k),15),h=a(h+=p,5)+2530024501,b=s(b=a(b,k),18),p=s(p^=b=a(b,m),13),p=a(p+=l,5)+850148119;switch(d=0,y=0,g=0,b=0,r){case 15:b^=t[E+14]<<16;case 14:b^=t[E+13]<<8;case 13:b=a(b^=t[E+12],k),p^=b=a(b=s(b,18),m);case 12:g^=t[E+11]<<24;case 11:g^=t[E+10]<<16;case 10:g^=t[E+9]<<8;case 9:g=a(g^=t[E+8],w),h^=g=a(g=s(g,17),k);case 8:y^=t[E+7]<<24;case 7:y^=t[E+6]<<16;case 6:y^=t[E+5]<<8;case 5:y=a(y^=t[E+4],v),f^=y=a(y=s(y,16),w);case 4:d^=t[E+3]<<24;case 3:d^=t[E+2]<<16;case 2:d^=t[E+1]<<8;case 1:d=a(d^=t[E],m),l^=d=a(d=s(d,15),v)}return l^=t.length,l+=f^=t.length,l+=h^=t.length,f+=l+=p^=t.length,h+=l,p+=l,l=u(l),l+=f=u(f),l+=h=u(h),f+=l+=p=u(p),h+=l,p+=l,("00000000"+(l>>>0).toString(16)).slice(-8)+("00000000"+(f>>>0).toString(16)).slice(-8)+("00000000"+(h>>>0).toString(16)).slice(-8)+("00000000"+(p>>>0).toString(16)).slice(-8)},o.x64.hash128=function(t,e){if(o.inputValidation&&!i(t))return n;e=e||0;for(var r=t.length%16,a=t.length-r,s=[0,e],u=[0,e],y=[0,0],g=[0,0],b=[2277735313,289559509],m=[1291169091,658871167],v=0;v<a;v+=16)y=[t[v+4]|t[v+5]<<8|t[v+6]<<16|t[v+7]<<24,t[v]|t[v+1]<<8|t[v+2]<<16|t[v+3]<<24],g=[t[v+12]|t[v+13]<<8|t[v+14]<<16|t[v+15]<<24,t[v+8]|t[v+9]<<8|t[v+10]<<16|t[v+11]<<24],y=f(y=l(y,b),31),s=c(s=f(s=p(s,y=l(y,m)),27),u),s=c(l(s,[0,5]),[0,1390208809]),g=f(g=l(g,m),33),u=c(u=f(u=p(u,g=l(g,b)),31),s),u=c(l(u,[0,5]),[0,944331445]);switch(y=[0,0],g=[0,0],r){case 15:g=p(g,h([0,t[v+14]],48));case 14:g=p(g,h([0,t[v+13]],40));case 13:g=p(g,h([0,t[v+12]],32));case 12:g=p(g,h([0,t[v+11]],24));case 11:g=p(g,h([0,t[v+10]],16));case 10:g=p(g,h([0,t[v+9]],8));case 9:g=l(g=p(g,[0,t[v+8]]),m),u=p(u,g=l(g=f(g,33),b));case 8:y=p(y,h([0,t[v+7]],56));case 7:y=p(y,h([0,t[v+6]],48));case 6:y=p(y,h([0,t[v+5]],40));case 5:y=p(y,h([0,t[v+4]],32));case 4:y=p(y,h([0,t[v+3]],24));case 3:y=p(y,h([0,t[v+2]],16));case 2:y=p(y,h([0,t[v+1]],8));case 1:y=l(y=p(y,[0,t[v]]),b),s=p(s,y=l(y=f(y,31),m))}return s=c(s=p(s,[0,t.length]),u=p(u,[0,t.length])),u=c(u,s),s=c(s=d(s),u=d(u)),u=c(u,s),("00000000"+(s[0]>>>0).toString(16)).slice(-8)+("00000000"+(s[1]>>>0).toString(16)).slice(-8)+("00000000"+(u[0]>>>0).toString(16)).slice(-8)+("00000000"+(u[1]>>>0).toString(16)).slice(-8)},t.exports&&(e=t.exports=o),e.murmurHash3=o}()},946:(t,e,r)=>{"use strict";t.exports=r(394)},394:(t,e,r)=>{"use strict";var n=e;function o(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=r(449),n.BufferWriter=r(818),n.Reader=r(237),n.BufferReader=r(158),n.util=r(610),n.rpc=r(47),n.roots=r(529),n.configure=o,o()},237:(t,e,r)=>{"use strict";t.exports=u;var n,o=r(610),i=o.LongBits,a=o.utf8;function s(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function u(t){this.buf=t,this.pos=0,this.len=t.length}var c,l="undefined"!=typeof Uint8Array?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new u(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new u(t);throw Error("illegal buffer")},f=function(){return o.Buffer?function(t){return(u.create=function(t){return o.Buffer.isBuffer(t)?new n(t):l(t)})(t)}:l};function h(){var t=new i(0,0),e=0;if(!(this.len-this.pos>4)){for(;e<3;++e){if(this.pos>=this.len)throw s(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*e)>>>0,t}for(;e<4;++e)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(e=0,this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw s(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}function p(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}function d(){if(this.pos+8>this.len)throw s(this,8);return new i(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}u.create=f(),u.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,u.prototype.uint32=(c=4294967295,function(){if(c=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return c;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return c}),u.prototype.int32=function(){return 0|this.uint32()},u.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(1&t)},u.prototype.bool=function(){return 0!==this.uint32()},u.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return p(this.buf,this.pos+=4)},u.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|p(this.buf,this.pos+=4)},u.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var t=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t},u.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var t=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t},u.prototype.bytes=function(){var t=this.uint32(),e=this.pos,r=this.pos+t;if(r>this.len)throw s(this,t);if(this.pos+=t,Array.isArray(this.buf))return this.buf.slice(e,r);if(e===r){var n=o.Buffer;return n?n.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,e,r)},u.prototype.string=function(){var t=this.bytes();return a.read(t,0,t.length)},u.prototype.skip=function(t){if("number"==typeof t){if(this.pos+t>this.len)throw s(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},u.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(t=7&this.uint32());)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this},u._configure=function(t){n=t,u.create=f(),n._configure();var e=o.Long?"toLong":"toNumber";o.merge(u.prototype,{int64:function(){return h.call(this)[e](!1)},uint64:function(){return h.call(this)[e](!0)},sint64:function(){return h.call(this).zzDecode()[e](!1)},fixed64:function(){return d.call(this)[e](!0)},sfixed64:function(){return d.call(this)[e](!1)}})}},158:(t,e,r)=>{"use strict";t.exports=i;var n=r(237);(i.prototype=Object.create(n.prototype)).constructor=i;var o=r(610);function i(t){n.call(this,t)}i._configure=function(){o.Buffer&&(i.prototype._slice=o.Buffer.prototype.slice)},i.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))},i._configure()},529:t=>{"use strict";t.exports={}},47:(t,e,r)=>{"use strict";e.Service=r(595)},595:(t,e,r)=>{"use strict";t.exports=o;var n=r(610);function o(t,e,r){if("function"!=typeof t)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}(o.prototype=Object.create(n.EventEmitter.prototype)).constructor=o,o.prototype.rpcCall=function t(e,r,o,i,a){if(!i)throw TypeError("request must be specified");var s=this;if(!a)return n.asPromise(t,s,e,r,o,i);if(s.rpcImpl)try{return s.rpcImpl(e,r[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(t,r){if(t)return s.emit("error",t,e),a(t);if(null!==r){if(!(r instanceof o))try{r=o[s.responseDelimited?"decodeDelimited":"decode"](r)}catch(t){return s.emit("error",t,e),a(t)}return s.emit("data",r,e),a(null,r)}s.end(!0)}))}catch(t){return s.emit("error",t,e),void setTimeout((function(){a(t)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},o.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},239:(t,e,r)=>{"use strict";t.exports=o;var n=r(610);function o(t,e){this.lo=t>>>0,this.hi=e>>>0}var i=o.zero=new o(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var a=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(t){if(0===t)return i;var e=t<0;e&&(t=-t);var r=t>>>0,n=(t-r)/4294967296>>>0;return e&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new o(r,n)},o.from=function(t){if("number"==typeof t)return o.fromNumber(t);if(n.isString(t)){if(!n.Long)return o.fromNumber(parseInt(t,10));t=n.Long.fromString(t)}return t.low||t.high?new o(t.low>>>0,t.high>>>0):i},o.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var e=1+~this.lo>>>0,r=~this.hi>>>0;return e||(r=r+1>>>0),-(e+4294967296*r)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(t){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(t)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(t)}};var s=String.prototype.charCodeAt;o.fromHash=function(t){return t===a?i:new o((s.call(t,0)|s.call(t,1)<<8|s.call(t,2)<<16|s.call(t,3)<<24)>>>0,(s.call(t,4)|s.call(t,5)<<8|s.call(t,6)<<16|s.call(t,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this},o.prototype.zzDecode=function(){var t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this},o.prototype.length=function(){var t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===e?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:r<128?9:10}},610:function(t,e,r){"use strict";var n=e;function o(t,e,r){for(var n=Object.keys(e),o=0;o<n.length;++o)void 0!==t[n[o]]&&r||(t[n[o]]=e[n[o]]);return t}function i(t){function e(t,r){if(!(this instanceof e))return new e(t,r);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&o(this,r)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}n.asPromise=r(45),n.base64=r(839),n.EventEmitter=r(358),n.float=r(410),n.inquire=r(153),n.utf8=r(447),n.pool=r(390),n.LongBits=r(239),n.isNode=Boolean(void 0!==r.g&&r.g&&r.g.process&&r.g.process.versions&&r.g.process.versions.node),n.global=n.isNode&&r.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},n.isString=function(t){return"string"==typeof t||t instanceof String},n.isObject=function(t){return t&&"object"==typeof t},n.isset=n.isSet=function(t,e){var r=t[e];return!(null==r||!t.hasOwnProperty(e))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var t=n.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(t){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(t){return"number"==typeof t?n.Buffer?n._Buffer_allocUnsafe(t):new n.Array(t):n.Buffer?n._Buffer_from(t):"undefined"==typeof Uint8Array?t:new Uint8Array(t)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(t){return t?n.LongBits.from(t).toHash():n.LongBits.zeroHash},n.longFromHash=function(t,e){var r=n.LongBits.fromHash(t);return n.Long?n.Long.fromBits(r.lo,r.hi,e):r.toNumber(Boolean(e))},n.merge=o,n.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)},n.newError=i,n.ProtocolError=i("ProtocolError"),n.oneOfGetter=function(t){for(var e={},r=0;r<t.length;++r)e[t[r]]=1;return function(){for(var t=Object.keys(this),r=t.length-1;r>-1;--r)if(1===e[t[r]]&&void 0!==this[t[r]]&&null!==this[t[r]])return t[r]}},n.oneOfSetter=function(t){return function(e){for(var r=0;r<t.length;++r)t[r]!==e&&delete this[t[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var t=n.Buffer;t?(n._Buffer_from=t.from!==Uint8Array.from&&t.from||function(e,r){return new t(e,r)},n._Buffer_allocUnsafe=t.allocUnsafe||function(e){return new t(e)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},449:(t,e,r)=>{"use strict";t.exports=f;var n,o=r(610),i=o.LongBits,a=o.base64,s=o.utf8;function u(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function c(){}function l(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function f(){this.len=0,this.head=new u(c,0,0),this.tail=this.head,this.states=null}var h=function(){return o.Buffer?function(){return(f.create=function(){return new n})()}:function(){return new f}};function p(t,e,r){e[r]=255&t}function d(t,e){this.len=t,this.next=void 0,this.val=e}function y(t,e,r){for(;t.hi;)e[r++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=127&t.lo|128,t.lo=t.lo>>>7;e[r++]=t.lo}function g(t,e,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}f.create=h(),f.alloc=function(t){return new o.Array(t)},o.Array!==Array&&(f.alloc=o.pool(f.alloc,o.Array.prototype.subarray)),f.prototype._push=function(t,e,r){return this.tail=this.tail.next=new u(t,e,r),this.len+=e,this},d.prototype=Object.create(u.prototype),d.prototype.fn=function(t,e,r){for(;t>127;)e[r++]=127&t|128,t>>>=7;e[r]=t},f.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new d((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this},f.prototype.int32=function(t){return t<0?this._push(y,10,i.fromNumber(t)):this.uint32(t)},f.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)},f.prototype.uint64=function(t){var e=i.from(t);return this._push(y,e.length(),e)},f.prototype.int64=f.prototype.uint64,f.prototype.sint64=function(t){var e=i.from(t).zzEncode();return this._push(y,e.length(),e)},f.prototype.bool=function(t){return this._push(p,1,t?1:0)},f.prototype.fixed32=function(t){return this._push(g,4,t>>>0)},f.prototype.sfixed32=f.prototype.fixed32,f.prototype.fixed64=function(t){var e=i.from(t);return this._push(g,4,e.lo)._push(g,4,e.hi)},f.prototype.sfixed64=f.prototype.fixed64,f.prototype.float=function(t){return this._push(o.float.writeFloatLE,4,t)},f.prototype.double=function(t){return this._push(o.float.writeDoubleLE,8,t)};var b=o.Array.prototype.set?function(t,e,r){e.set(t,r)}:function(t,e,r){for(var n=0;n<t.length;++n)e[r+n]=t[n]};f.prototype.bytes=function(t){var e=t.length>>>0;if(!e)return this._push(p,1,0);if(o.isString(t)){var r=f.alloc(e=a.length(t));a.decode(t,r,0),t=r}return this.uint32(e)._push(b,e,t)},f.prototype.string=function(t){var e=s.length(t);return e?this.uint32(e)._push(s.write,e,t):this._push(p,1,0)},f.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new u(c,0,0),this.len=0,this},f.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new u(c,0,0),this.len=0),this},f.prototype.ldelim=function(){var t=this.head,e=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=t.next,this.tail=e,this.len+=r),this},f.prototype.finish=function(){for(var t=this.head.next,e=this.constructor.alloc(this.len),r=0;t;)t.fn(t.val,e,r),r+=t.len,t=t.next;return e},f._configure=function(t){n=t,f.create=h(),n._configure()}},818:(t,e,r)=>{"use strict";t.exports=i;var n=r(449);(i.prototype=Object.create(n.prototype)).constructor=i;var o=r(610);function i(){n.call(this)}function a(t,e,r){t.length<40?o.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}i._configure=function(){i.alloc=o._Buffer_allocUnsafe,i.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&"set"===o.Buffer.prototype.set.name?function(t,e,r){e.set(t,r)}:function(t,e,r){if(t.copy)t.copy(e,r,0,t.length);else for(var n=0;n<t.length;)e[r++]=t[n++]}},i.prototype.bytes=function(t){o.isString(t)&&(t=o._Buffer_from(t,"base64"));var e=t.length>>>0;return this.uint32(e),e&&this._push(i.writeBytesBuffer,e,t),this},i.prototype.string=function(t){var e=o.Buffer.byteLength(t);return this.uint32(e),e&&this._push(a,e,t),this},i._configure()},797:t=>{t.exports=function t(n,o){var i,a=0,s=0,u=o=o||0,c=n.length;do{if(u>=c||s>49)throw t.bytes=0,new RangeError("Could not decode varint");i=n[u++],a+=s<28?(i&r)<<s:(i&r)*Math.pow(2,s),s+=7}while(i>=e);return t.bytes=u-o,a};var e=128,r=127},877:t=>{t.exports=function t(o,i,a){if(Number.MAX_SAFE_INTEGER&&o>Number.MAX_SAFE_INTEGER)throw t.bytes=0,new RangeError("Could not encode varint");i=i||[];var s=a=a||0;for(;o>=n;)i[a++]=255&o|e,o/=128;for(;o&r;)i[a++]=255&o|e,o>>>=7;return i[a]=0|o,t.bytes=a-s+1,i};var e=128,r=-128,n=Math.pow(2,31)},203:(t,e,r)=>{t.exports={encode:r(877),decode:r(797),encodingLength:r(867)}},867:t=>{var e=Math.pow(2,7),r=Math.pow(2,14),n=Math.pow(2,21),o=Math.pow(2,28),i=Math.pow(2,35),a=Math.pow(2,42),s=Math.pow(2,49),u=Math.pow(2,56),c=Math.pow(2,63);t.exports=function(t){return t<e?1:t<r?2:t<n?3:t<o?4:t<i?5:t<a?6:t<s?7:t<u?8:t<c?9:10}}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var r=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.d=(t,e)=>{for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.d(__webpack_exports__,{default:()=>cu});var t={};__webpack_require__.r(t),__webpack_require__.d(t,{DEFAULT_DIRECTORY_MODE:()=>we,DEFAULT_FILE_MODE:()=>ve,NodeType:()=>ye,code:()=>ke,createAdvancedFile:()=>Ae,createComplexFile:()=>Oe,createDirectoryShard:()=>Ne,createEmptyFile:()=>Le,createFileChunk:()=>Te,createFileShard:()=>Re,createFlatDirectory:()=>Ie,createRaw:()=>xe,createShardedDirectory:()=>De,createSimpleFile:()=>Se,createSymlink:()=>qe,cumulativeContentByteLength:()=>Xe,cumulativeDagByteLength:()=>tr,decode:()=>Ke,decodeMetadata:()=>ir,encode:()=>We,encodeAdvancedFile:()=>Fe,encodeComplexFile:()=>Me,encodeDirectory:()=>He,encodeDirectoryMetadata:()=>nr,encodeFile:()=>je,encodeFileChunk:()=>ze,encodeFileShard:()=>Be,encodeHAMTShard:()=>Ge,encodeLink:()=>Ce,encodeMetadata:()=>or,encodeMode:()=>sr,encodeRaw:()=>Pe,encodeSimpleFile:()=>Ue,encodeSymlink:()=>Ye,filesize:()=>pr,matchFile:()=>cr,name:()=>Ee});var e={};__webpack_require__.r(e),__webpack_require__.d(e,{context:()=>Tn,cut:()=>On,name:()=>Sn,type:()=>An,withMaxChunkSize:()=>Rn});var r={};__webpack_require__.r(r);var n={};__webpack_require__.r(n),__webpack_require__.d(n,{API:()=>r,and:()=>lo,bitCount:()=>co,empty:()=>ro,from:()=>no,fromBytes:()=>po,get:()=>uo,or:()=>fo,popcount:()=>io,set:()=>ao,size:()=>oo,toBytes:()=>ho,unset:()=>so});var o={};__webpack_require__.r(o),__webpack_require__.d(o,{configure:()=>mo,hash32:()=>bo});var i={};__webpack_require__.r(i),__webpack_require__.d(i,{API:()=>r,and:()=>di,empty:()=>ri,from:()=>ni,fromBytes:()=>fi,get:()=>ci,or:()=>pi,popcount:()=>hi,set:()=>si,size:()=>oi,toBytes:()=>li,unset:()=>ui});var a={};__webpack_require__.r(a),__webpack_require__.d(a,{code:()=>Hi,decode:()=>$i,encode:()=>Gi,name:()=>Mi});const s={OK:200,CREATED:201,NO_CONTENT:204,BAD_REQUEST:400,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,INTERNAL_SERVER_ERROR:500,SERVICE_UNAVAILABLE:503,Sdk_OK:0,InitSdk_ERROR:1001,API_KEY_EMPTY:1002,INVALID_API_KEY:1003,RESOURCE_NOT_AVAILABLE:1004,FILE_NAME_KEY_EMPTY:1005,ID_KEY_EMPTY:1006,PARENT_ID_ERROR:1004,SHARE_ERROE:1007,ASSEST_OBJ_ERROR:1008,INVALID_PASSWORD:1009,FETCH_ERROR:10010,PARENT_ID_INVALID:10011,PAGE_ERROR:10012,PAGESIZE_ERROR:10013,MISSING_FIELDS_ERROR:10014,UPLOAD_FILE_ERROR:10015,AREA_ID_ERROR:10016,Group_ID_ERROR:10017,Asset_Type_ERROR:10018,Dowload_URL_ERROR:10019,Dowload_ERROR:10020,ASSEST_ID_ERROR:10021,Dowload_Type_ERROR:10022,REPORT_ERROR:10023,INVALID_EXPIRE_AT:10024,ASSET_OBJ_ERROR:10025,REQUEST_ERROR:10026};function u(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&(Object.keys(e).length>0?console.log(t,e):console.log(t))}function c(t,e){var r=function(t,e){var r;switch(t){case s.BAD_REQUEST:r="The request was invalid. Please check your input.";break;case s.UNAUTHORIZED:r="You are not authorized. Please check your credentials.";break;case s.FORBIDDEN:r="You do not have permission to access this resource.";break;case s.NOT_FOUND:r="The requested resource could not be found.";break;case s.INTERNAL_SERVER_ERROR:r="An error occurred on the server. Please try again later.";break;case s.SERVICE_UNAVAILABLE:r="The service is currently unavailable. Please try again later.";break;case s.API_KEY_EMPTY:r="API toekn is required and cannot be empty.";break;case s.INVALID_API_KEY:r="The provided API Key is invalid.";break;case s.RESOURCE_NOT_AVAILABLE:r="The requested resource is not available.";break;case s.ID_KEY_EMPTY:r="ID is required but was not provided.";break;case s.FILE_NAME_KEY_EMPTY:r="Name is required but was not provided.";break;case s.PARENT_ID_ERROR:r="Parent ID is required but was incorrect.";break;case s.SHARE_ERROE:r="The file cannot be shared.";break;case s.ASSEST_OBJ_ERROR:r="assetDetail must be an object.";break;case s.PARENT_ID_INVALID:r="Invalid 'parent' parameter. It should be a non-negative number.";break;case s.PAGE_ERROR:r="Invalid 'page' parameter. It should be a positive number.";break;case s.PAGESIZE_ERROR:r="Invalid 'pageSize' parameter. It should be a non-negative number.";break;case s.MISSING_FIELDS_ERROR:r="Missing required fields in assetDetail";break;case s.INVALID_PASSWORD:r="Invalid shortPass format. It should be a 6-character alphanumeric string.";break;case s.AREA_ID_ERROR:r="area_id should be an array.";break;case s.Group_ID_ERROR:r="group_id should be a non-negative integer.";break;case s.Asset_Type_ERROR:r="asset_type should be 0 or 1.";break;case s.Sdk_OK:r="TitanSDK initialized successfully";break;case s.InitSdk_ERROR:r="Failed to initialize TitanSDK";break;case s.Dowload_URL_ERROR:r="No available download address";break;case s.Dowload_Type_ERROR:r="Download type not found";break;default:r="An unknown error occurred."}return{statusCode:t,errorMessage:e||r}}(t,e);return{code:r.statusCode,msg:r.errorMessage}}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,h(n.key),n)}}function h(t){var e=function(t,e){if("object"!=l(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==l(e)?e:e+""}var p=function(){return t=function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.token=e,this.url=r,this.debug=n,this.url||(this.url="https://api-test1.container1.titannet.io"),e&&""!==e.trim()||u(s.API_KEY_EMPTY,"")},e=[{key:"updateToken",value:function(t){return t&&""!==t.trim()?(this.token=t,{code:0,msg:"PI token updated successfully",data:{}}):c(s.API_KEY_EMPTY,"Failed to update API key. New API token is empty.")}},{key:"getData",value:function(t){var e="".concat(this.url).concat(t);return this.token&&""!==this.token.trim()?(u("Fetching data from URL:",e),fetch(e,{method:"GET",headers:{"Content-Type":"application/json",JwtAuthorization:"Bearer "+this.token}}).then((function(t){return t.ok?t.json():t.text().then((function(e){c(t.status,e)}))})).then((function(t){return u("Data fetched successfully:",t),t})).catch((function(t){return c(s.FETCH_ERROR,t.message)}))):c(s.API_KEY_EMPTY,"")}},{key:"postData",value:function(t,e){var r="".concat(this.url).concat(t);return this.token&&""!==this.token.trim()?(u("Posting data to URL:",r),fetch(r,{method:"POST",headers:{"Content-Type":"application/json",JwtAuthorization:"Bearer "+this.token},body:JSON.stringify(e)}).then((function(t){return t.ok?t.json():t.text().then((function(e){var r="Error ".concat(t.status,": ").concat(e);return Promise.reject(c(t.status,r))}))})).then((function(t){return u("Data posted successfully:",t),t})).catch((function(t){return u("Data posted error:",t),c(s.FETCH_ERROR,t.message)}))):c(s.API_KEY_EMPTY,"")}},{key:"uploadFile",value:function(t,e,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;return new Promise((function(l,f){var h=new XMLHttpRequest,p="".concat(t);if(!n.token||""===n.token.trim())return c(s.API_KEY_EMPTY,"");h.open("POST",p,!0),h.setRequestHeader("JwtAuthorization","Bearer "+n.token),h.setRequestHeader("Authorization","Bearer "+e),h.upload.onprogress=function(t){if(t.lengthComputable&&i){var e=t.loaded/t.total*100;i(t.loaded,t.total,e)}},h.onload=function(){if(h.status>=200&&h.status<300){var t=JSON.parse(h.responseText);u("File uploaded successfully:",t),l(t)}else u("File uploaded:",h.status),f(c(h.status,h.responseText))},h.onerror=function(){var t="File upload failed: ".concat(h.statusText||"Handle network errors");f(c(s.FETCH_ERROR,t))},a.addEventListener("abort",(function(){h.abort()}));var d=new FormData;for(var y in d.append("file",r),o)o.hasOwnProperty(y)&&d.append(y,o[y]);h.send(d)}))}}],e&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),d=function(t){if(!t||""===t.trim())return c(s.API_KEY_EMPTY,"API token is required and cannot be empty.")},y=function(t){if(!t||""===t.trim())return c(s.FILE_NAME_KEY_EMPTY,"Group name cannot be empty.")},g=function(t){if(!t||""===t.trim())return c(s.ASSEST_ID_ERROR,"assetCid cannot be empty.")},b=function(t){if(!Array.isArray(t))return c(s.AREA_ID_ERROR,"area_id should be an array.")},m=function(t){if(!Number.isInteger(t)||t<0)return c(s.Group_ID_ERROR,"group_id should be a non-negative integer")},v=function(t){if(0!==t&&1!==t)return c(s.Asset_Type_ERROR,"asset_type should be 0 or 1.")},w=function(t){if("number"!=typeof t||t<0)return c(s.PARENT_ID_INVALID,"Parent ID is invalid.")},k=function(t){if("number"!=typeof t||t<=0)return c(s.PAGE_ERROR,"Page number is invalid.")},E=function(t){if("number"!=typeof t||t<=0)return c(s.PAGESIZE_ERROR,"Page size is invalid.")},_=function(t){if(t){if(!/^[a-zA-Z0-9]{6}$/.test(t))return c(s.INVALID_PASSWORD,"Short password is invalid. It must be 6 characters long and can only contain letters and numbers.")}},x=function(t){if(t&&!(Number.isInteger(t)&&t>0))return c(s.INVALID_EXPIRE_AT,"expireAt must be a positive integer.")};function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function S(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function T(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?S(Object(r),!0).forEach((function(e){A(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function A(t,e,r){return(e=D(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R(){R=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),s=new D(n||[]);return o(a,"_invoke",{value:T(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",g={};function b(){}function m(){}function v(){}var w={};c(w,a,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(N([])));E&&E!==r&&n.call(E,a)&&(w=E);var _=v.prototype=b.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,s){var u=f(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==L(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function T(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:p,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function D(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(L(e)+" is not iterable")}return m.prototype=v,o(_,"constructor",{value:v,configurable:!0}),o(v,"constructor",{value:m,configurable:!0}),m.displayName=c(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},x(S.prototype),c(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(_),c(_,u,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function O(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function I(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,D(n.key),n)}}function D(t){var e=function(t,e){if("object"!=L(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=L(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==L(e)?e:e+""}var N=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.Http=e},e=[{key:"postReport",value:(n=R().mark((function t(e,r,n,o,i,a,u,l,f){var h,p;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,h={trace_id:e,cid:r,node_id:n,rate:o,cost_ms:i,total_size:a,state:u,transfer_type:l,log:f},t.next=4,this.Http.postData("/api/v1/storage/transfer/report",h);case 4:if(0===(p=t.sent).code){t.next=7;break}return t.abrupt("return",c(p.code,"Failed to report."));case 7:return t.abrupt("return",p);case 10:return t.prev=10,t.t0=t.catch(0),t.abrupt("return",c(s.REPORT_ERROR,"Failed to report: "+t.t0.message));case 13:case"end":return t.stop()}}),t,this,[[0,10]])})),o=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){O(i,r,o,a,s,"next",t)}function s(t){O(i,r,o,a,s,"throw",t)}a(void 0)}))},function(t,e,r,n,i,a,s,u,c){return o.apply(this,arguments)})},{key:"creatReportData",value:function(t,e){var r=t.filter((function(t){return"Failed to upload file: Upload aborted"!=t.msg})),n=r.map((function(t){return t.nodeId.toLowerCase()})).join(", "),o=r.reduce((function(t,e){return T(T({},t),e.log)}),{}),i=0===Object.keys(o).length?null:JSON.stringify(o),a=r[0].traceId,s=r[0].cId,u=n,c=r[0].transferRate,l=r[0].elapsedTime,f=r[0].size,h=r[0].status,p=e,d=i;this.postReport(a,s,u,c,l,f,h,p,d)}}],e&&I(t.prototype,e),r&&I(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();const P=N;function j(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return z(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?z(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function z(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function F(){F=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),s=new O(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",g={};function b(){}function m(){}function v(){}var w={};c(w,a,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(I([])));E&&E!==r&&n.call(E,a)&&(w=E);var _=v.prototype=b.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,a,s){var u=f(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==B(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=T(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:p,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function T(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(B(e)+" is not iterable")}return m.prototype=v,o(_,"constructor",{value:v,configurable:!0}),o(v,"constructor",{value:m,configurable:!0}),m.displayName=c(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},x(L.prototype),c(L.prototype,s,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(_),c(_,u,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function C(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function U(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){C(i,n,o,a,s,"next",t)}function s(t){C(i,n,o,a,s,"throw",t)}a(void 0)}))}}function M(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function H(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$(n.key),n)}}function G(t,e,r){return e&&H(t.prototype,e),r&&H(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $(t){var e=function(t,e){if("object"!=B(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=B(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==B(e)?e:e+""}var V=function(){return G((function t(){M(this,t),this._locked=!1,this._waiting=[]}),[{key:"acquire",value:(t=U(F().mark((function t(){var e=this;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._locked){t.next=5;break}return t.next=3,new Promise((function(t){return e._waiting.push(t)}));case 3:t.next=0;break;case 5:this._locked=!0;case 6:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"release",value:function(){(this._locked=!1,this._waiting.length>0)&&this._waiting.shift()()}}]);var t}(),q=function(){return G((function t(e){M(this,t),this.concurrentLimit=3,this.progressCallback=null,this.chunkQueue=[],this.downloadedChunks=[],this.maxRetries=3,this.failedChunks=[],this.report=new P(e),this.mimeType="application/octet-stream",this.lock=new V,this.paused=!1}),[{key:"setProgressCallback",value:function(t){this.progressCallback=t}},{key:"checkUrl",value:(a=U(F().mark((function t(e){var r;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e,{method:"HEAD"});case 3:return r=t.sent,t.abrupt("return",r.ok);case 7:return t.prev=7,t.t0=t.catch(0),u("Error checking URL:",t.t0),t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(t){return a.apply(this,arguments)})},{key:"downloadChunk",value:(i=U(F().mark((function t(e,r,n){var o,i,a,s,c=arguments;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=c.length>3&&void 0!==c[3]?c[3]:0,t.prev=1,t.next=4,fetch(e,{headers:{Range:"bytes=".concat(r,"-").concat(n)}});case 4:if(!(i=t.sent).ok){t.next=18;break}return t.next=8,i.blob();case 8:if(a=t.sent,s=n-r+1,u("Downloading chunk ".concat(r,"-").concat(n,": expected size ").concat(s,", actual size ").concat(a.size)),a.size===s){t.next=13;break}throw new Error("Chunk size mismatch: expected ".concat(s,", but got ").concat(a.size));case 13:return this.downloadedChunks.push({start:r,blob:a}),this.mimeType=i.headers.get("Content-Type"),t.abrupt("return",a);case 18:throw new Error("Failed to download chunk: ".concat(r,"-").concat(n,", status: ").concat(i.status));case 19:t.next=32;break;case 21:if(t.prev=21,t.t0=t.catch(1),!(o<this.maxRetries)){t.next=30;break}return u("Chunk download failed, retrying attempt ".concat(o+1," for chunk ").concat(r,"-").concat(n)),t.next=27,new Promise((function(t){return setTimeout(t,1e3)}));case 27:return t.abrupt("return",this.downloadChunk(e,r,n,o+1));case 30:throw this.failedChunks.push({start:r,end:n}),new Error("Chunk download failed after ".concat(this.maxRetries," attempts: ").concat(r,"-").concat(n));case 32:case"end":return t.stop()}}),t,this,[[1,21]])}))),function(t,e,r){return i.apply(this,arguments)})},{key:"downloadFile",value:(o=U(F().mark((function t(e,r,n,o,i){var a,s,l,f,h,p,d,y,g;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Math.ceil(i/e.length),s=[],t.prev=2,l=Date.now(),t.next=6,this.concurrentDownload(e,i,a);case 6:if(this.downloadedChunks.every((function(t,r){var n=r<e.length-1?a:i%a;return t.blob.size===n}))){t.next=11;break}return u("Some chunks were incomplete. Retrying..."),t.next=11,this.retryMissingChunks(this.failedChunks,e);case 11:if((f=this.mergeChunks(this.downloadedChunks,this.mimeType)).size===i){t.next=14;break}throw new Error("File size mismatch: expected ".concat(i,", but got ").concat(f.size));case 14:return h=window.URL.createObjectURL(f),(p=document.createElement("a")).href=h,p.download=o,document.body.appendChild(p),p.click(),window.URL.revokeObjectURL(h),document.body.removeChild(p),d=Date.now(),y=d-l,g=Math.floor(i/y*1e3),e.forEach((function(t){var e=new URL(t).hostname.split(".")[0];s.push({status:1,msg:"successful",elapsedTime:y,transferRate:g,size:i,traceId:r,nodeId:e,cId:n,log:""})})),this.report.creatReportData(s,"download"),t.abrupt("return",{code:0,msg:"Download successful"});case 30:return t.prev=30,t.t0=t.catch(2),e.forEach((function(e){var o=new URL(e).hostname.split(".")[0];s.push({status:-1,msg:t.t0.message,elapsedTime:-1,transferRate:-1,size:i,traceId:r,nodeId:o,cId:n,log:t.t0.stack||""})})),this.report.creatReportData(s,"download"),c(t.t0),t.abrupt("return",{code:-1,msg:"Download failed: "+t.t0});case 36:case"end":return t.stop()}}),t,this,[[2,30]])}))),function(t,e,r,n,i){return o.apply(this,arguments)})},{key:"concurrentDownload",value:(n=U(F().mark((function t(e,r,n){var o,i,a,s,c,l,f,h,p,d,y,g=this;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(o=e.slice(),i=0,a=Math.ceil(r/n),s=0;s<a;s++)c=s*n,l=Math.min(r-1,(s+1)*n-1),this.chunkQueue.push({start:c,end:l});for(f=[],h=new Array(o.length).fill(!1),p=function(){var t=Math.min(100,i/r*100).toFixed(2);g.progressCallback&&g.progressCallback(t)},d=function(){var t=U(F().mark((function t(e,r){var n,o;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=void 0,t.next=4,g.lock.acquire();case 4:if(g.chunkQueue.length>0&&(n=g.chunkQueue.shift()),g.lock.release(),n){t.next=8;break}return t.abrupt("break",21);case 8:return t.prev=8,t.next=11,g.downloadChunk(e,n.start,n.end);case 11:o=t.sent,i+=o.size,p(),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(8),u("Failed to download chunk ".concat(n.start,"-").concat(n.end," from ").concat(e,":"),t.t0);case 19:t.next=0;break;case 21:h[r]=!1;case 22:case"end":return t.stop()}}),t,null,[[8,16]])})));return function(e,r){return t.apply(this,arguments)}}(),y=0;y<o.length;y++)y<this.concurrentLimit&&(h[y]=!0,f.push(d(o[y],y)));return t.next=11,Promise.all(f);case 11:if(!(this.failedChunks.length>0)){t.next=15;break}return u("Retrying failed chunks..."),t.next=15,this.retryMissingChunks(this.failedChunks,o);case 15:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return n.apply(this,arguments)})},{key:"retryMissingChunks",value:(r=U(F().mark((function t(e,r){var n,o,i,a,s,c,l,f;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=j(e),t.prev=1,n.s();case 3:if((o=n.n()).done){t.next=37;break}i=o.value,a=!1,s=j(r),t.prev=7,s.s();case 9:if((c=s.n()).done){t.next=26;break}return l=c.value,t.prev=11,u("Re-download chunk ".concat(i.start,"-").concat(i.end," from ").concat(l)),t.next=15,this.downloadChunk(l,i.start,i.end);case 15:return f=t.sent,this.downloadedChunks.push({start:i.start,blob:f}),a=!0,t.abrupt("break",26);case 21:t.prev=21,t.t0=t.catch(11),u("Failed to re-download chunk ".concat(i.start,"-").concat(i.end," from ").concat(l,":"),t.t0);case 24:t.next=9;break;case 26:t.next=31;break;case 28:t.prev=28,t.t1=t.catch(7),s.e(t.t1);case 31:return t.prev=31,s.f(),t.finish(31);case 34:a||u("Re-download chunk ".concat(i.start,"-").concat(i.end," failed after all attempts."));case 35:t.next=3;break;case 37:t.next=42;break;case 39:t.prev=39,t.t2=t.catch(1),n.e(t.t2);case 42:return t.prev=42,n.f(),t.finish(42);case 45:case"end":return t.stop()}}),t,this,[[1,39,42,45],[7,28,31,34],[11,21]])}))),function(t,e){return r.apply(this,arguments)})},{key:"mergeChunks",value:function(t,e){var r=t.sort((function(t,e){return t.start-e.start}));return new Blob(r.map((function(t){return t.blob})),{type:e})}},{key:"downloadFiles",value:(e=U(F().mark((function t(e,r,n,o,i){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){var s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType="blob",s.onprogress=function(t){var e=t.loaded/o*100;e>100&&(e=100),i(r,e)},s.onload=function(){if(200===s.status){var e=document.createElement("a"),n=window.URL.createObjectURL(s.response);e.href=n,e.download=r,document.body.appendChild(e),e.click(),window.URL.revokeObjectURL(n),document.body.removeChild(e),t({code:0,msg:"Download successful"})}else a({code:-1,msg:"Download failed"+s.statusText})},s.onerror=function(){a({code:-1,msg:"Download onerror"})},n.signal.addEventListener("abort",(function(){s.abort(),a({code:-1,msg:"Download abort"})})),s.send()})));case 1:case"end":return t.stop()}}),t)}))),function(t,r,n,o,i){return e.apply(this,arguments)})},{key:"downloadFromMultipleUrls",value:(t=U(F().mark((function t(e,r,n,o,i,a){var s,u,c,l,f,h,p,d,y,g,b=this;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=new AbortController,u=[],c=!1,l=0,f=[],h=function(t,e){c||e>l&&(l=e,a&&a(l.toFixed(2)))},p=j(e),t.prev=7,y=F().mark((function t(){var e,a,l,p,y;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=d.value,a=Date.now(),l=new URL(e),p=l.hostname.split(".")[0],y=function(){var t=U(F().mark((function t(){var u,l,d,y,g;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:u=0;case 1:if(!(u<3)){t.next=29;break}if(!c){t.next=4;break}return t.abrupt("return");case 4:return t.prev=4,t.next=7,b.downloadFiles(e+"&format=tar",o+".tar",s,i,h);case 7:return l=t.sent,c=!0,s.abort(),d=Date.now(),y=d-a,g=Math.floor(i/y*1e3),f.push({status:1,msg:"successful",elapsedTime:y,transferRate:g,size:i,traceId:r,nodeId:p,cId:n,log:""}),b.report.creatReportData(f,"download"),t.abrupt("return",l);case 18:if(t.prev=18,t.t0=t.catch(4),u++,!c){t.next=23;break}return t.abrupt("return");case 23:if(!(u>=3)){t.next=27;break}return f.push({status:2,msg:"failed",elapsedTime:0,transferRate:0,size:i,traceId:r,nodeId:p,cId:n,log:(m={},v=p,w=t.t0,(v=$(v))in m?Object.defineProperty(m,v,{value:w,enumerable:!0,configurable:!0,writable:!0}):m[v]=w,m)}),b.report.creatReportData(f,"download"),t.abrupt("return",{code:-1,msg:"Download failed"});case 27:t.next=1;break;case 29:case"end":return t.stop()}var m,v,w}),t,null,[[4,18]])})));return function(){return t.apply(this,arguments)}}(),u.push(y());case 6:case"end":return t.stop()}}),t)})),p.s();case 10:if((d=p.n()).done){t.next=14;break}return t.delegateYield(y(),"t0",12);case 12:t.next=10;break;case 14:t.next=19;break;case 16:t.prev=16,t.t1=t.catch(7),p.e(t.t1);case 19:return t.prev=19,p.f(),t.finish(19);case 22:return t.next=24,Promise.allSettled(u);case 24:return g=t.sent,t.abrupt("return",c?g.find((function(t){return t&&0===t.code})):{code:-1,msg:"All url download failed"});case 26:case"end":return t.stop()}}),t,null,[[7,16,19,22]])}))),function(e,r,n,o,i,a){return t.apply(this,arguments)})}]);var t,e,r,n,o,i,a}();const Y=q,W=new Uint8Array(0);function K(t){const e=t.match(/../g);return null!=e?new Uint8Array(e.map((t=>parseInt(t,16)))):W}function J(t){if(t instanceof Uint8Array&&"Uint8Array"===t.constructor.name)return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}var Q=function(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var i=t.charAt(o),a=i.charCodeAt(0);if(255!==r[a])throw new TypeError(i+" is ambiguous");r[a]=o}var s=t.length,u=t.charAt(0),c=Math.log(s)/Math.log(256),l=Math.log(256)/Math.log(s);function f(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;var e=0;if(" "!==t[e]){for(var n=0,o=0;t[e]===u;)n++,e++;for(var i=(t.length-e)*c+1>>>0,a=new Uint8Array(i);t[e];){var l=r[t.charCodeAt(e)];if(255===l)return;for(var f=0,h=i-1;(0!==l||f<o)&&-1!==h;h--,f++)l+=s*a[h]>>>0,a[h]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");o=f,e++}if(" "!==t[e]){for(var p=i-o;p!==i&&0===a[p];)p++;for(var d=new Uint8Array(n+(i-p)),y=n;p!==i;)d[y++]=a[p++];return d}}}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,n=0,o=0,i=e.length;o!==i&&0===e[o];)o++,r++;for(var a=(i-o)*l+1>>>0,c=new Uint8Array(a);o!==i;){for(var f=e[o],h=0,p=a-1;(0!==f||h<n)&&-1!==p;p--,h++)f+=256*c[p]>>>0,c[p]=f%s>>>0,f=f/s>>>0;if(0!==f)throw new Error("Non-zero carry");n=h,o++}for(var d=a-n;d!==a&&0===c[d];)d++;for(var y=u.repeat(r);d<a;++d)y+=t.charAt(c[d]);return y},decodeUnsafe:f,decode:function(t){var r=f(t);if(r)return r;throw new Error(`Non-${e} character`)}}};const Z=Q;class X{name;prefix;baseEncode;constructor(t,e,r){this.name=t,this.prefix=e,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class tt{name;prefix;baseDecode;prefixCodePoint;constructor(t,e,r){this.name=t,this.prefix=e;const n=e.codePointAt(0);if(void 0===n)throw new Error("Invalid prefix character");this.prefixCodePoint=n,this.baseDecode=r}decode(t){if("string"==typeof t){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(t){return rt(this,t)}}class et{decoders;constructor(t){this.decoders=t}or(t){return rt(this,t)}decode(t){const e=t[0],r=this.decoders[e];if(null!=r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function rt(t,e){return new et({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}class nt{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,e,r,n){this.name=t,this.prefix=e,this.baseEncode=r,this.baseDecode=n,this.encoder=new X(t,e,r),this.decoder=new tt(t,e,n)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}function ot({name:t,prefix:e,encode:r,decode:n}){return new nt(t,e,r,n)}function it({name:t,prefix:e,alphabet:r}){const{encode:n,decode:o}=Z(r,t);return ot({prefix:e,name:t,encode:n,decode:t=>J(o(t))})}function at({name:t,prefix:e,bitsPerChar:r,alphabet:n}){return ot({prefix:e,name:t,encode:t=>function(t,e,r){const n="="===e[e.length-1],o=(1<<r)-1;let i="",a=0,s=0;for(let n=0;n<t.length;++n)for(s=s<<8|t[n],a+=8;a>r;)a-=r,i+=e[o&s>>a];if(0!==a&&(i+=e[o&s<<r-a]),n)for(;i.length*r&7;)i+="=";return i}(t,n,r),decode:e=>function(t,e,r,n){const o={};for(let t=0;t<e.length;++t)o[e[t]]=t;let i=t.length;for(;"="===t[i-1];)--i;const a=new Uint8Array(i*r/8|0);let s=0,u=0,c=0;for(let e=0;e<i;++e){const i=o[t[e]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);u=u<<r|i,s+=r,s>=8&&(s-=8,a[c++]=255&u>>s)}if(s>=r||255&u<<8-s)throw new SyntaxError("Unexpected end of data");return a}(e,n,r,t)})}const st=at({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ut=(at({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),at({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),at({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),at({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),at({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),at({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),at({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),at({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),it({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"})),ct=(it({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),it({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));it({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var lt=function t(e,r,n){r=r||[],n=n||0;var o=n;for(;e>=pt;)r[n++]=255&e|ft,e/=128;for(;e&ht;)r[n++]=255&e|ft,e>>>=7;return r[n]=0|e,t.bytes=n-o+1,r},ft=128,ht=-128,pt=Math.pow(2,31);var dt=function t(e,r){var n,o=0,i=(r=r||0,0),a=r,s=e.length;do{if(a>=s)throw t.bytes=0,new RangeError("Could not decode varint");n=e[a++],o+=i<28?(n&gt)<<i:(n&gt)*Math.pow(2,i),i+=7}while(n>=yt);return t.bytes=a-r,o},yt=128,gt=127;var bt=Math.pow(2,7),mt=Math.pow(2,14),vt=Math.pow(2,21),wt=Math.pow(2,28),kt=Math.pow(2,35),Et=Math.pow(2,42),_t=Math.pow(2,49),xt=Math.pow(2,56),Lt=Math.pow(2,63);const St={encode:lt,decode:dt,encodingLength:function(t){return t<bt?1:t<mt?2:t<vt?3:t<wt?4:t<kt?5:t<Et?6:t<_t?7:t<xt?8:t<Lt?9:10}};function Tt(t,e=0){return[St.decode(t,e),St.decode.bytes]}function At(t,e,r=0){return St.encode(t,e,r),e}function Rt(t){return St.encodingLength(t)}function Ot(t,e){const r=e.byteLength,n=Rt(t),o=n+Rt(r),i=new Uint8Array(o+r);return At(t,i,0),At(r,i,n),i.set(e,o),new It(t,r,e,i)}class It{code;size;digest;bytes;constructor(t,e,r,n){this.code=t,this.size=e,this.digest=r,this.bytes=n}}function Dt(t,e){const{bytes:r,version:n}=t;return 0===n?function(t,e,r){const{prefix:n}=r;if(n!==ct.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const o=e.get(n);if(null==o){const o=r.encode(t).slice(1);return e.set(n,o),o}return o}(r,Pt(t),e??ct.encoder):function(t,e,r){const{prefix:n}=r,o=e.get(n);if(null==o){const o=r.encode(t);return e.set(n,o),o}return o}(r,Pt(t),e??st.encoder)}const Nt=new WeakMap;function Pt(t){const e=Nt.get(t);if(null==e){const e=new Map;return Nt.set(t,e),e}return e}class jt{code;version;multihash;bytes;"/";constructor(t,e,r,n){this.code=e,this.version=t,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:e}=this;if(t!==zt)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==Bt)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return jt.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:e}=this.multihash,r=Ot(t,e);return jt.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return jt.equals(this,t)}static equals(t,e){const r=e;return null!=r&&t.code===r.code&&t.version===r.version&&function(t,e){if(t===e)return!0;{const r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&function(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}(t.bytes,r.bytes)}}(t.multihash,r.multihash)}toString(t){return Dt(this,t)}toJSON(){return{"/":Dt(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(null==t)return null;const e=t;if(e instanceof jt)return e;if(null!=e["/"]&&e["/"]===e.bytes||e.asCID===e){const{version:t,code:r,multihash:n,bytes:o}=e;return new jt(t,r,n,o??Ft(t,r,n.bytes))}if(!0===e[Ct]){const{version:t,multihash:r,code:n}=e,o=function(t){const e=J(t),[r,n]=Tt(e),[o,i]=Tt(e.subarray(n)),a=e.subarray(n+i);if(a.byteLength!==o)throw new Error("Incorrect length");return new It(r,o,a,e)}(r);return jt.create(t,n,o)}return null}static create(t,e,r){if("number"!=typeof e)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:if(e!==zt)throw new Error(`Version 0 CID must use dag-pb (code: ${zt}) block encoding`);return new jt(t,e,r,r.bytes);case 1:{const n=Ft(t,e,r.bytes);return new jt(t,e,r,n)}default:throw new Error("Invalid version")}}static createV0(t){return jt.create(0,zt,t)}static createV1(t,e){return jt.create(1,t,e)}static decode(t){const[e,r]=jt.decodeFirst(t);if(0!==r.length)throw new Error("Incorrect length");return e}static decodeFirst(t){const e=jt.inspectBytes(t),r=e.size-e.multihashSize,n=J(t.subarray(r,r+e.multihashSize));if(n.byteLength!==e.multihashSize)throw new Error("Incorrect length");const o=n.subarray(e.multihashSize-e.digestSize),i=new It(e.multihashCode,e.digestSize,o,n);return[0===e.version?jt.createV0(i):jt.createV1(e.codec,i),t.subarray(e.size)]}static inspectBytes(t){let e=0;const r=()=>{const[r,n]=Tt(t.subarray(e));return e+=n,r};let n=r(),o=zt;if(18===n?(n=0,e=0):o=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=e,a=r(),s=r(),u=e+s;return{version:n,codec:o,multihashCode:a,digestSize:s,multihashSize:u-i,size:u}}static parse(t,e){const[r,n]=function(t,e){switch(t[0]){case"Q":{const r=e??ct;return[ct.prefix,r.decode(`${ct.prefix}${t}`)]}case ct.prefix:{const r=e??ct;return[ct.prefix,r.decode(t)]}case st.prefix:{const r=e??st;return[st.prefix,r.decode(t)]}case ut.prefix:{const r=e??ut;return[ut.prefix,r.decode(t)]}default:if(null==e)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}(t,e),o=jt.decode(n);if(0===o.version&&"Q"!==t[0])throw Error("Version 0 CID string must not include multibase prefix");return Pt(o).set(r,t),o}}const zt=112,Bt=18;function Ft(t,e,r){const n=Rt(t),o=n+Rt(e),i=new Uint8Array(o+r.byteLength);return At(t,i,0),At(e,i,n),i.set(r,o),i}const Ct=Symbol.for("@ipld/js-cid/CID"),Ut=new TextDecoder;function Mt(t,e){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(e>=t.length)throw new Error("protobuf: unexpected end of data");const o=t[e++];if(r+=n<28?(127&o)<<n:(127&o)*2**n,o<128)break}return[r,e]}function Ht(t,e){let r;[r,e]=Mt(t,e);const n=e+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>t.length)throw new Error("protobuf: unexpected end of data");return[t.subarray(e,n),n]}function Gt(t,e){let r;return[r,e]=Mt(t,e),[7&r,r>>3,e]}function $t(t){const e={},r=t.length;let n=0;for(;n<r;){let r,o;if([r,o,n]=Gt(t,n),1===o){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Hash`);if(void 0!==e.Name)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==e.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,n]=Ht(t,n)}else if(2===o){if(void 0!==e.Name)throw new Error("protobuf: (PBLink) duplicate Name section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Name`);if(void 0!==e.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,n]=Ht(t,n),e.Name=Ut.decode(o)}else{if(3!==o)throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${o}`);if(void 0!==e.Tsize)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(0!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Tsize`);[e.Tsize,n]=Mt(t,n)}}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return e}const Vt=new TextEncoder,qt=2**32,Yt=2**31;function Wt(t,e){let r=e.length;if("number"==typeof t.Tsize){if(t.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(t.Tsize))throw new Error("Tsize too large for encoding");r=Qt(e,r,t.Tsize)-1,e[r]=24}if("string"==typeof t.Name){const n=Vt.encode(t.Name);r-=n.length,e.set(n,r),r=Qt(e,r,n.length)-1,e[r]=18}return t.Hash&&(r-=t.Hash.length,e.set(t.Hash,r),r=Qt(e,r,t.Hash.length)-1,e[r]=10),e.length-r}function Kt(t){const e=function(t){let e=0;if(t.Data){const r=t.Data.length;e+=1+r+Zt(r)}if(t.Links)for(const r of t.Links){const t=Jt(r);e+=1+t+Zt(t)}return e}(t),r=new Uint8Array(e);let n=e;if(t.Data&&(n-=t.Data.length,r.set(t.Data,n),n=Qt(r,n,t.Data.length)-1,r[n]=10),t.Links)for(let e=t.Links.length-1;e>=0;e--){const o=Wt(t.Links[e],r.subarray(0,n));n-=o,n=Qt(r,n,o)-1,r[n]=18}return r}function Jt(t){let e=0;if(t.Hash){const r=t.Hash.length;e+=1+r+Zt(r)}if("string"==typeof t.Name){const r=Vt.encode(t.Name).length;e+=1+r+Zt(r)}return"number"==typeof t.Tsize&&(e+=1+Zt(t.Tsize)),e}function Qt(t,e,r){const n=e-=Zt(r);for(;r>=Yt;)t[e++]=127&r|128,r/=128;for(;r>=128;)t[e++]=127&r|128,r>>>=7;return t[e]=r,n}function Zt(t){return t%2==0&&t++,Math.floor((function(t){let e=0;t>=qt&&(t=Math.floor(t/qt),e=32);t>=65536&&(t>>>=16,e+=16);t>=256&&(t>>>=8,e+=8);return e+Xt[t]}(t)+6)/7)}const Xt=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],te=["Data","Links"],ee=["Hash","Name","Tsize"],re=new TextEncoder;function ne(t,e){if(t===e)return 0;const r=t.Name?re.encode(t.Name):[],n=e.Name?re.encode(e.Name):[];let o=r.length,i=n.length;for(let t=0,e=Math.min(o,i);t<e;++t)if(r[t]!==n[t]){o=r[t],i=n[t];break}return o<i?-1:i<o?1:0}function oe(t,e){return!Object.keys(t).some((t=>!e.includes(t)))}function ie(t){if("object"==typeof t.asCID){const e=jt.asCID(t);if(!e)throw new TypeError("Invalid DAG-PB form");return{Hash:e}}if("object"!=typeof t||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");const e={};if(t.Hash){let r=jt.asCID(t.Hash);try{r||("string"==typeof t.Hash?r=jt.parse(t.Hash):t.Hash instanceof Uint8Array&&(r=jt.decode(t.Hash)))}catch(t){throw new TypeError(`Invalid DAG-PB form: ${t.message}`)}r&&(e.Hash=r)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return"string"==typeof t.Name&&(e.Name=t.Name),"number"==typeof t.Tsize&&(e.Tsize=t.Tsize),e}function ae(t){if((t instanceof Uint8Array||"string"==typeof t)&&(t={Data:t}),"object"!=typeof t||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");const e={};if(void 0!==t.Data)if("string"==typeof t.Data)e.Data=re.encode(t.Data);else{if(!(t.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form");e.Data=t.Data}if(void 0!==t.Links){if(!Array.isArray(t.Links))throw new TypeError("Invalid DAG-PB form");e.Links=t.Links.map(ie),e.Links.sort(ne)}else e.Links=[];return e}function se(t){!function(t){if(!t||"object"!=typeof t||Array.isArray(t)||t instanceof Uint8Array||t["/"]&&t["/"]===t.bytes)throw new TypeError("Invalid DAG-PB form");if(!oe(t,te))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(void 0!==t.Data&&!(t.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(t.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let e=0;e<t.Links.length;e++){const r=t.Links[e];if(!r||"object"!=typeof r||Array.isArray(r)||r instanceof Uint8Array||r["/"]&&r["/"]===r.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!oe(r,ee))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(void 0===r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(null==r.Hash||!r.Hash["/"]||r.Hash["/"]!==r.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(void 0!==r.Name&&"string"!=typeof r.Name)throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(void 0!==r.Tsize){if("number"!=typeof r.Tsize||r.Tsize%1!=0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(r.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(e>0&&-1===ne(r,t.Links[e-1]))throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}(t);const e={};return t.Links&&(e.Links=t.Links.map((t=>{const e={};return t.Hash&&(e.Hash=t.Hash.bytes),void 0!==t.Name&&(e.Name=t.Name),void 0!==t.Tsize&&(e.Tsize=t.Tsize),e}))),t.Data&&(e.Data=t.Data),Kt(e)}function ue(t){const e=function(t){const e=t.length;let r,n,o=0,i=!1;for(;o<e;){let e,a;if([e,a,o]=Gt(t,o),2!==e)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${e}`);if(1===a){if(n)throw new Error("protobuf: (PBNode) duplicate Data section");[n,o]=Ht(t,o),r&&(i=!0)}else{if(2!==a)throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${a}`);{if(i)throw new Error("protobuf: (PBNode) duplicate Links section");let e;r||(r=[]),[e,o]=Ht(t,o),r.push($t(e))}}}if(o>e)throw new Error("protobuf: (PBNode) unexpected end of data");const a={};return n&&(a.Data=n),a.Links=r||[],a}(function(t){return t instanceof ArrayBuffer?new Uint8Array(t,0,t.byteLength):t}(t)),r={};return e.Data&&(r.Data=e.Data),e.Links&&(r.Links=e.Links.map((t=>{const e={};try{e.Hash=jt.decode(t.Hash)}catch(t){}if(!e.Hash)throw new Error("Invalid Hash field found in link, expected CID");return void 0!==t.Name&&(e.Name=t.Name),void 0!==t.Tsize&&(e.Tsize=t.Tsize),e}))),r}var ce=__webpack_require__(946);const le=ce.Reader,fe=ce.Writer,he=ce.util,pe=ce.roots.unixfs||(ce.roots.unixfs={}),de=pe.Data=(()=>{function t(t){if(this.blocksizes=[],t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}return t.prototype.Type=0,t.prototype.Data=he.newBuffer([]),t.prototype.filesize=he.Long?he.Long.fromBits(0,0,!0):0,t.prototype.blocksizes=he.emptyArray,t.prototype.hashType=he.Long?he.Long.fromBits(0,0,!0):0,t.prototype.fanout=he.Long?he.Long.fromBits(0,0,!0):0,t.prototype.mode=0,t.prototype.mtime=null,t.encode=function(t,e){if(e||(e=fe.create()),e.uint32(8).int32(t.Type),null!=t.Data&&Object.hasOwnProperty.call(t,"Data")&&e.uint32(18).bytes(t.Data),null!=t.filesize&&Object.hasOwnProperty.call(t,"filesize")&&e.uint32(24).uint64(t.filesize),null!=t.blocksizes&&t.blocksizes.length)for(var r=0;r<t.blocksizes.length;++r)e.uint32(32).uint64(t.blocksizes[r]);return null!=t.hashType&&Object.hasOwnProperty.call(t,"hashType")&&e.uint32(40).uint64(t.hashType),null!=t.fanout&&Object.hasOwnProperty.call(t,"fanout")&&e.uint32(48).uint64(t.fanout),null!=t.mode&&Object.hasOwnProperty.call(t,"mode")&&e.uint32(56).uint32(t.mode),null!=t.mtime&&Object.hasOwnProperty.call(t,"mtime")&&pe.UnixTime.encode(t.mtime,e.uint32(66).fork()).ldelim(),e},t.decode=function(t,e){t instanceof le||(t=le.create(t));for(var r=void 0===e?t.len:t.pos+e,n=new pe.Data;t.pos<r;){var o=t.uint32();switch(o>>>3){case 1:n.Type=t.int32();break;case 2:n.Data=t.bytes();break;case 3:n.filesize=t.uint64();break;case 4:if(n.blocksizes&&n.blocksizes.length||(n.blocksizes=[]),2==(7&o))for(var i=t.uint32()+t.pos;t.pos<i;)n.blocksizes.push(t.uint64());else n.blocksizes.push(t.uint64());break;case 5:n.hashType=t.uint64();break;case 6:n.fanout=t.uint64();break;case 7:n.mode=t.uint32();break;case 8:n.mtime=pe.UnixTime.decode(t,t.uint32());break;default:t.skipType(7&o)}}if(!n.hasOwnProperty("Type"))throw he.ProtocolError("missing required 'Type'",{instance:n});return n},t.fromObject=function(t){if(t instanceof pe.Data)return t;var e=new pe.Data;switch(t.Type){case"Raw":case 0:e.Type=0;break;case"Directory":case 1:e.Type=1;break;case"File":case 2:e.Type=2;break;case"Metadata":case 3:e.Type=3;break;case"Symlink":case 4:e.Type=4;break;case"HAMTShard":case 5:e.Type=5}if(null!=t.Data&&("string"==typeof t.Data?he.base64.decode(t.Data,e.Data=he.newBuffer(he.base64.length(t.Data)),0):t.Data.length&&(e.Data=t.Data)),null!=t.filesize&&(he.Long?(e.filesize=he.Long.fromValue(t.filesize)).unsigned=!0:"string"==typeof t.filesize?e.filesize=parseInt(t.filesize,10):"number"==typeof t.filesize?e.filesize=t.filesize:"object"==typeof t.filesize&&(e.filesize=new he.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0))),t.blocksizes){if(!Array.isArray(t.blocksizes))throw TypeError(".Data.blocksizes: array expected");e.blocksizes=[];for(var r=0;r<t.blocksizes.length;++r)he.Long?(e.blocksizes[r]=he.Long.fromValue(t.blocksizes[r])).unsigned=!0:"string"==typeof t.blocksizes[r]?e.blocksizes[r]=parseInt(t.blocksizes[r],10):"number"==typeof t.blocksizes[r]?e.blocksizes[r]=t.blocksizes[r]:"object"==typeof t.blocksizes[r]&&(e.blocksizes[r]=new he.LongBits(t.blocksizes[r].low>>>0,t.blocksizes[r].high>>>0).toNumber(!0))}if(null!=t.hashType&&(he.Long?(e.hashType=he.Long.fromValue(t.hashType)).unsigned=!0:"string"==typeof t.hashType?e.hashType=parseInt(t.hashType,10):"number"==typeof t.hashType?e.hashType=t.hashType:"object"==typeof t.hashType&&(e.hashType=new he.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0))),null!=t.fanout&&(he.Long?(e.fanout=he.Long.fromValue(t.fanout)).unsigned=!0:"string"==typeof t.fanout?e.fanout=parseInt(t.fanout,10):"number"==typeof t.fanout?e.fanout=t.fanout:"object"==typeof t.fanout&&(e.fanout=new he.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0))),null!=t.mode&&(e.mode=t.mode>>>0),null!=t.mtime){if("object"!=typeof t.mtime)throw TypeError(".Data.mtime: object expected");e.mtime=pe.UnixTime.fromObject(t.mtime)}return e},t.toObject=function(t,e){e||(e={});var r={};if((e.arrays||e.defaults)&&(r.blocksizes=[]),e.defaults){if(r.Type=e.enums===String?"Raw":0,e.bytes===String?r.Data="":(r.Data=[],e.bytes!==Array&&(r.Data=he.newBuffer(r.Data))),he.Long){var n=new he.Long(0,0,!0);r.filesize=e.longs===String?n.toString():e.longs===Number?n.toNumber():n}else r.filesize=e.longs===String?"0":0;if(he.Long){n=new he.Long(0,0,!0);r.hashType=e.longs===String?n.toString():e.longs===Number?n.toNumber():n}else r.hashType=e.longs===String?"0":0;if(he.Long){n=new he.Long(0,0,!0);r.fanout=e.longs===String?n.toString():e.longs===Number?n.toNumber():n}else r.fanout=e.longs===String?"0":0;r.mode=0,r.mtime=null}if(null!=t.Type&&t.hasOwnProperty("Type")&&(r.Type=e.enums===String?pe.Data.DataType[t.Type]:t.Type),null!=t.Data&&t.hasOwnProperty("Data")&&(r.Data=e.bytes===String?he.base64.encode(t.Data,0,t.Data.length):e.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),null!=t.filesize&&t.hasOwnProperty("filesize")&&("number"==typeof t.filesize?r.filesize=e.longs===String?String(t.filesize):t.filesize:r.filesize=e.longs===String?he.Long.prototype.toString.call(t.filesize):e.longs===Number?new he.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0):t.filesize),t.blocksizes&&t.blocksizes.length){r.blocksizes=[];for(var o=0;o<t.blocksizes.length;++o)"number"==typeof t.blocksizes[o]?r.blocksizes[o]=e.longs===String?String(t.blocksizes[o]):t.blocksizes[o]:r.blocksizes[o]=e.longs===String?he.Long.prototype.toString.call(t.blocksizes[o]):e.longs===Number?new he.LongBits(t.blocksizes[o].low>>>0,t.blocksizes[o].high>>>0).toNumber(!0):t.blocksizes[o]}return null!=t.hashType&&t.hasOwnProperty("hashType")&&("number"==typeof t.hashType?r.hashType=e.longs===String?String(t.hashType):t.hashType:r.hashType=e.longs===String?he.Long.prototype.toString.call(t.hashType):e.longs===Number?new he.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0):t.hashType),null!=t.fanout&&t.hasOwnProperty("fanout")&&("number"==typeof t.fanout?r.fanout=e.longs===String?String(t.fanout):t.fanout:r.fanout=e.longs===String?he.Long.prototype.toString.call(t.fanout):e.longs===Number?new he.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0):t.fanout),null!=t.mode&&t.hasOwnProperty("mode")&&(r.mode=t.mode),null!=t.mtime&&t.hasOwnProperty("mtime")&&(r.mtime=pe.UnixTime.toObject(t.mtime,e)),r},t.prototype.toJSON=function(){return this.constructor.toObject(this,ce.util.toJSONOptions)},t.DataType=function(){const t={},e=Object.create(t);return e[t[0]="Raw"]=0,e[t[1]="Directory"]=1,e[t[2]="File"]=2,e[t[3]="Metadata"]=3,e[t[4]="Symlink"]=4,e[t[5]="HAMTShard"]=5,e}(),t})(),ye=(pe.UnixTime=(()=>{function t(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}return t.prototype.Seconds=he.Long?he.Long.fromBits(0,0,!1):0,t.prototype.FractionalNanoseconds=0,t.encode=function(t,e){return e||(e=fe.create()),e.uint32(8).int64(t.Seconds),null!=t.FractionalNanoseconds&&Object.hasOwnProperty.call(t,"FractionalNanoseconds")&&e.uint32(21).fixed32(t.FractionalNanoseconds),e},t.decode=function(t,e){t instanceof le||(t=le.create(t));for(var r=void 0===e?t.len:t.pos+e,n=new pe.UnixTime;t.pos<r;){var o=t.uint32();switch(o>>>3){case 1:n.Seconds=t.int64();break;case 2:n.FractionalNanoseconds=t.fixed32();break;default:t.skipType(7&o)}}if(!n.hasOwnProperty("Seconds"))throw he.ProtocolError("missing required 'Seconds'",{instance:n});return n},t.fromObject=function(t){if(t instanceof pe.UnixTime)return t;var e=new pe.UnixTime;return null!=t.Seconds&&(he.Long?(e.Seconds=he.Long.fromValue(t.Seconds)).unsigned=!1:"string"==typeof t.Seconds?e.Seconds=parseInt(t.Seconds,10):"number"==typeof t.Seconds?e.Seconds=t.Seconds:"object"==typeof t.Seconds&&(e.Seconds=new he.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber())),null!=t.FractionalNanoseconds&&(e.FractionalNanoseconds=t.FractionalNanoseconds>>>0),e},t.toObject=function(t,e){e||(e={});var r={};if(e.defaults){if(he.Long){var n=new he.Long(0,0,!1);r.Seconds=e.longs===String?n.toString():e.longs===Number?n.toNumber():n}else r.Seconds=e.longs===String?"0":0;r.FractionalNanoseconds=0}return null!=t.Seconds&&t.hasOwnProperty("Seconds")&&("number"==typeof t.Seconds?r.Seconds=e.longs===String?String(t.Seconds):t.Seconds:r.Seconds=e.longs===String?he.Long.prototype.toString.call(t.Seconds):e.longs===Number?new he.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber():t.Seconds),null!=t.FractionalNanoseconds&&t.hasOwnProperty("FractionalNanoseconds")&&(r.FractionalNanoseconds=t.FractionalNanoseconds),r},t.prototype.toJSON=function(){return this.constructor.toObject(this,ce.util.toJSONOptions)},t})(),pe.Metadata=(()=>{function t(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}return t.prototype.MimeType="",t.encode=function(t,e){return e||(e=fe.create()),null!=t.MimeType&&Object.hasOwnProperty.call(t,"MimeType")&&e.uint32(10).string(t.MimeType),e},t.decode=function(t,e){t instanceof le||(t=le.create(t));for(var r=void 0===e?t.len:t.pos+e,n=new pe.Metadata;t.pos<r;){var o=t.uint32();if(o>>>3==1)n.MimeType=t.string();else t.skipType(7&o)}return n},t.fromObject=function(t){if(t instanceof pe.Metadata)return t;var e=new pe.Metadata;return null!=t.MimeType&&(e.MimeType=String(t.MimeType)),e},t.toObject=function(t,e){e||(e={});var r={};return e.defaults&&(r.MimeType=""),null!=t.MimeType&&t.hasOwnProperty("MimeType")&&(r.MimeType=t.MimeType),r},t.prototype.toJSON=function(){return this.constructor.toObject(this,ce.util.toJSONOptions)},t})(),de.DataType),ge=Object.freeze([]),be=new Uint8Array(0),me=Object.freeze({}),ve=parseInt("0644",8),we=parseInt("0755",8),ke=112,Ee="UnixFS",_e=(t,e)=>(Object(globalThis).debug&&console.log({data:t,links:e}),se(ae({Data:de.encode(t).finish(),Links:e}))),xe=t=>({type:ye.Raw,content:t}),Le=t=>Se(be,t),Se=(t,e)=>({type:ye.File,layout:"simple",content:t,metadata:ir(e)}),Te=t=>({type:ye.File,layout:"simple",content:t}),Ae=(t,e)=>({type:ye.File,layout:"advanced",parts:t,metadata:ir(e)}),Re=t=>({type:ye.File,layout:"advanced",parts:t}),Oe=(t,e,r)=>({type:ye.File,layout:"complex",content:t,parts:e,metadata:ir(r)}),Ie=(t,e)=>({type:ye.Directory,metadata:ir(e),entries:t}),De=(t,e,r,n,o=me)=>({type:ye.HAMTShard,bitfield:e,fanout:$e(r),hashType:Ve(n),entries:t,metadata:ir(o)}),Ne=(t,e,r,n)=>({type:ye.HAMTShard,bitfield:e,fanout:$e(r),hashType:Ve(n),entries:t}),Pe=t=>_e({Type:ye.Raw,Data:t.byteLength>0?t:void 0,filesize:t.byteLength,blocksizes:ge},[]),je=(t,e=!1)=>{const r=e?me:Object(t).metadata;switch(t.layout){case"simple":return Ue(t.content,r);case"advanced":return Fe(t.parts,r);case"complex":return Me(t.content,t.parts,r);default:throw new TypeError(`File with unknown layout "${Object(t).layout}" was passed`)}},ze=t=>Ue(t,me),Be=t=>_e({Type:ye.File,blocksizes:t.map(er),filesize:Xe(t)},t.map(Ce)),Fe=(t,e=me)=>_e({Type:ye.File,blocksizes:t.map(er),filesize:Xe(t),...or(e)},t.map(Ce)),Ce=t=>({Name:"",Tsize:t.dagByteLength,Hash:t.cid}),Ue=(t,e=me)=>_e({Type:ye.File,Data:t.byteLength>0?t:void 0,filesize:t.byteLength,blocksizes:[],...or(e)},[]),Me=(t,e,r=me)=>_e({Type:ye.File,Data:t,filesize:t.byteLength+Xe(e),blocksizes:e.map(er)},e.map(Ce)),He=t=>_e({Type:t.type,...nr(t.metadata||me)},t.entries.map(rr)),Ge=({bitfield:t,fanout:e,hashType:r,entries:n,metadata:o=me})=>_e({Type:ye.HAMTShard,Data:t.byteLength>0?t:void 0,fanout:$e(e),hashType:Ve(r),...nr(o)},n.map(rr)),$e=t=>{if(Math.log2(t)%1==0)return t;throw new TypeError(`Expected hamt size to be a power of two instead got ${t}`)},Ve=t=>{if(Number.isInteger(t))return t;throw new TypeError(`Expected an integer value instead got ${t}`)},qe=(t,e=me)=>({type:ye.Symlink,content:t,metadata:ir(e)}),Ye=(t,e=!1)=>{const r=e?me:Object(t).metadata;return _e({Type:ye.Symlink,Data:t.content,...or(r||me)},[])},We=(t,e=!0)=>{switch(t.type){case ye.Raw:return Pe(t.content);case ye.File:return je(t);case ye.Directory:return He(t);case ye.HAMTShard:return Ge(t);case ye.Symlink:return Ye(t);default:throw new Error(`Unknown node type ${Object(t).type}`)}},Ke=t=>{const e=ue(t),r=de.decode(e.Data),{Type:n,Data:o,mtime:i,mode:a,blocksizes:s,...u}=de.toObject(r,{defaults:!1,arrays:!0,longs:Number,objects:!1}),c={...a&&{mode:a},...Je(i)},l=e.Links;switch(r.Type){case ye.Raw:return xe(o);case ye.File:return 0===l.length?new lr(o,c):0===o.byteLength?new fr(Qe(u.blocksizes,l),c):new hr(o,Qe(u.blocksizes,l),c);case ye.Directory:return Ie(Ze(l),c);case ye.HAMTShard:return De(Ze(l),o||be,u.fanout,u.hashType,c);case ye.Symlink:return qe(o,c);default:throw new TypeError(`Unsupported node type ${r.Type}`)}},Je=t=>null==t?void 0:{mtime:{secs:t.Seconds,nsecs:t.FractionalNanoseconds||0}},Qe=(t,e)=>{const r=[],n=t.length;for(;0<n;)r.push({cid:e[0].Hash,dagByteLength:e[0].Tsize||0,contentByteLength:t[0]});return r},Ze=t=>t.map((t=>({cid:t.Hash,name:t.Name||"",dagByteLength:t.Tsize||0}))),Xe=t=>t.reduce(((t,e)=>t+e.contentByteLength),0),tr=(t,e)=>e.reduce(((t,e)=>t+e.dagByteLength),t.byteLength),er=t=>t.contentByteLength,rr=({name:t,dagByteLength:e,cid:r})=>({Name:t,Tsize:e,Hash:r}),nr=t=>or(t,we),or=({mode:t,mtime:e},r=ve)=>({mode:null!=t?sr(t,r):void 0,mtime:null!=e?ar(e):void 0}),ir=t=>null==t?me:{...null==t.mode?void 0:{mode:ur(t.mode)},...null==t.mtime?void 0:{mtime:t.mtime}},ar=t=>null==t?void 0:0!==t.nsecs?{Seconds:t.secs,FractionalNanoseconds:t.nsecs}:{Seconds:t.secs},sr=(t,e)=>{const r=null==t?void 0:ur(t);return r===e||null==r?void 0:r},ur=t=>4095&t|4294963200&t,cr=({content:t=be,parts:e=ge,metadata:r=me,...n})=>0===e.length?new lr(t,r):0===t.byteLength?new fr(e,r):new hr(t,e,r);class lr{constructor(t,e){this.content=t,this.metadata=e,this.layout="simple",this.type=ye.File}get filesize(){return this.content.byteLength}encode(){return Ue(this.content,this.metadata)}}class fr{constructor(t,e){this.parts=t,this.metadata=e}get layout(){return"advanced"}get type(){return ye.File}get fileSize(){return Xe(this.parts)}get blockSizes(){return this.parts.map(er)}encode(){return Fe(this.parts,this.metadata)}}class hr{constructor(t,e,r){this.content=t,this.parts=e,this.metadata=r}get layout(){return"complex"}get type(){return ye.File}get fileSize(){return this.content.byteLength+Xe(this.parts)}get blockSizes(){return this.parts.map(er)}encode(){return Me(this.content,this.parts,this.metadata)}}const pr=t=>{switch(t.type){case ye.Raw:case ye.Symlink:return t.content.byteLength;case ye.File:switch(t.layout){case"simple":return t.content.byteLength;case"advanced":return Xe(t.parts);case"complex":return t.content.byteLength+Xe(t.parts)}default:return 0}},dr=function*(t){const e=yield*t;yield*vr(e)};function*yr(){return yield Sr}const gr=function*(){yield Tr};const br=function*(t){const e=yield*yr();if(mr(t)){let r,n=!1;if(t.then((t=>{n=!1,r=t,Ir(e)}),(t=>{n=!0,r=t,Ir(e)})),yield*gr(),n)throw r;return r}return Or(function*(t){Ir(t)}(e)),yield*gr(),t};const mr=t=>null!=t&&"function"==typeof t.then,vr=function*(t){yield t},wr=function*(t){const e=[];for(const r of Object.entries(t)){const[t,n]=r;n!==Yr&&e.push(yield*Nr(Er(n,t)))}yield*zr(e)},kr=t=>t.length>0?function*(t){const e=[];for(const r of t)e.push(yield*Nr(r));yield*zr(e)}(t.map(dr)):Yr;const Er=(t,e)=>t===Yr?Yr:t instanceof _r?new _r([...t.tags,e],t.source):new _r([e],t);class _r{constructor(t,e){this.tags=t,this.source=e,this.controller}[Symbol.iterator](){return this.controller||(this.controller=this.source[Symbol.iterator]()),this}box(t){if(t.done)return t;switch(t.value){case Tr:case Sr:return t;default:{const e=t;let{value:r}=e;for(const t of this.tags)r=Lr(t,r);return e.value=r,e}}}next(t){return this.box(this.controller.next(t))}throw(t){return this.box(this.controller.throw(t))}return(t){return this.box(this.controller.return(t))}get[Symbol.toStringTag](){return"TaggedEffect"}}const xr=()=>Yr,Lr=(t,e)=>({type:t,[t]:e});const Sr=Symbol("current"),Tr=Symbol("suspend");class Ar{static of(t){return t.group||Wr}static enqueue(t,e){t.group=e,e.stack.active.push(t)}constructor(t,e=[],r=new Set,n=new Rr(e,r)){this.driver=t,this.parent=Ar.of(t),this.stack=n,this.id=++Mr}}class Rr{constructor(t=[],e=new Set){this.active=t,this.idle=e}static size({active:t,idle:e}){return t.length+e.size}}const Or=t=>Ir(t[Symbol.iterator]()),Ir=t=>{let e=Ar.of(t);for(e.stack.active.push(t),e.stack.idle.delete(t);e.parent;){const{idle:t,active:r}=e.parent.stack;if(!t.has(e.driver))break;t.delete(e.driver),r.push(e.driver),e=e.parent}if(Wr.status===Hr)for(Wr.status=Gr;;)try{for(const t of Dr(Wr));Wr.status=Hr;break}catch(t){Wr.stack.active.shift()}},Dr=function*(t){const{active:e}=t.stack;let r=e[0];for(t.stack.idle.delete(r);r;){let n=Vr;t:for(;!n.done&&r===e[0];){const e=n.value;switch(e){case Tr:t.stack.idle.add(r);break t;case Sr:n=r.next(r);break;default:n=r.next(yield e)}}e.shift(),r=e[0],t.stack.idle.delete(r)}};const Nr=(t,e)=>new Ur(t,e),Pr=(t,e)=>jr(t,{ok:!1,error:e});function*jr(t,e){try{const r=t,n=e.ok?r.return(e.value):r.throw(e.error);if(!n.done)if(n.value===Tr){const{idle:t}=Ar.of(r).stack;t.add(r)}else Ir(r)}catch(t){}}function*zr(t){if(0===t.length)return;const e=yield*yr(),r=new Ar(e);let n=null;for(const e of t){const{result:t}=e;t?t.ok||n||(n=t):Br(e,r)}try{if(n)throw n.error;for(;yield*Dr(r),Rr.size(r.stack)>0;)yield*gr()}catch(t){for(const e of r.stack.active)yield*Pr(e,t);for(const e of r.stack.idle)yield*Pr(e,t),Ir(e);throw t}}const Br=(t,e)=>{const r=Ar.of(t);if(r!==e){const{active:n,idle:o}=r.stack,i=e.stack;if(t.group=e,o.has(t))o.delete(t),i.idle.add(t);else{const e=n.indexOf(t);e>=0&&(n.splice(e,1),i.active.push(t))}}};function*Fr(t){t.status===Hr&&(yield*t),t.result||(yield*zr([t]));const e=t.result;if(e.ok)return e.value;throw e.error}class Cr{constructor(t){this.handler=t,this.result}get promise(){const{result:t}=this,e=null==t?new Promise(((t,e)=>{this.handler.onsuccess=t,this.handler.onfailure=e})):t.ok?Promise.resolve(t.value):Promise.reject(t.error);return Object.defineProperty(this,"promise",{value:e}),e}then(t,e){return this.activate().promise.then(t,e)}catch(t){return this.activate().promise.catch(t)}finally(t){return this.activate().promise.finally(t)}activate(){return this}}class Ur extends Cr{constructor(t,e=qr,r={},n=Vr){super(r),this.id=++Mr,this.name=e.name||"",this.task=t,this.state=n,this.status=Hr,this.result,this.handler=r,this.controller}*resume(){Ir(this)}join(){return Fr(this)}abort(t){return Pr(this,t)}exit(t){return((t,e)=>jr(t,{ok:!0,value:e}))(this,t)}get[Symbol.toStringTag](){return"Fork"}*[Symbol.iterator](){return this.activate()}activate(){return this.controller=this.task[Symbol.iterator](),this.status=Gr,Ir(this),this}panic(t){this.result={ok:!1,error:t},this.status=$r;const{handler:e}=this;throw e.onfailure&&e.onfailure(t),t}step(t){if(this.state=t,t.done){this.result={ok:!0,value:t.value},this.status=$r;const{handler:e}=this;e.onsuccess&&e.onsuccess(t.value)}return t}next(t){try{return this.step(this.controller.next(t))}catch(t){return this.panic(t)}}return(t){try{return this.step(this.controller.return(t))}catch(t){return this.panic(t)}}throw(t){try{return this.step(this.controller.throw(t))}catch(t){return this.panic(t)}}}let Mr=0;const Hr="idle",Gr="active",$r="finished",Vr={done:!1,value:Sr},qr={},Yr=function*(){}(),Wr=new class{constructor(){this.status=Hr,this.stack=new Rr,this.id=0}};function Kr(){}Object.defineProperties(Kr,{prototype:{value:new Proxy(Object.prototype,{get:(t,e,r)=>"symbol"==typeof e?Reflect.get(t,e,r):r.get(e)})}});const Jr=()=>new Zr,Qr=(t,e=0,r=t.byteLength)=>{const n=[],o=e<0?t.byteLength-e:e,i=r<0?t.byteLength-r:r;if(0===o&&i>=t.byteLength)return t;if(o>i||o>t.byteLength||i<=0)return Jr();let a=0,s=0;for(const e of t.segments){const t=s+e.byteLength;if(0===a){if(i<=t){const t=e.subarray(o-s,i-s);n.push(t),a=t.byteLength;break}if(o<t){const t=o===s?e:e.subarray(o-s);n.push(t),a=t.byteLength}}else{if(i<=t){const r=i===t?e:e.subarray(0,i-s);n.push(r),a+=r.byteLength;break}n.push(e),a+=e.byteLength}s=t}return new Zr(n,t.byteOffset+o,a)};class Zr extends Kr{constructor(t=[],e=0,r=0){super(),this.segments=t,this.byteLength=r,this.length=r,this.byteOffset=e}[Symbol.iterator](){return function*(t){for(const e of t.segments)yield*e}(this)}slice(t,e){return Qr(this,t,e)}subarray(t,e){return Qr(this,t,e)}push(t){return((t,e)=>e.byteLength>0?(t.segments.push(e),new Zr(t.segments,t.byteOffset,t.byteLength+e.byteLength)):t)(this,t)}get(t){return((t,e)=>{if(e<t.byteLength){let r=0;for(const n of t.segments){if(e<r+n.byteLength)return n[e-r];r+=n.byteLength}}})(this,t)}copyTo(t,e){return((t,e,r)=>{let n=r;for(const r of t.segments)e.set(r,n),n+=r.byteLength;return e})(this,t,e)}}const Xr=t=>{throw new Error(t)},tn=(t,e,...r)=>Xr(String.raw(t,JSON.stringify(e),...r)),en=new Uint8Array(0),rn=[],nn=t=>({config:t,buffer:Jr()}),on=(t,e,r)=>{const n=t.chunker,o=[];let i=0;for(const t of n.cut(n.context,e,r))if(t>0){const r=e.subarray(i,i+t);o.push(r),i+=t}return{config:t,chunks:o,buffer:e.subarray(i)}},an=(t,e)=>{let r=un(e,{});for(const e of t){const{ready:t,has:n,wants:o}=hn(e.children,r.links);r=0===o.length?un(r,{links:cn(void 0,n),linked:[{id:e.id,links:t}]}):un(r,{needs:cn(e.id,o),nodes:{[e.id]:{children:e.children,count:o.length}}})}return r},sn=(t,e,r)=>{const n=r.needs[t],o=r.nodes[n];if(null!=o){if(1===o.count){const{ready:i,has:a}=hn(o.children,{...r.links,[t]:e});return un(r,{needs:{[t]:void 0},links:cn(void 0,a),nodes:{[n]:void 0},linked:[{id:n,links:i}]})}return un(r,{needs:{[t]:void 0},links:{[t]:e},nodes:{[n]:{...o,count:o.count-1}}})}return un(r,{links:{[t]:e}})},un=(t,{needs:e,nodes:r,links:n,linked:o})=>{const i=t.mutable?t:{...t},a=t.mutable?dn:void 0;return e&&(i.needs=ln(t.needs,e,a)),r&&(i.nodes=ln(t.nodes,r,a)),n&&(i.links=ln(t.links,n,a)),i.linked=o?fn(t.linked||pn,o,pn):t.linked||[],i},cn=(t,e)=>{const r={};for(const n of e)r[n]=t;return r},ln=(t,e,r=t)=>{const n=t===r?{...t}:t;for(const t of Object.entries(e)){const[e,r]=t;null==r?delete n[e]:n[e]=r}return n},fn=(t,e,r=t)=>{if(t===r)return[...t,...e];for(const r of e)t.push(r);return t},hn=(t,e)=>{const r=[],n=[],o=[];for(const i of t){const t=e[i];t?(r.push(i),o.push(t)):n.push(i)}return{has:r,wants:n,ready:o}},pn=Object.freeze([]),dn=Object.freeze({}),yn=(t,e)=>{switch(t.type){case"write":return gn(e,t.bytes);case"link":return bn(e,t.link);case"block":case"end":return{state:e,effect:xr()};case"close":return mn(e);default:return tn`File Writer got unknown message ${t}`}},gn=(t,e)=>{if("open"===t.status){const{chunks:r,...n}=((t,e)=>e.byteLength>0?on(t.config,t.buffer.push(e),!1):{...t,chunks:rn})(t.chunker,e),{nodes:o,leaves:i,layout:a}=t.config.fileLayout.write(t.layout,r),{linked:s,...u}=an(o,t.nodeQueue),c=[...vn(i,t.config),...kn(s,t.config)];return{state:{...t,chunker:n,layout:a,nodeQueue:u},effect:wr({link:kr(c)})}}return Xr("Unable to perform write on closed file")},bn=(t,{id:e,link:r,block:n})=>{let{linked:o,...i}=sn(e,r,t.nodeQueue);const a=kn(o,t.config),s="closed"===t.status&&e===t.rootID?{...t,status:"linked",link:r,nodeQueue:i}:{...t,nodeQueue:i},u="closed"===t.status&&e===t.rootID&&t.end?t.end.resume():xr();return{state:s,effect:wr({link:kr(a),block:_n(t.writer,n),end:u})}},mn=t=>{if("open"===t.status){const{chunks:e}=(t=>on(t.config,t.buffer,!0))(t.chunker),{layout:r,...n}=t.config.fileLayout.write(t.layout,e),{root:o,...i}=t.config.fileLayout.close(r,t.metadata),[a,s]=Ln(o)?[[...n.nodes,...i.nodes],[...n.leaves,...i.leaves,o]]:[[...n.nodes,...i.nodes,o],[...n.leaves,...i.leaves]],{linked:u,...c}=an(a,t.nodeQueue),l=[...vn(s,t.config),...kn(u,t.config)],f=Nr(gr());return{state:{...t,chunker:null,layout:null,rootID:o.id,status:"closed",end:f,nodeQueue:c},effect:wr({link:kr(l),end:Fr(f)})}}return{state:t,effect:xr()}},vn=(t,e)=>t.map((t=>wn(e,t,e.fileChunkEncoder))),wn=function*({hasher:t,linker:e},{id:r,content:n},o){const i=o.encode(n?xn(n):en),a=yield*br(t.digest(i)),s=e.createLink(o.code,a);return{id:r,block:{cid:s,bytes:i},link:{cid:s,contentByteLength:n?n.byteLength:0,dagByteLength:i.byteLength}}},kn=(t,e)=>t.map((t=>En(e,t))),En=function*(t,{id:e,links:r},n){const o=t.fileEncoder.encode({type:ye.File,layout:"advanced",parts:r,metadata:n}),i=yield*br(Promise.resolve(t.hasher.digest(o))),a=t.linker.createLink(t.fileEncoder.code,i);return{id:e,block:{bytes:o,cid:a},link:{cid:a,contentByteLength:Xe(r),dagByteLength:tr(o,r)}}},_n=function*(t,e){(t.desiredSize||0)<=0&&(yield*br(t.ready)),t.write(e)},xn=t=>t instanceof Uint8Array?t:t.copyTo(new Uint8Array(t.byteLength),0),Ln=t=>null==t.children,Sn="fixed",Tn={maxChunkSize:262144},An="Stateless",Rn=t=>({type:"Stateless",context:{maxChunkSize:t},name:Sn,cut:On}),On=({maxChunkSize:t},{byteLength:e},r)=>{const n=e/t|0,o=new Array(n).fill(t),i=r?e-n*t:0;return i>0&&o.push(i),o};function In({name:t,code:e,encode:r}){return new Dn(t,e,r)}class Dn{name;code;encode;constructor(t,e,r){this.name=t,this.code=e,this.encode=r}digest(t){if(t instanceof Uint8Array){const e=this.encode(t);return e instanceof Uint8Array?Ot(this.code,e):e.then((t=>Ot(this.code,t)))}throw Error("Unknown type, must be binary type")}}function Nn(t){return async e=>new Uint8Array(await crypto.subtle.digest(t,e))}const Pn=In({name:"sha2-256",code:18,encode:Nn("SHA-256")});In({name:"sha2-512",code:19,encode:Nn("SHA-512")});class jn{constructor(t,e,r){this.id=t,this.children=e,this.metadata=r}}const zn={width:174},Bn=({width:t}=zn)=>({width:t,head:null,leafIndex:[],nodeIndex:[],lastID:0}),Fn=(t,e)=>{if(0===e.length)return{layout:t,nodes:Hn,leaves:Hn};{let{lastID:r}=t;const[n,o]=t.head?[null,(e.unshift(t.head),e)]:1===e.length&&0===t.leafIndex.length?[e[0],Hn]:[null,e];if(0===o.length)return{layout:{...t,head:n},nodes:Hn,leaves:Hn};{const e=[...t.leafIndex],i=[];for(const t of o){const n={id:++r,content:t};i.push(n),e.push(n.id)}return e.length>t.width?Cn({...t,leafIndex:e,head:n,lastID:r},i):{layout:{...t,head:n,leafIndex:e,lastID:r},leaves:i,nodes:Hn}}}},Cn=(t,e=Hn,r=[],n=!1)=>{let{lastID:o}=t;const i=t.nodeIndex.map((t=>[...t])),a=[...t.leafIndex],{width:s}=t;for(;a.length>s||a.length>0&&n;){Mn(i,1);const t=new jn(++o,a.splice(0,s));i[0].push(t.id),r.push(t)}let u=0;for(;u<i.length;){const t=i[u];for(u++;t.length>s||t.length>0&&n&&u<i.length;){const e=new jn(++o,t.splice(0,s));Mn(i,u+1),i[u].push(e.id),r.push(e)}}return{layout:{...t,lastID:o,leafIndex:a,nodeIndex:i},leaves:e,nodes:r}},Un=(t,e)=>{const r=t;if(t.head)return{root:{id:1,content:t.head,metadata:e},leaves:Hn,nodes:Hn};if(0===t.leafIndex.length)return{root:{id:1,metadata:e},leaves:Hn,nodes:Hn};{const{nodes:t,layout:n}=Cn(r,Hn,[],!0),{nodeIndex:o}=n,i=o[o.length-1];if(1===i.length){const e=t[t.length-1];return t.length=t.length-1,{root:e,nodes:t,leaves:Hn}}return{root:new jn(n.lastID+1,i,e),nodes:t,leaves:Hn}}},Mn=(t,e)=>{for(;t.length<e;)t.push([]);return t},Hn=[],Gn=()=>{return{chunker:e,fileChunkEncoder:Vn,smallFileEncoder:Vn,fileEncoder:t,fileLayout:(r=174,{open:()=>Bn({width:r}),write:Fn,close:Un}),hasher:Pn,linker:{createLink:jt.createV1}};var r},$n=t=>({...Gn(),...t}),Vn={code:ke,name:Ee,encode:ze},qn=({writer:t,metadata:e={},settings:r=Gn()})=>new Wn(((t,e,r)=>({status:"open",metadata:e,config:r,writer:t,chunker:nn({chunker:r.chunker}),layout:r.fileLayout.open(),nodeQueue:{mutable:!0,needs:{},nodes:{},links:{},linked:pn}}))(t,e,$n(r))),Yn=(t,e)=>Nr(function*(t,e){const r=yield*yr(),n=new Ar(r);for(Ar.enqueue(t[Symbol.iterator](),n);;){for(const t of Dr(n))Ar.enqueue(e(t)[Symbol.iterator](),n);if(!(Rr.size(n.stack)>0))break;yield*gr()}}(e,(e=>{const{state:r,effect:n}=yn(e,t.state);return t.state=r,n})));class Wn{constructor(t){this.state=t}get writer(){return this.state.writer}get settings(){return this.state.config}write(t){return(async(t,e)=>(await Yn(t,vr({type:"write",bytes:e})),t))(this,t)}close(t){return(async(t,{releaseLock:e=!1,closeWriter:r=!1}={})=>{await Yn(t,vr({type:"close"}));const{state:n}=t;if("linked"===n.status)return r?await t.state.writer.close():e&&t.state.writer.releaseLock(),n.link;Xr(`Expected writer to be in 'linked' state after close, but it is in "${n.status}" instead`)})(this,t)}}const Kn=Gn,Jn=({writer:t,settings:e=Kn(),metadata:r={}})=>new eo({writer:t,metadata:r,settings:e,entries:new Map,closed:!1}),Qn=(t,e,r,{overwrite:n=!1}={})=>{const o=Xn(t.state);if(e.includes("/"))throw new Error(`Directory entry name "${e}" contains forbidden "/" character`);if(!n&&o.entries.has(e))throw new Error(`Directory already contains entry with name "${e}"`);return o.entries.set(e,r),t},Zn=(t,e)=>(Xn(t.state).entries.delete(e),t),Xn=t=>{if(t.closed)throw new Error("Can not change written directory, but you can .fork() and make changes to it");return t},to=function*({state:t}){for(const[e,{dagByteLength:r,cid:n}]of t.entries)yield{name:e,dagByteLength:r,cid:n}};class eo{constructor(t){this.state=t}get writer(){return this.state.writer}get settings(){return this.state.settings}links(){return to(this)}set(t,e,r){return Qn(this,t,e,r)}remove(t){return Zn(this,t)}fork(t){return(({state:t},{writer:e=t.writer,metadata:r=t.metadata,settings:n=t.settings}={})=>new eo({writer:e,metadata:r,settings:n,entries:new Map(t.entries.entries()),closed:!1}))(this,t)}close(t){return(async(t,{closeWriter:e=!1,releaseLock:r=!1}={})=>{const{writer:n,settings:o,metadata:i}=Xn(t.state);t.state.closed=!0;const a=[...to(t)],s=Ie(a,i),u=He(s),c=await o.hasher.digest(u),l=o.linker.createLink(ke,c);return(n.desiredSize||0)<=0&&await n.ready,n.write({cid:l,bytes:u}),e?await n.close():r&&n.releaseLock(),{cid:l,dagByteLength:tr(u,a)}})(this,t)}entries(){return this.state.entries.entries()}has(t){return this.state.entries.has(t)}get size(){return this.state.entries.size}}const ro=(t=32)=>{if(32!==t)throw new Error(`Uint32 BitField does not support size: ${t}`);return 0},no=(t,e)=>{let r=ro(e);for(const e of t)r=ao(r,e);return r},oo=t=>32,io=(t,e=31)=>co(t&((t,e)=>1<<((t,e)=>t>>>e&31)(t,e))(e,0)-1),ao=(t,e)=>t|1<<e,so=(t,e)=>t&(255^1<<e),uo=(t,e)=>!!(t>>e&1),co=t=>{const e=t-(t>>1&1431655765),r=(858993459&e)+(e>>2&858993459);return 16843009*(r+(r>>4)&252645135)>>24},lo=(t,e)=>t&e,fo=(t,e)=>t|e,ho=t=>Uint8Array.of(t>>24&255,t>>16&255,t>>8&255,255&t),po=t=>{if(4!==t.length)throw new Error(`Expected 4 bytes instead got ${t.length}`);return(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3]};var yo=__webpack_require__(437);const go=new TextEncoder,bo=yo.x64.hash126,mo=({bitWidth:t=5,hash:e=bo})=>{if(t>32)throw new RangeError(`Can not use bitWidth ${t} which exceeds the hashSize 4`);const r=4294967295>>>32-t;return{at:(e,n)=>e>>>n*t&r,from:t=>e(go.encode(t)),size:Math.ceil(32/t)}};class vo{constructor(t,e,r,n,o){this.edit=t,this.config=o,this.datamap=e,this.nodemap=r,this.children=n}get nodeArity(){return this.config.BitField.popcount(this.nodemap)}get dataArity(){return this.config.BitField.popcount(this.datamap)}empty(){return So(this.config)}lookup(t,e,r,n){return Ao(this,t,e,r,n)}associate(t,e,r,n,o,i){return Oo(this,t,e,r,n,o,i)}dissociate(t,e,r,n,o){return Do(this,t,e,r,n,o)}fork(t=null){return Po(this,t)}entries(){return No(this)}keys(){return jo(this)}values(){return zo(this)}}class wo{constructor(t,e,r,n){this.edit=t,this.count=e,this.children=r,this.config=n}get nodeArity(){return 0}get dataArity(){return this.count}lookup(t,e,r,n){return ko(this,r,n)}associate(t,e,r,n,o,i){return Eo(this,t,r,n,o,i)}dissociate(t,e,r,n,o){return _o(this,t,r,n,o)}fork(t=null){return xo(this,t)}entries(){return No(this)}keys(){return jo(this)}values(){return zo(this)}}const ko=(t,e,r)=>{const{children:n,count:o}=t,i=Lo(n,o,e);return n[i]===e?n[i+1]:r},Eo=(t,e,r,n,o,i)=>{const{children:a,count:s}=t,u=Lo(a,s,n);if(a[u]!==n){const n=t.fork(e);return i.value=!0,n.count+=1,n.children.splice(u,r,o),n}if(a[u+1]!==o){const r=t.fork(e);return r.children[u+1]=o,r}return t},_o=(t,e,r,n,o)=>{const{children:i,count:a,config:s}=t,u=Lo(i,a,n);if(i[u]!==n)return t;if(o.value=!0,2===a){const t=0===u?2:0;return Oo(So(s),e,0,r,i[t],i[t+1],o)}{const r=t.fork(e);return r.children.splice(u,2),r.count-=1,r}},xo=(t,e=null)=>Wo(t.edit,e)?t:new wo(e,t.count,t.children.slice(),t.config),Lo=(t,e,r)=>{let n=0;for(;n<e&&t[n]>r;)n+=2;return n},So=(t,e=null)=>new vo(e,t.BitField.empty(Math.pow(2,t.bitWidth)),t.BitField.empty(Math.pow(2,t.bitWidth)),[],t),To=(t,e,r)=>Ao(t,0,t.config.Path.from(e),e,r),Ao=(t,e,r,n,o)=>{const{datamap:i,nodemap:a,config:s}=t,{Path:u,BitField:c}=s,l=u.at(r,e);if(c.get(i,l)){const e=c.popcount(i,l);return Ho(t,e)===n?$o(t,e):o}if(c.get(a,l)){return qo(t,l).lookup(e+1,r,n,o)}return o},Ro=(t,e,r,n,o)=>Oo(t,e,0,t.config.Path.from(r),r,n,o),Oo=(t,e,r,n,o,i,a)=>{const{datamap:s,nodemap:u,config:c}=t,{Path:l,BitField:f}=c,h=l.at(n,r);if(f.get(s,h)){const u=f.popcount(s,h),p=Ho(t,u);if(o===p)return $o(t,u)===i?t:Bo(t,e,u,i);{const s=Mo(c,e,r+1,l.from(p),p,$o(t,u),n,o,i);return a.value=!0,Uo(t,e,h,s)}}if(f.get(u,h)){const s=qo(t,h),u=s.associate(e,r+1,n,o,i,a);return s===u?t:Co(t,e,h,u)}{const r=f.popcount(s,h);a.value=!0;const n=t.fork(e);return n.datamap=f.set(s,h),n.children.splice(Go(r),0,o,i),n}},Io=(t,e,r,n)=>Do(t,e,0,t.config.Path.from(r),r,n),Do=(t,e,r,n,o,i)=>{const{datamap:a,nodemap:s,config:u}=t,{BitField:c,Path:l}=u,f=l.at(n,r);if(c.get(a,f)){const r=c.popcount(a,f);if(o===Ho(t,r)){i.value=!0;const n=Po(t,e);return n.datamap=c.unset(t.datamap,f),n.children.splice(Go(r),2),n}return t}if(c.get(s,f)){const a=qo(t,f),s=a.dissociate(e,r+1,n,o,i);return Ko(s)?Jo(t)?s:Fo(t,e,f,s):a===s?t:Co(t,e,f,s)}return t},No=function*({children:t}){let e=0;const r=t.length;for(;e<r;){const r=t[e];if("string"!=typeof r)break;{e+=1;const n=t[e];yield[r,n],e+=1}}for(;e<r;){const r=t[e];yield*r.entries(),e+=1}},Po=(t,e)=>{if(Wo(t.edit,e))return t;return new vo(e,t.datamap,t.nodemap,t.children.slice(),t.config)},jo=function*({children:t}){let e=0;const r=t.length;for(;e<r;){const r=t[e];if("string"!=typeof r)break;yield r,e+=2}for(;e<r;){const r=t[e];yield*r.keys(),e+=1}},zo=function*({children:t}){let e=0;const r=t.length;for(;e<r;){if("string"!=typeof t[e])break;e+=1,yield t[e],e+=1}for(;e<r;){const r=t[e];yield*r.values(),e+=1}},Bo=(t,e,r,n)=>{const o=t.fork(e);return o.children[Vo(r)]=n,o},Fo=(t,e,r,n)=>{const{datamap:o,nodemap:i,config:a}=t,{BitField:s}=a,u=Po(t,e);return u.children.splice(Yo(t,r),1),u.children.splice(Go(s.popcount(o,r)),0,n.children[0],n.children[1]),u.datamap=s.set(o,r),u.nodemap=s.unset(i,r),u},Co=(t,e,r,n)=>{const o=Po(t,e);return o.children[Yo(t,r)]=n,o},Uo=(t,e,r,n)=>{const{nodemap:o,datamap:i,config:a}=t,{BitField:s}=a,u=s.popcount(i,r),c=Go(u),l=Yo(t,r),f=Po(t,e);return f.datamap=s.unset(i,r),f.children.splice(c,2),f.nodemap=s.set(o,r),f.children.splice(l-1,0,n),f},Mo=(t,e,r,n,o,i,a,s,u)=>{const{BitField:c,Path:l}=t;if(l.size<r)return new wo(e,2,[o,i,s,u],t);{const f=l.at(n,r),h=l.at(a,r);return f===h?new vo(e,c.empty(Math.pow(2,t.bitWidth)),c.from([f],Math.pow(2,t.bitWidth)),[Mo(t,e,r+1,n,o,i,a,s,u)],t):new vo(e,c.from([f,h],Math.pow(2,t.bitWidth)),c.empty(Math.pow(2,t.bitWidth)),f<h?[o,i,s,u]:[s,u,o,i],t)}},Ho=({children:t},e)=>t[Go(e)],Go=t=>2*t,$o=({children:t},e)=>t[Vo(e)],Vo=t=>2*t+1,qo=(t,e)=>t.children[Yo(t,e)],Yo=({children:t,nodemap:e,config:r},n)=>t.length-1-r.BitField.popcount(e,n),Wo=(t,e)=>null!=t&&t===e,Ko=t=>0===t.nodeArity&&1===t.dataArity,Jo=({config:{BitField:t},datamap:e,nodemap:r})=>0===t.popcount(e)&&1===t.popcount(r);In({name:"murmur3-32",code:35,encode:t=>function(t){const e=new Array(4);for(let r=0;r<4;r++)e[r]=255&t,t>>=8;return new Uint8Array(e)}(yo.x86.hash32(t))}),In({name:"murmur3-128",code:34,encode:t=>K(yo.x64.hash128(t))});const Qo=In({name:"murmur3-x64-64",code:34,encode:t=>K(yo.x64.hash128(t)).subarray(0,8)}),Zo=new TextEncoder,Xo=t=>Qo.encode(t),ti=({bitWidth:t=8,hash:e=Xo}={})=>{const r=e(new Uint8Array).byteLength;return{from:t=>e(Zo.encode(t)),at:(e,n)=>{const o=n*t;if(o>r)throw new RangeError("Out of bounds");return ei(e,o,t)},size:Math.ceil(8*r/t)}},ei=(t,e,r)=>{let n=e/8|0,o=e%8,i=r,a=0;for(;i>0&&n<t.byteLength;){const e=8-o,r=e<i?e:i;a=(a<<r)+((255>>o&t[n])>>8-o-r),i-=r,n++,o=0}return a},ri=(t=256)=>{if(t%8!=0)throw new Error("Must be multiple of 8");return new Uint8Array(t/8)},ni=(t,e)=>{let r=ri(e);for(const e of t){const{byte:t,byteOffset:n,bitOffset:o}=ii(r,e);r[n]=t|1<<o}return r},oi=t=>8*t.byteLength,ii=(t,e)=>{const r=t.byteLength-1-(e/8|0),n=e%8;return{byte:t[r],byteOffset:r,bitOffset:n}},ai=(t,e,r)=>{if(t[e]!==r){const n=t.slice(0);return n[e]=r,n}return t},si=(t,e)=>{const{byte:r,byteOffset:n,bitOffset:o}=ii(t,e);return ai(t,n,r|1<<o)},ui=(t,e)=>{const{byte:r,byteOffset:n,bitOffset:o}=ii(t,e);return ai(t,n,r&(255^1<<o))},ci=(t,e)=>{var{byte:r,bitOffset:n}=ii(t,e);return!!(r>>n&1)},li=t=>t,fi=t=>t,hi=(t,e=8*t.byteLength)=>{const{byteOffset:r,bitOffset:n,byte:o}=ii(t,e);let i=io(o,n),a=t.byteLength-1;for(;a>r;){const e=t[a];i+=co(e),a--}return i},pi=(t,e)=>{const r=t.slice();let n=0;for(;n<t.length;)r[n]|=e[n],n++;return r},di=(t,e)=>{const r=t.slice();let n=0;for(;n<t.length;)r[n]&=e[n],n++;return r},yi=new RangeError("Not Found"),gi=({bitWidth:t=5,BitField:e=(5===t?n:i),Path:r=(5===t?mo({bitWidth:t}):ti({bitWidth:t}))}={})=>({bitWidth:t,BitField:e,Path:r}),bi=(t,e)=>To(t.root,e,yi)!==yi,mi=t=>{const e={},r=gi(t);return new wi(e,0,So(r,e),r)};class vi{constructor(t=0,e,r){this.count=t,this.root=e,this.config=r}get size(){return this.count}clone(){return new vi(this.count,this.root,this.config)}empty(){return new vi(0,So(this.config,null),this.config)}has(t){return bi(this,t)}get(t){return To(this.root,t,void 0)}set(t,e){const r={value:!1},n=Ro(this.root,null,t,e,r);return n===this.root?this:new vi(r.value?this.count+1:this.count,n,this.config)}delete(t){const e=Io(this.root,null,t,{value:!1});return e===this.root?this:new vi(this.count-1,e,this.config)}get bitField(){return this.config.BitField.or(this.root.datamap,this.root.nodemap)}[Symbol.iterator](){return this.entries()}entries(){return this.root.entries()}keys(){return this.root.keys()}values(){return this.root.values()}createBuilder(){return new wi({},this.count,this.root,this.config)}}class wi{constructor(t,e,r,n){this.edit=t,this.count=e,this.root=r,this.config=n}get size(){if(this.edit)return this.count;throw new Error(".size was accessed on the finalized builder")}set(t,e){if(this.edit){const r={value:!1},n=Ro(this.root,this.edit,t,e,r);return this.root!==n&&(this.root=n),r.value&&(this.count+=1),this}throw new Error(".set was called on the finalized builder")}delete(t){if(this.edit){if(0===this.count)return this;const e={value:!1},r=Io(this.root,this.edit,t,e);return r!==this.root&&(this.root=r),e.value&&(this.count-=1),this}throw new Error(".delete was called on the finalized builder")}build(){if(this.edit)return this.edit=null,new vi(this.count,this.root,this.config);throw new Error(".build was called on the finalized builder")}}const ki=new TextEncoder,Ei=t=>Qo.encode(t),_i=(t,e=0,{bitWidth:r=8,hash:n,hashSize:o})=>{const i=8*o;let a=0,s=r,u=r*e;for(;s>0;){const e=u/i|0,r=n(0===e?t:xi(t,e)),o=i<=u?u%i:u,c=i-o,l=c<s?c:s;a=(a<<l)+ei(r,o,l),s-=l,u+=l}return a},xi=(t,e)=>{const r=new Uint8Array(t.byteLength+1).fill(e,t.byteLength);return r.set(t),r},Li={bitWidth:8,Path:(({bitWidth:t=8,hash:e=Ei})=>{const r=e(new Uint8Array).byteLength,n={bitWidth:t,hash:e,hashSize:r};return{at:(t,e)=>_i(t,e,n),from:t=>ki.encode(t),size:1/0}})({bitWidth:8})},Si=(t=Li)=>mi(t),Ti=(t,e=Li)=>((t,e)=>{const r=mi(e);for(const[e,n]of t)r.set(e,n);return r.build()})(t,e),Ai=t=>{let e=0;for(;e<t.byteLength;){if(0!==t[e])return t.subarray(e);e+=1}return t.subarray(e)};function Ri({enumerable:t=!0,configurable:e=!1}={}){return{enumerable:t,configurable:e,writable:!1}}function*Oi(t,e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))for(const[r,n]of e.entries()){const e=[...t,r],o=jt.asCID(n);null!=o?yield[e.join("/"),o]:"object"==typeof n&&(yield*Ii(n,e))}else{const r=jt.asCID(e);null!=r?yield[t.join("/"),r]:yield*Ii(e,t)}}function*Ii(t,e){if(null==t||t instanceof Uint8Array)return;const r=jt.asCID(t);null!=r&&(yield[e.join("/"),r]);for(const[r,n]of Object.entries(t)){const t=[...e,r];yield*Oi(t,n)}}function*Di(t,e){if(Array.isArray(e))for(const[r,n]of e.entries()){const e=[...t,r];yield e.join("/"),"object"==typeof n&&null==jt.asCID(n)&&(yield*Ni(n,e))}else yield*Ni(e,t)}function*Ni(t,e){if(null!=t&&"object"==typeof t)for(const[r,n]of Object.entries(t)){const t=[...e,r];yield t.join("/"),null==n||n instanceof Uint8Array||"object"!=typeof n||null!=jt.asCID(n)||(yield*Di(t,n))}}class Pi{cid;bytes;value;asBlock;constructor({cid:t,bytes:e,value:r}){if(null==t||null==e||void 0===r)throw new Error("Missing required argument");this.cid=t,this.bytes=e,this.value=r,this.asBlock=this,Object.defineProperties(this,{cid:Ri(),bytes:Ri(),value:Ri(),asBlock:Ri()})}links(){return Ii(this.value,[])}tree(){return Ni(this.value,[])}get(t="/"){return function(t,e){let r=t;for(const[t,n]of e.entries()){if(r=r[n],null==r)throw new Error(`Object has no property at ${e.slice(0,t+1).map((t=>`[${JSON.stringify(t)}]`)).join("")}`);const o=jt.asCID(r);if(null!=o)return{value:o,remaining:e.slice(t+1).join("/")}}return{value:r}}(this.value,t.split("/").filter(Boolean))}}const ji=Gn,zi=async(t,{closeWriter:e=!1,releaseLock:r=!1}={})=>{const{writer:n,settings:o,metadata:i}=(t=>{if(t.closed)throw new Error("Can not change written HAMT directory, but you can .fork() and make changes to it");return t})(t.state);t.state.closed=!0;const{entries:a}=t.state;if(!(a instanceof Ci))throw new Error(`not a HAMT: ${a}`);const s=a.builder.build(),u=Bi(s,s.root,o);let c=null;for await(const t of u)c=t,(n.desiredSize||0)<=0&&await n.ready,n.write(t);if(null==c)throw new Error("no root block yielded");return e?await n.close():r&&n.releaseLock(),{cid:c.cid,dagByteLength:tr(c.bytes,c.value.entries)}},Bi=async function*(t,e,r){const n=[];for(const o of function*(t){const{config:e,datamap:r,nodemap:n}=t,{BitField:o}=e,i=o.size(r);let a=0,s=0;for(;a<i;){const e=a.toString(16).toUpperCase().padStart(2,"0");if(o.get(r,a)){const r=Ho(t,s);yield{prefix:e,key:r,value:$o(t,s)},s++}else o.get(n,a)&&(yield{prefix:e,node:qo(t,a)});a++}}(e))if("key"in o)n.push({name:`${o.prefix??""}${o.key??""}`,dagByteLength:o.value.dagByteLength,cid:o.value.cid});else{let e=null;for await(const n of Bi(t,o.node,r))yield n,e=n;if(null==e)throw new Error("no root block yielded");n.push({name:o.prefix,dagByteLength:tr(e.bytes,e.value.entries),cid:e.cid})}const o=Ne(n,(({datamap:t,nodemap:e,config:{BitField:r}})=>Ai(r.toBytes(r.or(t,e))))(e),(t=>Math.pow(2,t.config.bitWidth))(t),Qo.code);yield await async function(t,e){const r=Ge(t),n=await e.hasher.digest(r),o=e.linker.createLink(112,n);return new Pi({cid:o,bytes:r,value:t})}(o,r)};class Fi{constructor(t){this.state=t}get writer(){return this.state.writer}get settings(){return this.state.settings}set(t,e,r){return Qn(this,t,e,r)}remove(t){return Zn(this,t)}fork(t){return(({state:t},{writer:e=t.writer,metadata:r=t.metadata,settings:n=t.settings}={})=>new Fi({writer:e,metadata:r,settings:n,entries:new Ci(Ti(t.entries.entries()).createBuilder()),closed:!1}))(this,t)}close(t){return zi(this,t)}entries(){return this.state.entries.entries()}has(t){return this.state.entries.has(t)}get size(){return this.state.entries.size}}class Ci extends Map{constructor(t=Si()){super(),this.builder=t}clear(){this.builder=Si()}delete(t){const{root:e}=this.builder;return this.builder.delete(t),this.builder.root!==e}forEach(t,e=this){for(const[r,n]of this.builder.root.entries())t.call(e,n,r,this)}get(t){return((t,e,r)=>To(t.root,e,r))(this.builder,t)}has(t){return bi(this.builder,t)}set(t,e){return this.builder.set(t,e),this}get size(){return this.builder.size}[Symbol.iterator](){return this.builder.root.entries()}entries(){return this.builder.root.entries()}keys(){return this.builder.root.keys()}values(){return this.builder.root.values()}}class Ui{constructor({writer:t,settings:e}){this.writer=t,this.settings=$n(e)}createFileWriter({settings:t=this.settings,metadata:e}={}){return qn({writer:this.writer,settings:t,metadata:e})}createDirectoryWriter({settings:t=this.settings,metadata:e}={}){return Jn({writer:this.writer,settings:t,metadata:e})}close(t){return(async(t,{releaseLock:e=!0,closeWriter:r=!0}={})=>(r?await t.writer.close():e&&t.writer.releaseLock(),t))(this,t)}}const Mi="raw",Hi=85;function Gi(t){return J(t)}function $i(t){return J(t)}const Vi=((t=104857600)=>({highWaterMark:t,size:t=>t.bytes.length}))(),qi=$n({fileChunkEncoder:a,smallFileEncoder:a});class Yi{#t;constructor(t){this.#t=t}async finalize(t){const e=qn(t);return await this.#t.stream().pipeTo(new WritableStream({async write(t){await e.write(t)}})),e.close()}}class Wi{entries=new Map;async finalize(t){const e=this.entries.size<=1e3?Jn(t):(({writer:t,settings:e=ji(),metadata:r={}})=>new Fi({writer:t,metadata:r,settings:e,entries:new Ci,closed:!1}))(t);for(const[r,n]of this.entries){const o=await n.finalize(t);e.set(r,o)}return e.close()}}function Ki(t,e=qi){const r=new Wi;for(const e of t){const t=e.name.split("/");""!==t[0]&&"."!==t[0]||t.shift();let n=r;for(const[r,o]of t.entries()){if(r===t.length-1){n.entries.set(o,new Yi(e));break}let i=n.entries.get(o);if(null==i&&(i=new Wi,n.entries.set(o,i)),!(i instanceof Wi))throw new Error(`"${o}" cannot be a file and a directory`);n=i}}const{readable:n,writable:o}=new TransformStream({},Vi),i=(({writable:t,settings:e=Gn()})=>new Ui({writer:t.getWriter(),settings:e}))({writable:o,settings:e});return(async()=>{await r.finalize(i),await i.close()})(),n}var Ji=__webpack_require__(203);const Qi=["string","number","bigint","symbol"],Zi=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Xi(t){if(null===t)return"null";if(void 0===t)return"undefined";if(!0===t||!1===t)return"boolean";const e=typeof t;if(Qi.includes(e))return e;if("function"===e)return"Function";if(Array.isArray(t))return"Array";if(function(t){return t&&t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer.call(null,t)}(t))return"Buffer";const r=function(t){const e=Object.prototype.toString.call(t).slice(8,-1);if(Zi.includes(e))return e;return}(t);return r||"Object"}class ta{constructor(t,e,r){this.major=t,this.majorEncoded=t<<5,this.name=e,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}}ta.uint=new ta(0,"uint",!0),ta.negint=new ta(1,"negint",!0),ta.bytes=new ta(2,"bytes",!0),ta.string=new ta(3,"string",!0),ta.array=new ta(4,"array",!1),ta.map=new ta(5,"map",!1),ta.tag=new ta(6,"tag",!1),ta.float=new ta(7,"float",!0),ta.false=new ta(7,"false",!0),ta.true=new ta(7,"true",!0),ta.null=new ta(7,"null",!0),ta.undefined=new ta(7,"undefined",!0),ta.break=new ta(7,"break",!0);class ea{constructor(t,e,r){this.type=t,this.value=e,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const ra=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"==typeof globalThis.Buffer.isBuffer,na=new TextDecoder,oa=new TextEncoder;function ia(t){return ra&&globalThis.Buffer.isBuffer(t)}function aa(t){return t instanceof Uint8Array?ia(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t:Uint8Array.from(t)}const sa=ra?(t,e,r)=>r-e>64?globalThis.Buffer.from(t.subarray(e,r)).toString("utf8"):da(t,e,r):(t,e,r)=>r-e>64?na.decode(t.subarray(e,r)):da(t,e,r),ua=ra?t=>t.length>64?globalThis.Buffer.from(t):pa(t):t=>t.length>64?oa.encode(t):pa(t),ca=t=>Uint8Array.from(t),la=ra?(t,e,r)=>ia(t)?new Uint8Array(t.subarray(e,r)):t.slice(e,r):(t,e,r)=>t.slice(e,r),fa=ra?(t,e)=>(t=t.map((t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t))),aa(globalThis.Buffer.concat(t,e))):(t,e)=>{const r=new Uint8Array(e);let n=0;for(let e of t)n+e.length>r.length&&(e=e.subarray(0,r.length-n)),r.set(e,n),n+=e.length;return r},ha=ra?t=>globalThis.Buffer.allocUnsafe(t):t=>new Uint8Array(t);function pa(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let o=t.charCodeAt(n);o<128?e[r++]=o:o<2048?(e[r++]=o>>6|192,e[r++]=63&o|128):55296==(64512&o)&&n+1<t.length&&56320==(64512&t.charCodeAt(n+1))?(o=65536+((1023&o)<<10)+(1023&t.charCodeAt(++n)),e[r++]=o>>18|240,e[r++]=o>>12&63|128,e[r++]=o>>6&63|128,e[r++]=63&o|128):(e[r++]=o>>12|224,e[r++]=o>>6&63|128,e[r++]=63&o|128)}return e}function da(t,e,r){const n=[];for(;e<r;){const o=t[e];let i=null,a=o>239?4:o>223?3:o>191?2:1;if(e+a<=r){let r,n,s,u;switch(a){case 1:o<128&&(i=o);break;case 2:r=t[e+1],128==(192&r)&&(u=(31&o)<<6|63&r,u>127&&(i=u));break;case 3:r=t[e+1],n=t[e+2],128==(192&r)&&128==(192&n)&&(u=(15&o)<<12|(63&r)<<6|63&n,u>2047&&(u<55296||u>57343)&&(i=u));break;case 4:r=t[e+1],n=t[e+2],s=t[e+3],128==(192&r)&&128==(192&n)&&128==(192&s)&&(u=(15&o)<<18|(63&r)<<12|(63&n)<<6|63&s,u>65535&&u<1114112&&(i=u))}}null===i?(i=65533,a=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),e+=a}return function(t){const e=t.length;if(e<=ya)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=ya));return r}(n)}const ya=4096;class ga{constructor(t=256){this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let e=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){const r=e.length-(this.maxCursor-this.cursor)-1;e.set(t,r)}else{if(e){const t=e.length-(this.maxCursor-this.cursor)-1;t<e.length&&(this.chunks[this.chunks.length-1]=e.subarray(0,t),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(e=ha(this.chunkSize),this.chunks.push(e),this.maxCursor+=e.length,null===this._initReuseChunk&&(this._initReuseChunk=e),e.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(t=!1){let e;if(1===this.chunks.length){const r=this.chunks[0];t&&this.cursor>r.length/2?(e=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):e=la(r,0,this.cursor)}else e=fa(this.chunks,this.cursor);return t&&this.reset(),e}}const ba="CBOR decode error:",ma="CBOR encode error:",va=[];function wa(t,e,r){if(t.length-e<r)throw new Error(`${ba} not enough data for type`)}va[23]=1,va[24]=2,va[25]=3,va[26]=5,va[27]=9;const ka=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Ea(t,e,r){wa(t,e,1);const n=t[e];if(!0===r.strict&&n<ka[0])throw new Error(`${ba} integer encoded in more bytes than necessary (strict decode)`);return n}function _a(t,e,r){wa(t,e,2);const n=t[e]<<8|t[e+1];if(!0===r.strict&&n<ka[1])throw new Error(`${ba} integer encoded in more bytes than necessary (strict decode)`);return n}function xa(t,e,r){wa(t,e,4);const n=16777216*t[e]+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];if(!0===r.strict&&n<ka[2])throw new Error(`${ba} integer encoded in more bytes than necessary (strict decode)`);return n}function La(t,e,r){wa(t,e,8);const n=16777216*t[e]+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3],o=16777216*t[e+4]+(t[e+5]<<16)+(t[e+6]<<8)+t[e+7],i=(BigInt(n)<<BigInt(32))+BigInt(o);if(!0===r.strict&&i<ka[3])throw new Error(`${ba} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(!0===r.allowBigInt)return i;throw new Error(`${ba} integers outside of the safe integer range are not supported`)}function Sa(t,e){return Ta(t,0,e.value)}function Ta(t,e,r){if(r<ka[0]){const n=Number(r);t.push([e|n])}else if(r<ka[1]){const n=Number(r);t.push([24|e,n])}else if(r<ka[2]){const n=Number(r);t.push([25|e,n>>>8,255&n])}else if(r<ka[3]){const n=Number(r);t.push([26|e,n>>>24&255,n>>>16&255,n>>>8&255,255&n])}else{const n=BigInt(r);if(!(n<ka[4]))throw new Error(`${ba} encountered BigInt larger than allowable range`);{const r=[27|e,0,0,0,0,0,0,0];let o=Number(n&BigInt(4294967295)),i=Number(n>>BigInt(32)&BigInt(4294967295));r[8]=255&o,o>>=8,r[7]=255&o,o>>=8,r[6]=255&o,o>>=8,r[5]=255&o,r[4]=255&i,i>>=8,r[3]=255&i,i>>=8,r[2]=255&i,i>>=8,r[1]=255&i,t.push(r)}}}Sa.encodedSize=function(t){return Ta.encodedSize(t.value)},Ta.encodedSize=function(t){return t<ka[0]?1:t<ka[1]?2:t<ka[2]?3:t<ka[3]?5:9},Sa.compareTokens=function(t,e){return t.value<e.value?-1:t.value>e.value?1:0};const Aa=BigInt(-1),Ra=BigInt(1);function Oa(t,e){const r=e.value,n="bigint"==typeof r?r*Aa-Ra:-1*r-1;Ta(t,e.type.majorEncoded,n)}function Ia(t,e,r,n){wa(t,e,r+n);const o=la(t,e+r,e+r+n);return new ea(ta.bytes,o,r+n)}function Da(t,e,r,n){return Ia(t,e,1,r)}function Na(t){return void 0===t.encodedBytes&&(t.encodedBytes=t.type===ta.string?ua(t.value):t.value),t.encodedBytes}function Pa(t,e){const r=Na(e);Ta(t,e.type.majorEncoded,r.length),t.push(r)}function ja(t,e,r,n,o){const i=r+n;wa(t,e,i);const a=new ea(ta.string,sa(t,e+r,e+i),i);return!0===o.retainStringBytes&&(a.byteValue=la(t,e+r,e+i)),a}function za(t,e,r,n){return ja(t,e,1,r,n)}Oa.encodedSize=function(t){const e=t.value,r="bigint"==typeof e?e*Aa-Ra:-1*e-1;return r<ka[0]?1:r<ka[1]?2:r<ka[2]?3:r<ka[3]?5:9},Oa.compareTokens=function(t,e){return t.value<e.value?1:t.value>e.value?-1:0},Pa.encodedSize=function(t){const e=Na(t);return Ta.encodedSize(e.length)+e.length},Pa.compareTokens=function(t,e){return r=Na(t),n=Na(e),r.length<n.length?-1:r.length>n.length?1:function(t,e){if(ia(t)&&ia(e))return t.compare(e);for(let r=0;r<t.length;r++)if(t[r]!==e[r])return t[r]<e[r]?-1:1;return 0}(r,n);var r,n};const Ba=Pa;function Fa(t,e,r,n){return new ea(ta.array,n,r)}function Ca(t,e,r,n){return Fa(0,0,1,r)}function Ua(t,e){Ta(t,ta.array.majorEncoded,e.value)}function Ma(t,e,r,n){return new ea(ta.map,n,r)}function Ha(t,e,r,n){return Ma(0,0,1,r)}function Ga(t,e){Ta(t,ta.map.majorEncoded,e.value)}function $a(t,e,r,n){return new ea(ta.tag,r,1)}function Va(t,e){Ta(t,ta.tag.majorEncoded,e.value)}Ua.compareTokens=Sa.compareTokens,Ua.encodedSize=function(t){return Ta.encodedSize(t.value)},Ga.compareTokens=Sa.compareTokens,Ga.encodedSize=function(t){return Ta.encodedSize(t.value)},Va.compareTokens=Sa.compareTokens,Va.encodedSize=function(t){return Ta.encodedSize(t.value)};const qa=20,Ya=21,Wa=22,Ka=23;function Ja(t,e,r){if(r){if(!1===r.allowNaN&&Number.isNaN(t))throw new Error(`${ba} NaN values are not supported`);if(!1===r.allowInfinity&&(t===1/0||t===-1/0))throw new Error(`${ba} Infinity values are not supported`)}return new ea(ta.float,t,e)}function Qa(t,e,r){const n=e.value;if(!1===n)t.push([ta.float.majorEncoded|qa]);else if(!0===n)t.push([ta.float.majorEncoded|Ya]);else if(null===n)t.push([ta.float.majorEncoded|Wa]);else if(void 0===n)t.push([ta.float.majorEncoded|Ka]);else{let e,i=!1;r&&!0===r.float64||(es(n),e=rs(ts,1),n===e||Number.isNaN(n)?(ts[0]=249,t.push(ts.slice(0,3)),i=!0):(ns(n),e=os(ts,1),n===e&&(ts[0]=250,t.push(ts.slice(0,5)),i=!0))),i||(o=n,Xa.setFloat64(0,o,!1),e=is(ts,1),ts[0]=251,t.push(ts.slice(0,9)))}var o}Qa.encodedSize=function(t,e){const r=t.value;if(!1===r||!0===r||null==r)return 1;if(!e||!0!==e.float64){es(r);let t=rs(ts,1);if(r===t||Number.isNaN(r))return 3;if(ns(r),t=os(ts,1),r===t)return 5}return 9};const Za=new ArrayBuffer(9),Xa=new DataView(Za,1),ts=new Uint8Array(Za,0);function es(t){if(t===1/0)Xa.setUint16(0,31744,!1);else if(t===-1/0)Xa.setUint16(0,64512,!1);else if(Number.isNaN(t))Xa.setUint16(0,32256,!1);else{Xa.setFloat32(0,t);const e=Xa.getUint32(0),r=(2139095040&e)>>23,n=8388607&e;if(255===r)Xa.setUint16(0,31744,!1);else if(0===r)Xa.setUint16(0,(2147483648&t)>>16|n>>13,!1);else{const t=r-127;t<-24?Xa.setUint16(0,0):t<-14?Xa.setUint16(0,(2147483648&e)>>16|1<<24+t,!1):Xa.setUint16(0,(2147483648&e)>>16|t+15<<10|n>>13,!1)}}}function rs(t,e){if(t.length-e<2)throw new Error(`${ba} not enough data for float16`);const r=(t[e]<<8)+t[e+1];if(31744===r)return 1/0;if(64512===r)return-1/0;if(32256===r)return NaN;const n=r>>10&31,o=1023&r;let i;return i=0===n?o*2**-24:31!==n?(o+1024)*2**(n-25):0===o?1/0:NaN,32768&r?-i:i}function ns(t){Xa.setFloat32(0,t,!1)}function os(t,e){if(t.length-e<4)throw new Error(`${ba} not enough data for float32`);const r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,4).getFloat32(0,!1)}function is(t,e){if(t.length-e<8)throw new Error(`${ba} not enough data for float64`);const r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,8).getFloat64(0,!1)}function as(t,e,r){throw new Error(`${ba} encountered invalid minor (${r}) for major ${t[e]>>>5}`)}function ss(t){return()=>{throw new Error(`${ba} ${t}`)}}Qa.compareTokens=Sa.compareTokens;const us=[];for(let t=0;t<=23;t++)us[t]=as;us[24]=function(t,e,r,n){return new ea(ta.uint,Ea(t,e+1,n),2)},us[25]=function(t,e,r,n){return new ea(ta.uint,_a(t,e+1,n),3)},us[26]=function(t,e,r,n){return new ea(ta.uint,xa(t,e+1,n),5)},us[27]=function(t,e,r,n){return new ea(ta.uint,La(t,e+1,n),9)},us[28]=as,us[29]=as,us[30]=as,us[31]=as;for(let t=32;t<=55;t++)us[t]=as;us[56]=function(t,e,r,n){return new ea(ta.negint,-1-Ea(t,e+1,n),2)},us[57]=function(t,e,r,n){return new ea(ta.negint,-1-_a(t,e+1,n),3)},us[58]=function(t,e,r,n){return new ea(ta.negint,-1-xa(t,e+1,n),5)},us[59]=function(t,e,r,n){const o=La(t,e+1,n);if("bigint"!=typeof o){const t=-1-o;if(t>=Number.MIN_SAFE_INTEGER)return new ea(ta.negint,t,9)}if(!0!==n.allowBigInt)throw new Error(`${ba} integers outside of the safe integer range are not supported`);return new ea(ta.negint,Aa-BigInt(o),9)},us[60]=as,us[61]=as,us[62]=as,us[63]=as;for(let t=64;t<=87;t++)us[t]=Da;us[88]=function(t,e,r,n){return Ia(t,e,2,Ea(t,e+1,n))},us[89]=function(t,e,r,n){return Ia(t,e,3,_a(t,e+1,n))},us[90]=function(t,e,r,n){return Ia(t,e,5,xa(t,e+1,n))},us[91]=function(t,e,r,n){const o=La(t,e+1,n);if("bigint"==typeof o)throw new Error(`${ba} 64-bit integer bytes lengths not supported`);return Ia(t,e,9,o)},us[92]=as,us[93]=as,us[94]=as,us[95]=ss("indefinite length bytes/strings are not supported");for(let t=96;t<=119;t++)us[t]=za;us[120]=function(t,e,r,n){return ja(t,e,2,Ea(t,e+1,n),n)},us[121]=function(t,e,r,n){return ja(t,e,3,_a(t,e+1,n),n)},us[122]=function(t,e,r,n){return ja(t,e,5,xa(t,e+1,n),n)},us[123]=function(t,e,r,n){const o=La(t,e+1,n);if("bigint"==typeof o)throw new Error(`${ba} 64-bit integer string lengths not supported`);return ja(t,e,9,o,n)},us[124]=as,us[125]=as,us[126]=as,us[127]=ss("indefinite length bytes/strings are not supported");for(let t=128;t<=151;t++)us[t]=Ca;us[152]=function(t,e,r,n){return Fa(0,0,2,Ea(t,e+1,n))},us[153]=function(t,e,r,n){return Fa(0,0,3,_a(t,e+1,n))},us[154]=function(t,e,r,n){return Fa(0,0,5,xa(t,e+1,n))},us[155]=function(t,e,r,n){const o=La(t,e+1,n);if("bigint"==typeof o)throw new Error(`${ba} 64-bit integer array lengths not supported`);return Fa(0,0,9,o)},us[156]=as,us[157]=as,us[158]=as,us[159]=function(t,e,r,n){if(!1===n.allowIndefinite)throw new Error(`${ba} indefinite length items not allowed`);return Fa(0,0,1,1/0)};for(let t=160;t<=183;t++)us[t]=Ha;us[184]=function(t,e,r,n){return Ma(0,0,2,Ea(t,e+1,n))},us[185]=function(t,e,r,n){return Ma(0,0,3,_a(t,e+1,n))},us[186]=function(t,e,r,n){return Ma(0,0,5,xa(t,e+1,n))},us[187]=function(t,e,r,n){const o=La(t,e+1,n);if("bigint"==typeof o)throw new Error(`${ba} 64-bit integer map lengths not supported`);return Ma(0,0,9,o)},us[188]=as,us[189]=as,us[190]=as,us[191]=function(t,e,r,n){if(!1===n.allowIndefinite)throw new Error(`${ba} indefinite length items not allowed`);return Ma(0,0,1,1/0)};for(let t=192;t<=215;t++)us[t]=$a;us[216]=function(t,e,r,n){return new ea(ta.tag,Ea(t,e+1,n),2)},us[217]=function(t,e,r,n){return new ea(ta.tag,_a(t,e+1,n),3)},us[218]=function(t,e,r,n){return new ea(ta.tag,xa(t,e+1,n),5)},us[219]=function(t,e,r,n){return new ea(ta.tag,La(t,e+1,n),9)},us[220]=as,us[221]=as,us[222]=as,us[223]=as;for(let t=224;t<=243;t++)us[t]=ss("simple values are not supported");us[244]=as,us[245]=as,us[246]=as,us[247]=function(t,e,r,n){if(!1===n.allowUndefined)throw new Error(`${ba} undefined values are not supported`);return!0===n.coerceUndefinedToNull?new ea(ta.null,null,1):new ea(ta.undefined,void 0,1)},us[248]=ss("simple values are not supported"),us[249]=function(t,e,r,n){return Ja(rs(t,e+1),3,n)},us[250]=function(t,e,r,n){return Ja(os(t,e+1),5,n)},us[251]=function(t,e,r,n){return Ja(is(t,e+1),9,n)},us[252]=as,us[253]=as,us[254]=as,us[255]=function(t,e,r,n){if(!1===n.allowIndefinite)throw new Error(`${ba} indefinite length items not allowed`);return new ea(ta.break,void 0,1)};const cs=[];for(let t=0;t<24;t++)cs[t]=new ea(ta.uint,t,1);for(let t=-1;t>=-24;t--)cs[31-t]=new ea(ta.negint,t,1);cs[64]=new ea(ta.bytes,new Uint8Array(0),1),cs[96]=new ea(ta.string,"",1),cs[128]=new ea(ta.array,0,1),cs[160]=new ea(ta.map,0,1),cs[244]=new ea(ta.false,!1,1),cs[245]=new ea(ta.true,!0,1),cs[246]=new ea(ta.null,null,1);const ls={float64:!1,mapSorter:function(t,e){const r=Array.isArray(t[0])?t[0][0]:t[0],n=Array.isArray(e[0])?e[0][0]:e[0];if(r.type!==n.type)return r.type.compare(n.type);const o=r.type.major,i=fs[o].compareTokens(r,n);0===i&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone");return i},quickEncodeToken:function(t){switch(t.type){case ta.false:return ca([244]);case ta.true:return ca([245]);case ta.null:return ca([246]);case ta.bytes:return t.value.length?void 0:ca([64]);case ta.string:return""===t.value?ca([96]):void 0;case ta.array:return 0===t.value?ca([128]):void 0;case ta.map:return 0===t.value?ca([160]):void 0;case ta.uint:return t.value<24?ca([Number(t.value)]):void 0;case ta.negint:if(t.value>=-24)return ca([31-Number(t.value)])}}};const fs=function(){const t=[];return t[ta.uint.major]=Sa,t[ta.negint.major]=Oa,t[ta.bytes.major]=Pa,t[ta.string.major]=Ba,t[ta.array.major]=Ua,t[ta.map.major]=Ga,t[ta.tag.major]=Va,t[ta.float.major]=Qa,t}(),hs=new ga;class ps{constructor(t,e){this.obj=t,this.parent=e}includes(t){let e=this;do{if(e.obj===t)return!0}while(e=e.parent);return!1}static createCheck(t,e){if(t&&t.includes(e))throw new Error(`${ma} object contains circular references`);return new ps(e,t)}}const ds={null:new ea(ta.null,null),undefined:new ea(ta.undefined,void 0),true:new ea(ta.true,!0),false:new ea(ta.false,!1),emptyArray:new ea(ta.array,0),emptyMap:new ea(ta.map,0)},ys={number:(t,e,r,n)=>Number.isInteger(t)&&Number.isSafeInteger(t)?new ea(t>=0?ta.uint:ta.negint,t):new ea(ta.float,t),bigint:(t,e,r,n)=>t>=BigInt(0)?new ea(ta.uint,t):new ea(ta.negint,t),Uint8Array:(t,e,r,n)=>new ea(ta.bytes,t),string:(t,e,r,n)=>new ea(ta.string,t),boolean:(t,e,r,n)=>t?ds.true:ds.false,null:(t,e,r,n)=>ds.null,undefined:(t,e,r,n)=>ds.undefined,ArrayBuffer:(t,e,r,n)=>new ea(ta.bytes,new Uint8Array(t)),DataView:(t,e,r,n)=>new ea(ta.bytes,new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),Array(t,e,r,n){if(!t.length)return!0===r.addBreakTokens?[ds.emptyArray,new ea(ta.break)]:ds.emptyArray;n=ps.createCheck(n,t);const o=[];let i=0;for(const e of t)o[i++]=gs(e,r,n);return r.addBreakTokens?[new ea(ta.array,t.length),o,new ea(ta.break)]:[new ea(ta.array,t.length),o]},Object(t,e,r,n){const o="Object"!==e,i=o?t.keys():Object.keys(t),a=o?t.size:i.length;if(!a)return!0===r.addBreakTokens?[ds.emptyMap,new ea(ta.break)]:ds.emptyMap;n=ps.createCheck(n,t);const s=[];let u=0;for(const e of i)s[u++]=[gs(e,r,n),gs(o?t.get(e):t[e],r,n)];return function(t,e){e.mapSorter&&t.sort(e.mapSorter)}(s,r),r.addBreakTokens?[new ea(ta.map,a),s,new ea(ta.break)]:[new ea(ta.map,a),s]}};ys.Map=ys.Object,ys.Buffer=ys.Uint8Array;for(const t of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))ys[`${t}Array`]=ys.DataView;function gs(t,e={},r){const n=Xi(t),o=e&&e.typeEncoders&&e.typeEncoders[n]||ys[n];if("function"==typeof o){const i=o(t,n,e,r);if(null!=i)return i}const i=ys[n];if(!i)throw new Error(`${ma} unsupported type: ${n}`);return i(t,n,e,r)}function bs(t,e,r,n){if(Array.isArray(e))for(const o of e)bs(t,o,r,n);else r[e.type.major](t,e,n)}function ms(t,e,r){const n=gs(t,r);if(!Array.isArray(n)&&r.quickEncodeToken){const t=r.quickEncodeToken(n);if(t)return t;const o=e[n.type.major];if(o.encodedSize){const t=o.encodedSize(n,r),e=new ga(t);if(o(e,n,r),1!==e.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return aa(e.chunks[0])}}return hs.reset(),bs(hs,n,e,r),hs.toBytes(!0)}Symbol.for("DONE"),Symbol.for("BREAK");const vs={float64:!0,typeEncoders:{Object:function(t){if(t.asCID!==t&&t["/"]!==t.bytes)return null;const e=jt.asCID(t);if(!e)return null;const r=new Uint8Array(e.bytes.byteLength+1);return r.set(e.bytes,1),[new ea(ta.tag,42),new ea(ta.bytes,r)]},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}};const ws={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};ws.tags[42]=function(t){if(0!==t[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return jt.decode(t.subarray(1))};ws.tags.slice();const ks=t=>{return e=t,r=vs,r=Object.assign({},ls,r),ms(e,fs,r);var e,r};class Es extends TransformStream{constructor(t=[]){super({start:e=>e.enqueue(function(t){const e=ks({version:1,roots:t}),r=Ji.encode(e.length),n=new Uint8Array(r.length+e.length);return n.set(r,0),n.set(e,r.length),n}(t)),transform:(t,e)=>{e.enqueue(function(t){const e=Ji.encode(t.cid.bytes.length+t.bytes.length),r=new Uint8Array(e.length+t.cid.bytes.length+t.bytes.length);return r.set(e),r.set(t.cid.bytes,e.length),r.set(t.bytes,e.length+t.cid.bytes.length),r}(t)),this.finalBlock=t}}),this.finalBlock=null}}function _s(t){return _s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_s(t)}function xs(t,e,r){return(e=Is(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ls(t){return function(t){if(Array.isArray(t))return Ss(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ss(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ss(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ss(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ts(){Ts=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),s=new O(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",g={};function b(){}function m(){}function v(){}var w={};c(w,a,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(I([])));E&&E!==r&&n.call(E,a)&&(w=E);var _=v.prototype=b.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,a,s){var u=f(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==_s(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=T(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:p,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function T(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_s(e)+" is not iterable")}return m.prototype=v,o(_,"constructor",{value:v,configurable:!0}),o(v,"constructor",{value:m,configurable:!0}),m.displayName=c(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},x(L.prototype),c(L.prototype,s,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(_),c(_,u,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function As(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Rs(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){As(i,n,o,a,s,"next",t)}function s(t){As(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Os(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Is(n.key),n)}}function Is(t){var e=function(t,e){if("object"!=_s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_s(e)?e:e+""}var Ds=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.Http=e,this.report=new P(this.Http)},e=[{key:"getUploadAddresses",value:(h=Rs(Ts().mark((function t(){var e;return Ts().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.Http.getData("/api/v1/storage/get_upload_info?t="+(new Date).getTime()+"&need_trace=true");case 3:return e=t.sent,t.abrupt("return",e.data);case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,"Failed to get upload addresses: "+t.t0.message));case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return h.apply(this,arguments)})},{key:"createAsset",value:(f=Rs(Ts().mark((function t(e){var r;return Ts().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.Http.postData("/api/v1/storage/create_asset",e);case 3:return r=t.sent,t.abrupt("return",r);case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,"Failed to create asset: "+t.t0));case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return f.apply(this,arguments)})},{key:"uploadBlobToAddresses",value:(l=Rs(Ts().mark((function t(e,r,n,o){var i,a,u,c,l,f,h,p=this;return Ts().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=new Map,a=[],u=!1,c=[],l=function(){return a.forEach((function(t){t.signal.aborted||t.abort()}))},f=n.map((function(t,n){var s=new AbortController;a.push(s);var f=Date.now(),h=new URL(t.CandidateAddr).hostname.split(".")[0];return p.uploadFile(t.CandidateAddr,t.Token,r,s.signal,(function(t,e,r){i.set(n,r);var a=i.size>0?Math.max.apply(Math,Ls(i.values())):0;o&&o(t,e,a)})).then((function(r){var n,o,i=Date.now()-f,a=Math.floor((null!==(n=e.asset_size)&&void 0!==n?n:0)/i*1e3);if(c.push({status:0==r.code?1:2,msg:r.msg,elapsedTime:i,transferRate:a,size:null!==(o=e.asset_size)&&void 0!==o?o:0,traceId:t.TraceID,nodeId:h,cId:e.asset_cid,log:0==r.code?"":xs({},h,r.msg)}),!u)return u=!0,l(),r})).catch((function(r){var n;return c.push({status:2,msg:r,elapsedTime:0,transferRate:0,size:null!==(n=e.asset_size)&&void 0!==n?n:0,traceId:t.TraceID,nodeId:h,cId:null,log:xs({},h,r)}),Promise.reject(r)}))})),t.prev=6,t.next=9,Promise.any(f);case 9:return h=t.sent,this.report.creatReportData(c,"upload"),t.abrupt("return",h);case 14:return t.prev=14,t.t0=t.catch(6),this.report.creatReportData(c,"upload"),t.abrupt("return",{code:s.UPLOAD_FILE_ERROR,mes:"All upload addresses failed."});case 18:case"end":return t.stop()}}),t,this,[[6,14]])}))),function(t,e,r,n){return l.apply(this,arguments)})},{key:"uploadFile",value:(u=Rs(Ts().mark((function t(e,r,n,o,i){var a;return Ts().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.Http.uploadFile(e,r,n,null,i,o);case 3:if(0===(a=t.sent).code){t.next=6;break}return t.abrupt("return",c(a.code,"Failed to upload file: "+a.msg));case 6:return t.abrupt("return",a);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,"Failed to upload file: "+t.t0.msg));case 12:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(t,e,r,n,o){return u.apply(this,arguments)})},{key:"onFileUpload",value:(a=Rs(Ts().mark((function t(e){var r,n,o,i,a,u,l,f,h,p,d,y,g,w,k,E,_=arguments;return Ts().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=_.length>1&&void 0!==_[1]?_[1]:{areaId:[],groupId:0,assetType:0,extraId:"",retryCount:2},n=_.length>2?_[2]:void 0,o=_.length>3?_[3]:void 0,t.prev=3,i=r.areaId,a=void 0===i?[]:i,u=r.groupId,l=void 0===u?0:u,f=r.assetType,h=void 0===f?0:f,p=r.extraId,d=void 0===p?"":p,y=r.retryCount,g=void 0===y?2:y,!(w=b(a))){t.next=8;break}return t.abrupt("return",w);case 8:if(!(k=m(l))){t.next=11;break}return t.abrupt("return",k);case 11:if(!(E=v(h))){t.next=14;break}return t.abrupt("return",E);case 14:if(0!==h){t.next=20;break}return t.next=17,this.handleFileUpload(e,a,l,d,g,n);case 17:case 22:return t.abrupt("return",t.sent);case 20:return t.next=22,this.handleFolderUpload(e,a,l,d,g,n,o);case 23:t.next=28;break;case 25:return t.prev=25,t.t0=t.catch(3),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,"File upload error: "+JSON.stringify(t.t0)));case 28:case"end":return t.stop()}}),t,this,[[3,25]])}))),function(t){return a.apply(this,arguments)})},{key:"handleFileUpload",value:(i=Rs(Ts().mark((function t(e,r,n,o){var i,a,u,c,l,f,h,p,d,y,g,b,m,v,w=this,k=arguments;return Ts().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=k.length>4&&void 0!==k[4]?k[4]:2,a=k.length>5?k[5]:void 0,t.next=4,this.getUploadAddresses();case 4:return u=t.sent,c=u.List,l=u.TraceID,f=new Map,h=[],p=!1,d=[],y=function(){return h.forEach((function(t){return t.abort()}))},g=function(t){return new Promise((function(e){return setTimeout(e,t)}))},b=function(){var t=Rs(Ts().mark((function t(s,u,c){var m,v,k,E,_,x,L,S,T;return Ts().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return m=new AbortController,h.push(m),v=Date.now(),k=s.NodeID.replace(/^c_/,""),t.prev=4,t.next=7,w.uploadFile(s.UploadURL,s.Token,e,m.signal,(function(t,e,r){f.set(u,r);var n=f.size>0?Math.max.apply(Math,Ls(f.values())):0;a&&a(t,e,n)}));case 7:if(E=t.sent,_=Date.now(),x=_-v,L=Math.floor(e.size/x*1e3),d.push({status:0==E.code?1:2,msg:E.msg,elapsedTime:x,transferRate:L,size:e.size,traceId:l,nodeId:k,cId:E.cid,log:0==E.code?"":xs({},k,E.msg)}),0!==E.code){t.next=22;break}if(p){t.next=20;break}return p=!0,y(),t.next=18,w.createAsset({asset_name:e.name,asset_type:"file",asset_size:e.size,area_id:r,group_id:n,asset_cid:E.cid,node_id:s.NodeID,extra_id:o});case 18:return S=t.sent,t.abrupt("return",Promise.resolve(S));case 20:t.next=23;break;case 22:throw new Error(E.msg||"Upload failed");case 23:t.next=34;break;case 25:if(t.prev=25,t.t0=t.catch(4),!(c>0)){t.next=32;break}return T=1e3*(i-c+1),t.next=31,g(T);case 31:return t.abrupt("return",b(s,u,c-1));case 32:return d.push({status:2,msg:t.t0.message||"Unknown error",elapsedTime:0,transferRate:0,size:e.size,traceId:l,nodeId:k,cId:null,log:xs({},k,t.t0.message)}),t.abrupt("return",Promise.reject(t.t0));case 34:case"end":return t.stop()}}),t,null,[[4,25]])})));return function(e,r,n){return t.apply(this,arguments)}}(),m=c.map((function(t,e){return b(t,e,i)})),t.prev=15,t.next=18,Promise.any(m);case 18:return v=t.sent,this.report.creatReportData(d,"upload"),t.abrupt("return",v);case 23:return t.prev=23,t.t0=t.catch(15),this.report.creatReportData(d,"upload"),t.abrupt("return",{code:s.UPLOAD_FILE_ERROR,mes:"All upload addresses failed."});case 27:case"end":return t.stop()}}),t,this,[[15,23]])}))),function(t,e,r,n){return i.apply(this,arguments)})},{key:"handleFolderUpload",value:(o=Rs(Ts().mark((function t(e,r,n,o){var i,a,u,c,l,f,h,p=this,d=arguments;return Ts().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=d.length>4&&void 0!==d[4]?d[4]:2,a=d.length>5?d[5]:void 0,u=d.length>6?d[6]:void 0,h=new Promise((function(t,h){var d;Ki(e).pipeThrough(new TransformStream({transform:function(t,e){l=t.cid,e.enqueue(t)}})).pipeThrough(new Es).pipeTo(new WritableStream({write:function(t){if(c){var e=new Uint8Array(c.length+t.length);e.set(c),e.set(t,c.length),c=e}else c=t;u&&u("writing")},close:(d=Rs(Ts().mark((function s(){var d,y,g;return Ts().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,u&&u("close"),f=new Blob([c]),d=e[0].webkitRelativePath.split("/")[0],y={asset_name:d,asset_type:"folder",asset_size:f.size,area_id:r,group_id:n,asset_cid:l.toString(),extra_id:o,need_trace:!0},s.next=7,p.createAsset(y);case 7:if(0!==(g=s.sent).code){s.next=13;break}return s.next=11,p.uploadToAddresses(f,y,g.data,a,i,t,h,u);case 11:s.next=14;break;case 13:t(g);case 14:s.next=19;break;case 16:s.prev=16,s.t0=s.catch(0),h(s.t0);case 19:case"end":return s.stop()}}),s,null,[[0,16]])}))),function(){return d.apply(this,arguments)}),abort:function(t){u&&u("abort"),h({code:s.UPLOAD_FILE_ERROR,mes:"File upload failed: "+t})}})).catch((function(t){h(t)}))})),t.next=6,h;case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)}))),function(t,e,r,n){return o.apply(this,arguments)})},{key:"uploadToAddresses",value:(n=Rs(Ts().mark((function t(e,r,n,o,i,a,u,c){var l;return Ts().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.uploadBlobToAddresses(r,e,n,o);case 3:if(0!==(l=t.sent).code){t.next=8;break}a(l),t.next=14;break;case 8:if(!(i>0)){t.next=13;break}return t.next=11,this.uploadToAddresses(e,r,n,o,i-1,a,u,c);case 11:t.next=14;break;case 13:u({code:s.UPLOAD_FILE_ERROR,mes:"File upload failed after multiple attempts."});case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),u(t.t0);case 19:case"end":return t.stop()}}),t,this,[[0,16]])}))),function(t,e,r,o,i,a,s,u){return n.apply(this,arguments)})}],e&&Os(t.prototype,e),r&&Os(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,u,l,f,h}();const Ns=Ds;function Ps(){Ps=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),s=new O(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",g={};function b(){}function m(){}function v(){}var w={};c(w,a,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(I([])));E&&E!==r&&n.call(E,a)&&(w=E);var _=v.prototype=b.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,a,s){var u=f(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==js(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=T(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:p,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function T(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(js(e)+" is not iterable")}return m.prototype=v,o(_,"constructor",{value:v,configurable:!0}),o(v,"constructor",{value:m,configurable:!0}),m.displayName=c(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},x(L.prototype),c(L.prototype,s,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(_),c(_,u,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function js(t){return js="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},js(t)}function zs(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Bs(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){zs(i,n,o,a,s,"next",t)}function s(t){zs(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Fs(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Cs(n.key),n)}}function Cs(t){var e=function(t,e){if("object"!=js(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=js(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==js(e)?e:e+""}var Us=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.Http=e},e=[{key:"onShare",value:(i=Bs(Ps().mark((function t(){var e,r,n,o,i,a,l,f,h,p,d,y,g,b,m,v,w,k=arguments;return Ps().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=k.length>0&&void 0!==k[0]?k[0]:{id:null,assetDetail:{},expireAt:null,shortPass:""},t.prev=1,"object"===js(e)&&null!==e){t.next=4;break}return t.abrupt("return",c(s.ASSET_OBJ_ERROR,"Invalid options provided."));case 4:if(r=e.id,n=e.expireAt,o=e.shortPass,r){t.next=7;break}return t.abrupt("return",c(s.ID_KEY_EMPTY,"ID must not be null or empty."));case 7:return i=/^\d+$/.test(r),a=i?"groupid=".concat(r):"cid=".concat(r),t.next=11,this.Http.getData("/api/v1/storage/get_asset_group_info?".concat(a));case 11:if(l=t.sent,u(i?123:456,l),l&&0===l.code&&l.data){t.next=15;break}return t.abrupt("return",c(s.REQUEST_ERROR,"Failed to retrieve asset group information."));case 15:if(!i){t.next=25;break}if(g=l.data.data.Group){t.next=19;break}return t.abrupt("return",c(s.REQUEST_ERROR,"Group data is missing."));case 19:f=g.ShareStatus,h=g.UserID,p=g.ID,d="folder",t.next=33;break;case 25:if((b=l.data.data.AssetOverview)&&b.UserAssetDetail&&b.AssetRecord){t.next=28;break}return t.abrupt("return",c(s.REQUEST_ERROR,"AssetOverview data is incomplete."));case 28:f=b.UserAssetDetail.ShareStatus,h=b.UserAssetDetail.UserID,p=b.AssetRecord.CID,d=b.UserAssetDetail.AssetType,y=b.UserAssetDetail.area_ids;case 33:if(0!==f){t.next=41;break}return m={isNumeric:i,UserID:h,Cid:p,AssetType:d,expireAt:n,shortPass:o,area_ids:y},t.next=37,this.onCreateShareLink(m);case 37:return v=t.sent,t.abrupt("return",v);case 41:return t.next=43,this.onUpdateShareLink(h,p,n,o);case 43:return w=t.sent,t.abrupt("return",w);case 45:t.next=50;break;case 47:return t.prev=47,t.t0=t.catch(1),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,t.t0.message));case 50:case"end":return t.stop()}}),t,this,[[1,47]])}))),function(){return i.apply(this,arguments)})},{key:"onCreateShareLink",value:(o=Bs(Ps().mark((function t(e){var r,n,o,i,a,u,l,f,h,p,d,y,g,b,m,v,w,k,E;return Ps().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.isNumeric,n=e.UserID,o=e.Cid,i=e.AssetType,a=e.expireAt,u=e.shortPass,l=e.area_ids,t.prev=1,h=r?"/groupPreview":"/distributionstatus",p="".concat(f="https://storage.titannet.io").concat(h,"?cid=").concat(o,"&AssetType=").concat(i,"&address=").concat(n),!r&&l&&l.length>0&&(d=l.map((function(t){return"area_id=".concat(encodeURIComponent(t))})).join("&"),p+="&".concat(d)),y=Math.floor(new Date(4101509461e3).getTime()/1e3),!a){t.next=12;break}if(!(g=x(a))){t.next=11;break}return t.abrupt("return",g);case 11:y=this.getFutureTimestamp(a);case 12:if(b="/api/v1/storage/create_link?username=".concat(n,"&cid=").concat(o,"&url=").concat(encodeURIComponent(p),"&expire_time=").concat(y),!u){t.next=18;break}if(!(m=_(u))){t.next=17;break}return t.abrupt("return",m);case 17:b+="&short_pass=".concat(u);case 18:return!r&&l&&l.length>0&&(v=l.map((function(t){return"area_id=".concat(encodeURIComponent(t))})).join("&"),b+="&".concat(v)),t.next=21,this.Http.getData(b);case 21:if(0!==(w=t.sent).code){t.next=31;break}return k="/api/v1/storage/share_status_set?user_id=".concat(n,"&cid=").concat(o),!r&&l&&l.length>0&&(E=l.map((function(t){return"area_id=".concat(encodeURIComponent(t))})).join("&"),k+="&".concat(E)),t.next=27,this.Http.getData(k);case 27:return w.data.url="".concat(f).concat(encodeURI(w.data.url)),t.abrupt("return",w);case 31:return t.abrupt("return",w);case 32:t.next=37;break;case 34:return t.prev=34,t.t0=t.catch(1),t.abrupt("return",c(s.REQUEST_ERROR,t.t0.message));case 37:case"end":return t.stop()}}),t,this,[[1,34]])}))),function(t){return o.apply(this,arguments)})},{key:"getFutureTimestamp",value:function(t){var e=new Date,r=new Date(e.getTime()+24*t*60*60*1e3);return Math.floor(r.getTime()/1e3)}},{key:"onUpdateShareLink",value:(n=Bs(Ps().mark((function t(e,r,n,o){var i,a,s,u,c,l,f,h,p,d,y,g;return Ps().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.Http.getData("/api/v1/storage/share_link_info?username=".concat(e,"&cid=").concat(r));case 2:if(i=t.sent,a=i.data.link,s=a.id,u=a.short_pass,c=a.expire_at,l=a.short_link,f=u,h=new Date(c).getTime()/1e3,!o){t.next=11;break}if(!(p=_(o))){t.next=10;break}return t.abrupt("return",p);case 10:f=o;case 11:if(!n){t.next=16;break}if(!(d=x(n))){t.next=15;break}return t.abrupt("return",d);case 15:h=this.getFutureTimestamp(n);case 16:return y={id:s,expire_at:h,short_pass:f},t.next=19,this.Http.postData("/api/v1/storage/share_link_update",y);case 19:return 0==(g=t.sent).code&&(g.data.url="https://storage.titannet.io"+encodeURI(l)),t.abrupt("return",g);case 22:case"end":return t.stop()}}),t,this)}))),function(t,e,r,o){return n.apply(this,arguments)})}],e&&Fs(t.prototype,e),r&&Fs(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i}();const Ms=Us;function Hs(t){return Hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hs(t)}function Gs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function $s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Gs(Object(r),!0).forEach((function(e){Vs(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gs(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Vs(t,e,r){return(e=Js(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qs(){qs=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),s=new O(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",g={};function b(){}function m(){}function v(){}var w={};c(w,a,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(I([])));E&&E!==r&&n.call(E,a)&&(w=E);var _=v.prototype=b.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,a,s){var u=f(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==Hs(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=T(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:p,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function T(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Hs(e)+" is not iterable")}return m.prototype=v,o(_,"constructor",{value:v,configurable:!0}),o(v,"constructor",{value:m,configurable:!0}),m.displayName=c(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},x(L.prototype),c(L.prototype,s,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(_),c(_,u,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function Ys(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Ws(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ys(i,n,o,a,s,"next",t)}function s(t){Ys(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Ks(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Js(n.key),n)}}function Js(t){var e=function(t,e){if("object"!=Hs(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Hs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Hs(e)?e:e+""}var Qs=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.Http=e},e=[{key:"updateToken",value:function(t){if(!("string"==typeof t&&t.trim().length>0))return u("Invalid API token."),c(s.BAD_REQUEST,"Invalid API token provided.");this.Http.updateToken(t),u("API token updated successfully.")}},{key:"onAreaId",value:(L=Ws(qs().mark((function t(){return qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.Http.getData("/api/v1/storage/get_area_id");case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,"Failed to get area ID: "+t.t0.message));case 9:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return L.apply(this,arguments)})},{key:"onCreateGroup",value:(x=Ws(qs().mark((function t(e,r){var n,o;return qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(n=y(e))){t.next=5;break}return u(n),t.abrupt("return",n);case 5:if(!(o=w(r))){t.next=9;break}return u(o),t.abrupt("return",n);case 9:return t.next=11,this.Http.getData("/api/v1/storage/create_group?name=".concat(encodeURIComponent(e),"&parent=").concat(r));case 11:return t.abrupt("return",t.sent);case 14:return t.prev=14,t.t0=t.catch(0),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,"Failed to create group: "+t.t0.message));case 17:case"end":return t.stop()}}),t,this,[[0,14]])}))),function(t,e){return x.apply(this,arguments)})},{key:"onAssetGroupList",value:(_=Ws(qs().mark((function t(e,r,n){var o,i,a;return qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(o=w(r))){t.next=5;break}return u(o),t.abrupt("return",o);case 5:if(!(i=k(e))){t.next=9;break}return u(i),t.abrupt("return",i);case 9:if(!(a=E(n))){t.next=13;break}return u(a),t.abrupt("return",a);case 13:return t.next=15,this.Http.getData("/api/v1/storage/get_asset_group_list?page=".concat(e,"&parent=").concat(r,"&page_size=").concat(n));case 15:return t.abrupt("return",t.sent);case 18:return t.prev=18,t.t0=t.catch(0),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,"Failed to get asset group list: "+t.t0.message));case 21:case"end":return t.stop()}}),t,this,[[0,18]])}))),function(t,e,r){return _.apply(this,arguments)})},{key:"renameGroup",value:(v=Ws(qs().mark((function t(){var e,r,n,o,i,a=arguments;return qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=a.length>0&&void 0!==a[0]?a[0]:{groupId:-1,name:""},t.prev=1,!(r=y(e.name))){t.next=6;break}return u(r),t.abrupt("return",r);case 6:if(!(n=m(e.groupId))){t.next=9;break}return t.abrupt("return",n);case 9:return o={group_id:e.groupId,new_name:e.name},t.next=12,this.Http.postData("/api/v1/storage/rename_group",o);case 12:return u("TitanSDK:renameGroup:",i=t.sent),t.abrupt("return",i);case 17:return t.prev=17,t.t0=t.catch(1),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,"Failed to rename group: "+t.t0.message));case 20:case"end":return t.stop()}}),t,this,[[1,17]])}))),function(){return v.apply(this,arguments)})},{key:"renameAsset",value:(b=Ws(qs().mark((function t(){var e,r,n,o,i=arguments;return qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=i.length>0&&void 0!==i[0]?i[0]:{assetId:-1,name:""},t.prev=1,!(r=y(e.name))){t.next=6;break}return u(r),t.abrupt("return",r);case 6:if(!(r=y(assetId.name))){t.next=9;break}return t.abrupt("return",r);case 9:return n={asset_cid:e.assetId,new_name:e.name},t.next=12,this.Http.postData("/api/v1/storage/rename_asset",n);case 12:return u("TitanSDK:renameAsset:",o=t.sent),t.abrupt("return",o);case 17:return t.prev=17,t.t0=t.catch(1),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,"Failed to rename asset: "+t.t0.message));case 20:case"end":return t.stop()}}),t,this,[[1,17]])}))),function(){return b.apply(this,arguments)})},{key:"deleteGroup",value:(d=Ws(qs().mark((function t(){var e,r,n,o=arguments;return qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=o.length>0&&void 0!==o[0]?o[0]:{groupId:-1},t.prev=1,!(r=m(e.groupId))){t.next=5;break}return t.abrupt("return",r);case 5:return t.next=7,this.Http.getData("/api/v1/storage/delete_group?group_id=".concat(e.groupId));case 7:return u("TitanSDK:deleteGroup:",n=t.sent),t.abrupt("return",n);case 12:return t.prev=12,t.t0=t.catch(1),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,"Failed to delete group: "+t.t0.message));case 15:case"end":return t.stop()}}),t,this,[[1,12]])}))),function(){return d.apply(this,arguments)})},{key:"getAssetGroupInfo",value:(p=Ws(qs().mark((function t(){var e,r,n,o=arguments;return qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=o.length>0&&void 0!==o[0]?o[0]:{cId:-1,groupId:-1},t.prev=1,-1!==e.cId||-1!==e.groupId){t.next=4;break}return t.abrupt("return",c(s.ID_KEY_EMPTY,"At least one ID (cId or groupId) is required."));case 4:if(!e.cId){t.next=12;break}return t.next=7,this.Http.getData("/api/v1/storage/get_asset_group_info?cid=".concat(e.cId));case 7:return u("TitanSDK:getAssetGroupInfo:",r=t.sent),t.abrupt("return",r);case 12:if(!e.groupId){t.next=18;break}return t.next=15,this.Http.getData("/api/v1/storage/get_asset_group_info?groupid=".concat(e.groupId));case 15:return u("TitanSDK:getAssetGroupInfo:",n=t.sent),t.abrupt("return",n);case 18:t.next=23;break;case 20:return t.prev=20,t.t0=t.catch(1),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,"Failed to getAssetGroupInfo : "+t.t0.message));case 23:case"end":return t.stop()}}),t,this,[[1,20]])}))),function(){return p.apply(this,arguments)})},{key:"deleteAsset",value:(h=Ws(qs().mark((function t(){var e,r,n,o,i=arguments;return qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=i.length>0&&void 0!==i[0]?i[0]:{assetId:-1,areaId:[]},t.prev=1,-1!==e.assetId){t.next=4;break}return t.abrupt("return",c(s.ID_KEY_EMPTY,"Asset ID is required."));case 4:return r="/api/v1/storage/delete_asset?asset_cid=".concat(e.assetId),e.areaId&&e.areaId.length>0&&(n=e.areaId.map((function(t){return"area_id=".concat(encodeURIComponent(t))})).join("&"),r+="&".concat(n)),t.next=8,this.Http.getData(r);case 8:return u("TitanSDK:deleteAsset:",o=t.sent),t.abrupt("return",o);case 13:return t.prev=13,t.t0=t.catch(1),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,"Failed to delete asset: "+t.t0.message));case 16:case"end":return t.stop()}}),t,this,[[1,13]])}))),function(){return h.apply(this,arguments)})},{key:"userInfo",value:(f=Ws(qs().mark((function t(){var e,r,n,o,i;return qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=4,this.Http.getData("/api/v1/storage/get_storage_size");case 4:return e=t.sent,t.next=8,this.Http.getData("/api/v1/storage/get_vip_info");case 8:return r=t.sent,t.next=12,this.Http.getData("/api/v1/storage/get_asset_count");case 12:return n=t.sent,o=$s($s($s({},e.data),r.data),n.data),u("TitanSDK:userInfo:",i={code:0,data:o}),t.abrupt("return",i);case 19:return t.prev=19,t.t0=t.catch(0),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,"Failed to retrieve user information: "+t.t0.message));case 22:case"end":return t.stop()}}),t,this,[[0,19]])}))),function(){return f.apply(this,arguments)})},{key:"onShare",value:(l=Ws(qs().mark((function t(){var e,r,n=arguments;return qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{id:null,assetDetail:{},expireAt:null,shortPass:""},t.prev=1,r=new Ms(this.Http),t.abrupt("return",r.onShare(e));case 6:return t.prev=6,t.t0=t.catch(1),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,t.t0.message));case 9:case"end":return t.stop()}}),t,this,[[1,6]])}))),function(){return l.apply(this,arguments)})},{key:"getUploadAddresses",value:(a=Ws(qs().mark((function t(){var e;return qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.Http.getData("/api/v1/storage/get_upload_info?t="+(new Date).getTime());case 3:if(0===(e=t.sent).code){t.next=6;break}return t.abrupt("return",c(e.code,"Failed to get upload addresses: "+e));case 6:return t.abrupt("return",e.data.List);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,"Failed to get upload addresses: "+t.t0.message));case 12:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return a.apply(this,arguments)})},{key:"createAsset",value:(i=Ws(qs().mark((function t(e){var r;return qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.Http.postData("/api/v1/storage/create_asset",e);case 3:if(0===(r=t.sent).code){t.next=6;break}return t.abrupt("return",c(r.code,"Failed to create asset."));case 6:return t.abrupt("return",r);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",c(s.INTERNAL_SERVER_ERROR,"Failed to create asset: "+t.t0.message));case 12:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(t){return i.apply(this,arguments)})},{key:"onFileUpload",value:(o=Ws(qs().mark((function t(e){var r,n,o,i=arguments;return qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{areaId:[],groupId:0,assetType:0,extraId:"",retryCount:2},n=i.length>2?i[2]:void 0,o=i.length>3?i[3]:void 0,this.uploadLoader=new Ns(this.Http),t.next=6,this.uploadLoader.onFileUpload(e,r,n,o);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"onFileDown",value:(n=Ws(qs().mark((function t(e,r,n){var o,i,a,u,l,f,h,p,d;return qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(o=g(e))){t.next=3;break}return t.abrupt("return",o);case 3:return i="/api/v1/storage/share_asset?asset_cid="+e,t.next=6,this.Http.getData(i);case 6:if(0!==(a=t.sent).code){t.next=30;break}if(u=function(t){var e=new URL(t);return new URLSearchParams(e.search).get("filename")},l=a.data.url,f=u(l[0]),h=a.data.size,p=a.data.trace_id,d=new Y(this.Http),"folder"!=r){t.next=20;break}return t.next=17,d.downloadFromMultipleUrls(l,p,e,f,h,n);case 17:case 24:return t.abrupt("return",t.sent);case 20:if("file"!=r){t.next=27;break}return d.setProgressCallback((function(t){n&&n(t)})),t.next=24,d.downloadFile(l,p,e,f,h);case 27:return t.abrupt("return",c(s.Dowload_Type_ERROR,""));case 28:t.next=31;break;case 30:return t.abrupt("return",a);case 31:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return n.apply(this,arguments)})}],e&&Ks(t.prototype,e),r&&Ks(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,l,f,h,p,d,b,v,_,x,L}();const Zs=Qs;function Xs(t){return Xs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xs(t)}function tu(){tu=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),s=new O(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",g={};function b(){}function m(){}function v(){}var w={};c(w,a,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(I([])));E&&E!==r&&n.call(E,a)&&(w=E);var _=v.prototype=b.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,a,s){var u=f(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==Xs(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=T(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:p,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function T(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Xs(e)+" is not iterable")}return m.prototype=v,o(_,"constructor",{value:v,configurable:!0}),o(v,"constructor",{value:m,configurable:!0}),m.displayName=c(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},x(L.prototype),c(L.prototype,s,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(_),c(_,u,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function eu(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function ru(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){eu(i,n,o,a,s,"next",t)}function s(t){eu(i,n,o,a,s,"throw",t)}a(void 0)}))}}function nu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ou(n.key),n)}}function ou(t){var e=function(t,e){if("object"!=Xs(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Xs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Xs(e)?e:e+""}var iu,au,su,uu=function(){function t(e){var r=e.token,n=e.url,o=e.debug,i=void 0!==o&&o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.commService=new Zs(new p(r,n,i)),this.debug=i}return e=t,r=[{key:"updateToken",value:(k=ru(tu().mark((function t(e){var r;return tu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.commService.updateToken(e),t.abrupt("return",r);case 2:case"end":return t.stop()}}),t,this)}))),function(t){return k.apply(this,arguments)})},{key:"listRegions",value:(w=ru(tu().mark((function t(){var e;return tu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.commService.onAreaId();case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),t,this)}))),function(){return w.apply(this,arguments)})},{key:"createFolder",value:(v=ru(tu().mark((function t(){var e,r,n=arguments;return tu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{name:"",parent:0},t.next=3,this.commService.onCreateGroup(e.name,e.parent);case 3:return r=t.sent,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)}))),function(){return v.apply(this,arguments)})},{key:"listDirectoryContents",value:(m=ru(tu().mark((function t(){var e,r,n=arguments;return tu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{page:1,parent:0,pageSize:10},t.next=3,this.commService.onAssetGroupList(e.page,e.parent,e.pageSize);case 3:return r=t.sent,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)}))),function(){return m.apply(this,arguments)})},{key:"renameFolder",value:(b=ru(tu().mark((function t(){var e,r,n=arguments;return tu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{groupId:-1,name:""},t.next=3,this.commService.renameGroup(e);case 3:return r=t.sent,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)}))),function(){return b.apply(this,arguments)})},{key:"renameAsset",value:(g=ru(tu().mark((function t(){var e,r,n=arguments;return tu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{assetId:-1,name:""},t.next=3,this.commService.renameAsset(e);case 3:return r=t.sent,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)}))),function(){return g.apply(this,arguments)})},{key:"deleteFolder",value:(y=ru(tu().mark((function t(){var e,r,n=arguments;return tu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{groupId:-1},t.next=3,this.commService.deleteGroup(e);case 3:return r=t.sent,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)}))),function(){return y.apply(this,arguments)})},{key:"deleteAsset",value:(h=ru(tu().mark((function t(){var e,r,n=arguments;return tu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{assetId:-1,areaId:[]},t.next=3,this.commService.deleteAsset(e);case 3:return r=t.sent,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})},{key:"getUserProfile",value:(f=ru(tu().mark((function t(){var e;return tu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.commService.userInfo();case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},{key:"getltemDetails",value:(l=ru(tu().mark((function t(){var e,r,n=arguments;return tu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{cId:-1,groupId:-1},t.next=3,this.commService.getAssetGroupInfo(e);case 3:return r=t.sent,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"createSharedLink",value:(a=ru(tu().mark((function t(){var e,r,n=arguments;return tu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{id:null,expireAt:null,shortPass:""},t.next=3,this.commService.onShare(e);case 3:return r=t.sent,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"uploadAsset",value:(i=ru(tu().mark((function t(e,r,n,o){var i;return tu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.commService.onFileUpload(e,r,n,o);case 2:return i=t.sent,t.abrupt("return",i);case 4:case"end":return t.stop()}}),t,this)}))),function(t,e,r,n){return i.apply(this,arguments)})},{key:"downloadAsset",value:(o=ru(tu().mark((function t(e,r,n){var o;return tu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.commService.onFileDown(e,r,n);case 2:return o=t.sent,t.abrupt("return",o);case 4:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return o.apply(this,arguments)})}],n=[{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{token:"",debug:!1,url:""};try{var r=d(e.token);if(console.log("initialize",e.token),r)return u(r),r;if(!t.instance){localStorage.setItem("options",JSON.stringify(e)),t.instance=new t(e);var n=c(s.Sdk_OK,"");return u(n),n}return u("SDK has already been initialized."),c(s.Sdk_OK,"SDK has already been initialized.")}catch(t){var o=c(s.InitSdk_ERROR,"Failed to initialize TitanStorage: ".concat(t.message));return u(o),o}}},{key:"getInstance",value:function(){if(!t.instance){var e=JSON.parse(localStorage.getItem("options")),r=d(e.token);r&&u(r),t.instance=new t(e)}return t.instance}}],r&&nu(e.prototype,r),n&&nu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n,o,i,a,l,f,h,y,g,b,m,v,w,k}();iu=uu,su=null,(au=ou(au="instance"))in iu?Object.defineProperty(iu,au,{value:su,enumerable:!0,configurable:!0,writable:!0}):iu[au]=su;const cu=uu})(),__webpack_exports__=__webpack_exports__.default,__webpack_exports__})()));