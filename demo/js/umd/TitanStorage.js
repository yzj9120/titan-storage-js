/*! For license information please see TitanStorage.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.TitanStorage=t():e.TitanStorage=t()}(this,(()=>(()=>{var __webpack_modules__={45:e=>{"use strict";e.exports=function(e,t){var r=new Array(arguments.length-1),n=0,o=2,i=!0;for(;o<arguments.length;)r[n++]=arguments[o++];return new Promise((function(o,a){r[n]=function(e){if(i)if(i=!1,e)a(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];o.apply(null,t)}};try{e.apply(t||null,r)}catch(e){i&&(i=!1,a(e))}}))}},839:(e,t)=>{"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var n=new Array(64),o=new Array(123),i=0;i<64;)o[n[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;r.encode=function(e,t,r){for(var o,i=null,a=[],s=0,c=0;t<r;){var u=e[t++];switch(c){case 0:a[s++]=n[u>>2],o=(3&u)<<4,c=1;break;case 1:a[s++]=n[o|u>>4],o=(15&u)<<2,c=2;break;case 2:a[s++]=n[o|u>>6],a[s++]=n[63&u],c=0}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),s=0)}return c&&(a[s++]=n[o],a[s++]=61,1===c&&(a[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,a.slice(0,s))),i.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var a="invalid encoding";r.decode=function(e,t,r){for(var n,i=r,s=0,c=0;c<e.length;){var u=e.charCodeAt(c++);if(61===u&&s>1)break;if(void 0===(u=o[u]))throw Error(a);switch(s){case 0:n=u,s=1;break;case 1:t[r++]=n<<2|(48&u)>>4,n=u,s=2;break;case 2:t[r++]=(15&n)<<4|(60&u)>>2,n=u,s=3;break;case 3:t[r++]=(3&n)<<6|u,s=0}}if(1===s)throw Error(a);return r-i},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},358:e=>{"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this}},410:e=>{"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function o(e,n,o){t[0]=e,n[o]=r[0],n[o+1]=r[1],n[o+2]=r[2],n[o+3]=r[3]}function i(e,n,o){t[0]=e,n[o]=r[3],n[o+1]=r[2],n[o+2]=r[1],n[o+3]=r[0]}function a(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function s(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?o:i,e.writeFloatBE=n?i:o,e.readFloatLE=n?a:s,e.readFloatBE=n?s:a}():function(){function t(e,t,r,n){var o=t<0?1:0;if(o&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>34028234663852886e22)e((o<<31|2139095040)>>>0,r,n);else if(t<11754943508222875e-54)e((o<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var i=Math.floor(Math.log(t)/Math.LN2);e((o<<31|i+127<<23|8388607&Math.round(t*Math.pow(2,-i)*8388608))>>>0,r,n)}}function a(e,t,r){var n=e(t,r),o=2*(n>>31)+1,i=n>>>23&255,a=8388607&n;return 255===i?a?NaN:o*(1/0):0===i?1401298464324817e-60*o*a:o*Math.pow(2,i-150)*(a+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,n),e.readFloatLE=a.bind(null,o),e.readFloatBE=a.bind(null,i)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function o(e,n,o){t[0]=e,n[o]=r[0],n[o+1]=r[1],n[o+2]=r[2],n[o+3]=r[3],n[o+4]=r[4],n[o+5]=r[5],n[o+6]=r[6],n[o+7]=r[7]}function i(e,n,o){t[0]=e,n[o]=r[7],n[o+1]=r[6],n[o+2]=r[5],n[o+3]=r[4],n[o+4]=r[3],n[o+5]=r[2],n[o+6]=r[1],n[o+7]=r[0]}function a(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function s(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?o:i,e.writeDoubleBE=n?i:o,e.readDoubleLE=n?a:s,e.readDoubleBE=n?s:a}():function(){function t(e,t,r,n,o,i){var a=n<0?1:0;if(a&&(n=-n),0===n)e(0,o,i+t),e(1/n>0?0:2147483648,o,i+r);else if(isNaN(n))e(0,o,i+t),e(2146959360,o,i+r);else if(n>17976931348623157e292)e(0,o,i+t),e((a<<31|2146435072)>>>0,o,i+r);else{var s;if(n<22250738585072014e-324)e((s=n/5e-324)>>>0,o,i+t),e((a<<31|s/4294967296)>>>0,o,i+r);else{var c=Math.floor(Math.log(n)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(s=n*Math.pow(2,-c))>>>0,o,i+t),e((a<<31|c+1023<<20|1048576*s&1048575)>>>0,o,i+r)}}}function a(e,t,r,n,o){var i=e(n,o+t),a=e(n,o+r),s=2*(a>>31)+1,c=a>>>20&2047,u=4294967296*(1048575&a)+i;return 2047===c?u?NaN:s*(1/0):0===c?5e-324*s*u:s*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,n,4,0),e.readDoubleLE=a.bind(null,o,0,4),e.readDoubleBE=a.bind(null,i,4,0)}(),e}function r(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function n(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function o(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function i(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},153:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},390:e=>{"use strict";e.exports=function(e,t,r){var n=r||8192,o=n>>>1,i=null,a=n;return function(r){if(r<1||r>o)return e(r);a+r>n&&(i=e(n),a=0);var s=t.call(i,a,a+=r);return 7&a&&(a=1+(7|a)),s}}},447:(e,t)=>{"use strict";var r=t;r.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},r.read=function(e,t,r){if(r-t<1)return"";for(var n,o=null,i=[],a=0;t<r;)(n=e[t++])<128?i[a++]=n:n>191&&n<224?i[a++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[a++]=55296+(n>>10),i[a++]=56320+(1023&n)):i[a++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,i)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,i.slice(0,a))),o.join("")):String.fromCharCode.apply(String,i.slice(0,a))},r.write=function(e,t,r){for(var n,o,i=r,a=0;a<e.length;++a)(n=e.charCodeAt(a))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(o=e.charCodeAt(a+1)))?(n=65536+((1023&n)<<10)+(1023&o),++a,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-i}},437:(e,t,r)=>{e.exports=r(327)},327:function(e,t){!function(r,n){"use strict";var o={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function i(e){if(!Array.isArray(e)&&!ArrayBuffer.isView(e))return!1;for(var t=0;t<e.length;t++)if(!Number.isInteger(e[t])||e[t]<0||e[t]>255)return!1;return!0}function a(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function s(e,t){return e<<t|e>>>32-t}function c(e){return e=a(e^=e>>>16,2246822507),e=a(e^=e>>>13,3266489909),e^=e>>>16}function u(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]+t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]+t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]+t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]+t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function l(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]*t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]*t[3],r[1]+=r[2]>>>16,r[2]&=65535,r[2]+=e[3]*t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]*t[3],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[2]*t[2],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[3]*t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function f(e,t){return 32===(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function h(e,t){return 0===(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function p(e,t){return[e[0]^t[0],e[1]^t[1]]}function d(e){return e=p(e,[0,e[0]>>>1]),e=p(e=l(e,[4283543511,3981806797]),[0,e[0]>>>1]),e=p(e=l(e,[3301882366,444984403]),[0,e[0]>>>1])}o.x86.hash32=function(e,t){if(o.inputValidation&&!i(e))return n;t=t||0;for(var r=e.length%4,u=e.length-r,l=t,f=0,h=3432918353,p=461845907,d=0;d<u;d+=4)f=a(f=e[d]|e[d+1]<<8|e[d+2]<<16|e[d+3]<<24,h),f=a(f=s(f,15),p),l=a(l=s(l^=f,13),5)+3864292196;switch(f=0,r){case 3:f^=e[d+2]<<16;case 2:f^=e[d+1]<<8;case 1:f=a(f^=e[d],h),l^=f=a(f=s(f,15),p)}return(l=c(l^=e.length))>>>0},o.x86.hash128=function(e,t){if(o.inputValidation&&!i(e))return n;t=t||0;for(var r=e.length%16,u=e.length-r,l=t,f=t,h=t,p=t,d=0,y=0,g=0,b=0,m=597399067,v=2869860233,w=951274213,k=2716044179,E=0;E<u;E+=16)d=e[E]|e[E+1]<<8|e[E+2]<<16|e[E+3]<<24,y=e[E+4]|e[E+5]<<8|e[E+6]<<16|e[E+7]<<24,g=e[E+8]|e[E+9]<<8|e[E+10]<<16|e[E+11]<<24,b=e[E+12]|e[E+13]<<8|e[E+14]<<16|e[E+15]<<24,d=s(d=a(d,m),15),l=s(l^=d=a(d,v),19),l=a(l+=f,5)+1444728091,y=s(y=a(y,v),16),f=s(f^=y=a(y,w),17),f=a(f+=h,5)+197830471,g=s(g=a(g,w),17),h=s(h^=g=a(g,k),15),h=a(h+=p,5)+2530024501,b=s(b=a(b,k),18),p=s(p^=b=a(b,m),13),p=a(p+=l,5)+850148119;switch(d=0,y=0,g=0,b=0,r){case 15:b^=e[E+14]<<16;case 14:b^=e[E+13]<<8;case 13:b=a(b^=e[E+12],k),p^=b=a(b=s(b,18),m);case 12:g^=e[E+11]<<24;case 11:g^=e[E+10]<<16;case 10:g^=e[E+9]<<8;case 9:g=a(g^=e[E+8],w),h^=g=a(g=s(g,17),k);case 8:y^=e[E+7]<<24;case 7:y^=e[E+6]<<16;case 6:y^=e[E+5]<<8;case 5:y=a(y^=e[E+4],v),f^=y=a(y=s(y,16),w);case 4:d^=e[E+3]<<24;case 3:d^=e[E+2]<<16;case 2:d^=e[E+1]<<8;case 1:d=a(d^=e[E],m),l^=d=a(d=s(d,15),v)}return l^=e.length,l+=f^=e.length,l+=h^=e.length,f+=l+=p^=e.length,h+=l,p+=l,l=c(l),l+=f=c(f),l+=h=c(h),f+=l+=p=c(p),h+=l,p+=l,("00000000"+(l>>>0).toString(16)).slice(-8)+("00000000"+(f>>>0).toString(16)).slice(-8)+("00000000"+(h>>>0).toString(16)).slice(-8)+("00000000"+(p>>>0).toString(16)).slice(-8)},o.x64.hash128=function(e,t){if(o.inputValidation&&!i(e))return n;t=t||0;for(var r=e.length%16,a=e.length-r,s=[0,t],c=[0,t],y=[0,0],g=[0,0],b=[2277735313,289559509],m=[1291169091,658871167],v=0;v<a;v+=16)y=[e[v+4]|e[v+5]<<8|e[v+6]<<16|e[v+7]<<24,e[v]|e[v+1]<<8|e[v+2]<<16|e[v+3]<<24],g=[e[v+12]|e[v+13]<<8|e[v+14]<<16|e[v+15]<<24,e[v+8]|e[v+9]<<8|e[v+10]<<16|e[v+11]<<24],y=f(y=l(y,b),31),s=u(s=f(s=p(s,y=l(y,m)),27),c),s=u(l(s,[0,5]),[0,1390208809]),g=f(g=l(g,m),33),c=u(c=f(c=p(c,g=l(g,b)),31),s),c=u(l(c,[0,5]),[0,944331445]);switch(y=[0,0],g=[0,0],r){case 15:g=p(g,h([0,e[v+14]],48));case 14:g=p(g,h([0,e[v+13]],40));case 13:g=p(g,h([0,e[v+12]],32));case 12:g=p(g,h([0,e[v+11]],24));case 11:g=p(g,h([0,e[v+10]],16));case 10:g=p(g,h([0,e[v+9]],8));case 9:g=l(g=p(g,[0,e[v+8]]),m),c=p(c,g=l(g=f(g,33),b));case 8:y=p(y,h([0,e[v+7]],56));case 7:y=p(y,h([0,e[v+6]],48));case 6:y=p(y,h([0,e[v+5]],40));case 5:y=p(y,h([0,e[v+4]],32));case 4:y=p(y,h([0,e[v+3]],24));case 3:y=p(y,h([0,e[v+2]],16));case 2:y=p(y,h([0,e[v+1]],8));case 1:y=l(y=p(y,[0,e[v]]),b),s=p(s,y=l(y=f(y,31),m))}return s=u(s=p(s,[0,e.length]),c=p(c,[0,e.length])),c=u(c,s),s=u(s=d(s),c=d(c)),c=u(c,s),("00000000"+(s[0]>>>0).toString(16)).slice(-8)+("00000000"+(s[1]>>>0).toString(16)).slice(-8)+("00000000"+(c[0]>>>0).toString(16)).slice(-8)+("00000000"+(c[1]>>>0).toString(16)).slice(-8)},e.exports&&(t=e.exports=o),t.murmurHash3=o}()},946:(e,t,r)=>{"use strict";e.exports=r(394)},394:(e,t,r)=>{"use strict";var n=t;function o(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=r(449),n.BufferWriter=r(818),n.Reader=r(237),n.BufferReader=r(158),n.util=r(610),n.rpc=r(47),n.roots=r(529),n.configure=o,o()},237:(e,t,r)=>{"use strict";e.exports=c;var n,o=r(610),i=o.LongBits,a=o.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},f=function(){return o.Buffer?function(e){return(c.create=function(e){return o.Buffer.isBuffer(e)?new n(e):l(e)})(e)}:l};function h(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function p(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function d(){if(this.pos+8>this.len)throw s(this,8);return new i(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}c.create=f(),c.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,c.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return u}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return p(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|p(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw s(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,r);if(t===r){var n=o.Buffer;return n?n.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,r)},c.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){n=e,c.create=f(),n._configure();var t=o.Long?"toLong":"toNumber";o.merge(c.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return d.call(this)[t](!0)},sfixed64:function(){return d.call(this)[t](!1)}})}},158:(e,t,r)=>{"use strict";e.exports=i;var n=r(237);(i.prototype=Object.create(n.prototype)).constructor=i;var o=r(610);function i(e){n.call(this,e)}i._configure=function(){o.Buffer&&(i.prototype._slice=o.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()},529:e=>{"use strict";e.exports={}},47:(e,t,r)=>{"use strict";t.Service=r(595)},595:(e,t,r)=>{"use strict";e.exports=o;var n=r(610);function o(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(o.prototype=Object.create(n.EventEmitter.prototype)).constructor=o,o.prototype.rpcCall=function e(t,r,o,i,a){if(!i)throw TypeError("request must be specified");var s=this;if(!a)return n.asPromise(e,s,t,r,o,i);if(s.rpcImpl)try{return s.rpcImpl(t,r[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,r){if(e)return s.emit("error",e,t),a(e);if(null!==r){if(!(r instanceof o))try{r=o[s.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return s.emit("error",e,t),a(e)}return s.emit("data",r,t),a(null,r)}s.end(!0)}))}catch(e){return s.emit("error",e,t),void setTimeout((function(){a(e)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},o.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},239:(e,t,r)=>{"use strict";e.exports=o;var n=r(610);function o(e,t){this.lo=e>>>0,this.hi=t>>>0}var i=o.zero=new o(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var a=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new o(r,n)},o.from=function(e){if("number"==typeof e)return o.fromNumber(e);if(n.isString(e)){if(!n.Long)return o.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new o(e.low>>>0,e.high>>>0):i},o.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;o.fromHash=function(e){return e===a?i:new o((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},o.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},o.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},610:function(e,t,r){"use strict";var n=t;function o(e,t,r){for(var n=Object.keys(t),o=0;o<n.length;++o)void 0!==e[n[o]]&&r||(e[n[o]]=t[n[o]]);return e}function i(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&o(this,r)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}n.asPromise=r(45),n.base64=r(839),n.EventEmitter=r(358),n.float=r(410),n.inquire=r(153),n.utf8=r(447),n.pool=r(390),n.LongBits=r(239),n.isNode=Boolean(void 0!==r.g&&r.g&&r.g.process&&r.g.process.versions&&r.g.process.versions.node),n.global=n.isNode&&r.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=o,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=i,n.ProtocolError=i("ProtocolError"),n.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},n.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},449:(e,t,r)=>{"use strict";e.exports=f;var n,o=r(610),i=o.LongBits,a=o.base64,s=o.utf8;function c(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function f(){this.len=0,this.head=new c(u,0,0),this.tail=this.head,this.states=null}var h=function(){return o.Buffer?function(){return(f.create=function(){return new n})()}:function(){return new f}};function p(e,t,r){t[r]=255&e}function d(e,t){this.len=e,this.next=void 0,this.val=t}function y(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function g(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}f.create=h(),f.alloc=function(e){return new o.Array(e)},o.Array!==Array&&(f.alloc=o.pool(f.alloc,o.Array.prototype.subarray)),f.prototype._push=function(e,t,r){return this.tail=this.tail.next=new c(e,t,r),this.len+=t,this},d.prototype=Object.create(c.prototype),d.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},f.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new d((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},f.prototype.int32=function(e){return e<0?this._push(y,10,i.fromNumber(e)):this.uint32(e)},f.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},f.prototype.uint64=function(e){var t=i.from(e);return this._push(y,t.length(),t)},f.prototype.int64=f.prototype.uint64,f.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(y,t.length(),t)},f.prototype.bool=function(e){return this._push(p,1,e?1:0)},f.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},f.prototype.sfixed32=f.prototype.fixed32,f.prototype.fixed64=function(e){var t=i.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},f.prototype.sfixed64=f.prototype.fixed64,f.prototype.float=function(e){return this._push(o.float.writeFloatLE,4,e)},f.prototype.double=function(e){return this._push(o.float.writeDoubleLE,8,e)};var b=o.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};f.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(p,1,0);if(o.isString(e)){var r=f.alloc(t=a.length(e));a.decode(e,r,0),e=r}return this.uint32(t)._push(b,t,e)},f.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t)._push(s.write,t,e):this._push(p,1,0)},f.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(u,0,0),this.len=0,this},f.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(u,0,0),this.len=0),this},f.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},f.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},f._configure=function(e){n=e,f.create=h(),n._configure()}},818:(e,t,r)=>{"use strict";e.exports=i;var n=r(449);(i.prototype=Object.create(n.prototype)).constructor=i;var o=r(610);function i(){n.call(this)}function a(e,t,r){e.length<40?o.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}i._configure=function(){i.alloc=o._Buffer_allocUnsafe,i.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&"set"===o.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},i.prototype.bytes=function(e){o.isString(e)&&(e=o._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=o.Buffer.byteLength(e);return this.uint32(t),t&&this._push(a,t,e),this},i._configure()},797:e=>{e.exports=function e(n,o){var i,a=0,s=0,c=o=o||0,u=n.length;do{if(c>=u||s>49)throw e.bytes=0,new RangeError("Could not decode varint");i=n[c++],a+=s<28?(i&r)<<s:(i&r)*Math.pow(2,s),s+=7}while(i>=t);return e.bytes=c-o,a};var t=128,r=127},877:e=>{e.exports=function e(o,i,a){if(Number.MAX_SAFE_INTEGER&&o>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");i=i||[];var s=a=a||0;for(;o>=n;)i[a++]=255&o|t,o/=128;for(;o&r;)i[a++]=255&o|t,o>>>=7;return i[a]=0|o,e.bytes=a-s+1,i};var t=128,r=-128,n=Math.pow(2,31)},203:(e,t,r)=>{e.exports={encode:r(877),decode:r(797),encodingLength:r(867)}},867:e=>{var t=Math.pow(2,7),r=Math.pow(2,14),n=Math.pow(2,21),o=Math.pow(2,28),i=Math.pow(2,35),a=Math.pow(2,42),s=Math.pow(2,49),c=Math.pow(2,56),u=Math.pow(2,63);e.exports=function(e){return e<t?1:e<r?2:e<n?3:e<o?4:e<i?5:e<a?6:e<s?7:e<c?8:e<u?9:10}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.d(__webpack_exports__,{default:()=>lc});var e={};__webpack_require__.r(e),__webpack_require__.d(e,{DEFAULT_DIRECTORY_MODE:()=>kt,DEFAULT_FILE_MODE:()=>wt,NodeType:()=>gt,code:()=>Et,createAdvancedFile:()=>It,createComplexFile:()=>Ot,createDirectoryShard:()=>jt,createEmptyFile:()=>St,createFileChunk:()=>At,createFileShard:()=>Rt,createFlatDirectory:()=>Dt,createRaw:()=>Lt,createShardedDirectory:()=>Nt,createSimpleFile:()=>Tt,createSymlink:()=>Yt,cumulativeContentByteLength:()=>er,cumulativeDagByteLength:()=>tr,decode:()=>Jt,decodeMetadata:()=>ar,encode:()=>Kt,encodeAdvancedFile:()=>Ut,encodeComplexFile:()=>Ht,encodeDirectory:()=>Gt,encodeDirectoryMetadata:()=>or,encodeFile:()=>zt,encodeFileChunk:()=>Ft,encodeFileShard:()=>Bt,encodeHAMTShard:()=>$t,encodeLink:()=>Ct,encodeMetadata:()=>ir,encodeMode:()=>cr,encodeRaw:()=>Pt,encodeSimpleFile:()=>Mt,encodeSymlink:()=>Wt,filesize:()=>dr,matchFile:()=>lr,name:()=>_t});var t={};__webpack_require__.r(t),__webpack_require__.d(t,{context:()=>An,cut:()=>On,name:()=>Tn,type:()=>In,withMaxChunkSize:()=>Rn});var r={};__webpack_require__.r(r);var n={};__webpack_require__.r(n),__webpack_require__.d(n,{API:()=>r,and:()=>fo,bitCount:()=>lo,empty:()=>no,from:()=>oo,fromBytes:()=>yo,get:()=>uo,or:()=>ho,popcount:()=>ao,set:()=>so,size:()=>io,toBytes:()=>po,unset:()=>co});var o={};__webpack_require__.r(o),__webpack_require__.d(o,{configure:()=>vo,hash32:()=>mo});var i={};__webpack_require__.r(i),__webpack_require__.d(i,{API:()=>r,and:()=>yi,empty:()=>ni,from:()=>oi,fromBytes:()=>hi,get:()=>li,or:()=>di,popcount:()=>pi,set:()=>ci,size:()=>ii,toBytes:()=>fi,unset:()=>ui});var a={};__webpack_require__.r(a),__webpack_require__.d(a,{code:()=>Gi,decode:()=>qi,encode:()=>$i,name:()=>Hi});const s={SUCCESSFULLY:0,FAILURE:-1,BAD_REQUEST:400,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,INTERNAL_SERVER_ERROR:-1,SERVICE_UNAVAILABLE:503,InitSdk_ERROR:1001,API_KEY_EMPTY:1002,INVALID_API_KEY:1003,RESOURCE_NOT_AVAILABLE:1004,FILE_NAME_KEY_EMPTY:1005,ID_KEY_EMPTY:1006,PARENT_ID_ERROR:1004,SHARE_ERROE:1007,ASSEST_OBJ_ERROR:1008,INVALID_PASSWORD:1009,FETCH_ERROR:10010,PARENT_ID_INVALID:10011,PAGE_ERROR:10012,PAGESIZE_ERROR:10013,MISSING_FIELDS_ERROR:10014,UPLOAD_FILE_ERROR:10015,AREA_ID_ERROR:10016,Group_ID_ERROR:10017,Asset_Type_ERROR:10018,Dowload_URL_ERROR:10019,Dowload_ERROR:10020,ASSEST_ID_ERROR:10021,Dowload_Type_ERROR:10022,REPORT_ERROR:10023,INVALID_EXPIRE_AT:10024,ASSET_OBJ_ERROR:10025,REQUEST_ERROR:10026,File_Size_ERROR:10027};function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};JSON.parse(localStorage.getItem("titanOptions")).debug&&(Object.keys(t).length>0?console.log(e,t):console.log(e))}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.code,r=e.msg,n=void 0===r?"":r,o=e.data,i=void 0===o?{}:o,a={code:t,msg:n};return n||(a=function(e,t){var r;switch(e){case s.InitSdk_OK:r="Initialize SDK Success";break;case s.BAD_REQUEST:r="The request was invalid. Please check your input.";break;case s.UNAUTHORIZED:r="You are not authorized. Please check your credentials.";break;case s.FORBIDDEN:r="You do not have permission to access this resource.";break;case s.NOT_FOUND:r="The requested resource could not be found.";break;case s.INTERNAL_SERVER_ERROR:r="An error occurred on the server. Please try again later.";break;case s.SERVICE_UNAVAILABLE:r="The service is currently unavailable. Please try again later.";break;case s.API_KEY_EMPTY:r="API toekn is required and cannot be empty.";break;case s.INVALID_API_KEY:r="The provided API Key is invalid.";break;case s.RESOURCE_NOT_AVAILABLE:r="The requested resource is not available.";break;case s.ID_KEY_EMPTY:r="ID is required but was not provided.";break;case s.ASSET_OBJ_ERROR:r="Invalid options provided.";break;case s.REQUEST_ERROR:r="Failed to retrieve asset group information.";break;case s.FILE_NAME_KEY_EMPTY:r="Name is required but was not provided.";break;case s.PARENT_ID_ERROR:r="Parent ID is required but was incorrect.";break;case s.SHARE_ERROE:r="The file cannot be shared.";break;case s.ASSEST_OBJ_ERROR:r="assetDetail must be an object.";break;case s.PARENT_ID_INVALID:r="Invalid 'parent' parameter. It should be a non-negative number.";break;case s.PAGE_ERROR:r="Invalid 'page' parameter. It should be a positive number.";break;case s.PAGESIZE_ERROR:r="Invalid 'pageSize' parameter. It should be a non-negative number.";break;case s.MISSING_FIELDS_ERROR:r="Missing required fields in assetDetail";break;case s.INVALID_PASSWORD:r="Invalid shortPass format. It should be a 6-character alphanumeric string.";break;case s.AREA_ID_ERROR:r="area_id should be an array.";break;case s.Group_ID_ERROR:r="group_id should be a non-negative integer.";break;case s.Asset_Type_ERROR:r="asset_type should be 0 or 1.";break;case s.Sdk_OK:r="TitanSDK initialized successfully";break;case s.InitSdk_ERROR:r="Failed to initialize TitanSDK";break;case s.Dowload_URL_ERROR:r="No available download address";break;case s.Dowload_Type_ERROR:r="Download type not found";break;case s.SUCCESSFULLY:r="Success";break;case s.FAILURE:r="Failure";break;default:r="An unknown error occurred."}return{code:e,msg:t||r}}(t,n)),{code:a.code,msg:a.msg,data:i||{}}}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function h(e){var t=function(e,t){if("object"!=l(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==l(t)?t:t+""}var p=function(){return e=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.token=t,this.url=r,this.debug=n,this.url||(this.url="https://api-test1.container1.titannet.io"),t&&""!==t.trim()||c(s.API_KEY_EMPTY,"")},t=[{key:"updateToken",value:function(e){return e&&""!==e.trim()?(this.token=e,u({code:s.SUCCESSFULLY})):u({code:s.FAILURE})}},{key:"getData",value:function(e){var t="".concat(this.url).concat(e);return this.token&&""!==this.token.trim()?(c("Fetching data from URL:",t),fetch(t,{method:"GET",headers:{"Content-Type":"application/json",JwtAuthorization:"Bearer "+this.token}}).then((function(e){return e.ok?e.json():e.text().then((function(t){return u({code:e.status,msg:null!=t?t:""})}))})).then((function(e){var t;return c("fetched successfully:",e),u({code:e.code,msg:null!==(t=e.msg)&&void 0!==t?t:"",data:e.data})})).catch((function(e){return u({code:s.FETCH_ERROR,msg:e})}))):u({code:s.API_KEY_EMPTY})}},{key:"postData",value:function(e,t){var r="".concat(this.url).concat(e);return this.token&&""!==this.token.trim()?(c("Posting data to URL:",r),fetch(r,{method:"POST",headers:{"Content-Type":"application/json",JwtAuthorization:"Bearer "+this.token},body:JSON.stringify(t)}).then((function(e){return e.ok?e.json():e.text().then((function(t){var r="Error ".concat(e.status,": ").concat(t),n=u({code:e.status,msg:r});return Promise.reject(n)}))})).then((function(e){var t;return c("Data posted successfully:",e),u({code:e.code,msg:null!==(t=e.msg)&&void 0!==t?t:"",data:e.data})})).catch((function(e){return c("Data posted error:",e),u({code:s.FETCH_ERROR,msg:e})}))):u({code:s.API_KEY_EMPTY})}},{key:"uploadFile",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;return new Promise((function(l,f){var h=new XMLHttpRequest,p="".concat(e);if(!n.token||""===n.token.trim())return u({code:s.API_KEY_EMPTY});var d=0;h.open("POST",p,!0),h.setRequestHeader("JwtAuthorization","Bearer "+n.token),h.setRequestHeader("Authorization","Bearer "+t),h.upload.onprogress=function(e){if(e.lengthComputable&&i){d=e.total;var t=e.loaded/e.total*100;i(e.loaded,e.total,t)}},h.onload=function(){if(h.status>=200&&h.status<300){var e=JSON.parse(h.responseText);c("File uploaded successfully:",e),i&&i(d,d,100),l(e)}else c("File uploaded:",h.status),f(u({code:h.status,msg:h.responseText}))},h.onerror=function(){var e="File upload failed: ".concat(h.statusText||"Handle network errors");f(u(s.FETCH_ERROR,e))},a.addEventListener("abort",(function(){h.abort()}));var y=new FormData;for(var g in y.append("file",r),o)o.hasOwnProperty(g)&&y.append(g,o[g]);h.send(y)}))}}],t&&f(e.prototype,t),r&&f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}(),d=function(e){if(!e||""===e.trim())return u({code:s.API_KEY_EMPTY})},y=function(e){if(!e||""===e.trim())return u({code:s.FILE_NAME_KEY_EMPTY,msg:"Group name cannot be empty."})},g=function(e){if(!e||""===e.trim())return u({code:s.ASSEST_ID_ERROR,msg:"AssetCid cannot be empty."})},b=function(e){if(!Array.isArray(e))return u({code:s.AREA_ID_ERROR,msg:"Asset_ID should be an array."})},m=function(e){if(!Number.isInteger(e))return u({code:s.Group_ID_ERROR,msg:"group_id should be a non-negative intege."})},v=function(e){if(0!==e&&1!==e)return u({code:s.Asset_Type_ERROR,msg:"asset_type should be 0 or 1."})},w=function(e){if(e>104857600)return u({code:s.File_Size_ERROR,msg:"file size should not exceed 100MB."})},k=function(e){if("number"!=typeof e||e<0)return u({code:s.PARENT_ID_INVALID,msg:"Parent ID is invalid."})},E=function(e){if("number"!=typeof e||e<=0)return u({code:s.PAGE_ERROR,msg:"Page number is invalid."})},_=function(e){if("number"!=typeof e||e<=0)return u({code:s.PAGESIZE_ERROR,msg:"Page size is invalid."})},x=function(e){if(e){if(!/^[a-zA-Z0-9]{6}$/.test(e))return u({code:s.INVALID_PASSWORD,msg:"hort password is invalid. It must be 6 characters long and can only contain letters and numbers."})}},L=function(e){if(e&&!(Number.isInteger(e)&&e>0))return u({code:s.INVALID_EXPIRE_AT,msg:"expireAt must be a positive integer"})};function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){I(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function I(e,t,r){return(t=N(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R(){R=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),s=new D(n||[]);return o(a,"_invoke",{value:T(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",g={};function b(){}function m(){}function v(){}var w={};u(w,a,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(N([])));E&&E!==r&&n.call(E,a)&&(w=E);var _=v.prototype=b.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function r(o,i,a,s){var c=f(e[o],e,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==S(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function T(t,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=A(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function A(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function N(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(S(t)+" is not iterable")}return m.prototype=v,o(_,"constructor",{value:v,configurable:!0}),o(v,"constructor",{value:m,configurable:!0}),m.displayName=u(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,u(e,c,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},x(L.prototype),u(L.prototype,s,(function(){return this})),t.AsyncIterator=L,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(_),u(_,c,"Generator"),u(_,a,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function O(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N(n.key),n)}}function N(e){var t=function(e,t){if("object"!=S(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==S(t)?t:t+""}var j=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Http=t},t=[{key:"postReport",value:(n=R().mark((function e(t,r,n,o,i,a,c,l,f){var h,p;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,h={trace_id:null!=t?t:"",cid:r,node_id:n,rate:o,cost_ms:i,total_size:a,state:c,transfer_type:l,log:f},e.next=4,this.Http.postData("/api/v1/storage/transfer/report",h);case 4:if(0===(p=e.sent).code){e.next=7;break}return e.abrupt("return",u({code:p.code,msg:"Failed to report"}));case 7:return e.abrupt("return",p);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",u({code:s.REPORT_ERROR,msg:"Failed to report: "+e.t0}));case 13:case"end":return e.stop()}}),e,this,[[0,10]])})),o=function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){O(i,r,o,a,s,"next",e)}function s(e){O(i,r,o,a,s,"throw",e)}a(void 0)}))},function(e,t,r,n,i,a,s,c,u){return o.apply(this,arguments)})},{key:"creatReportData",value:function(e,t){if(0!=e.length){var r=e.filter((function(e){return"Failed to upload file: Upload aborted"!=e.msg})),n=r.map((function(e){return e.nodeId.toLowerCase()})).join(", "),o=r.reduce((function(e,t){return A(A({},e),t.log)}),{}),i=0===Object.keys(o).length?null:JSON.stringify(o),a=r[0].traceId,s=r[0].cId,c=n,u=r[0].transferRate,l=r[0].elapsedTime,f=r[0].size,h=r[0].status,p=t,d=i;this.postReport(a,s,c,u,l,f,h,p,d)}}}],t&&D(e.prototype,t),r&&D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,n,o}();const P=j;function z(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return F(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?F(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function U(){U=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),s=new R(n||[]);return o(a,"_invoke",{value:S(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",g={};function b(){}function m(){}function v(){}var w={};u(w,a,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(O([])));E&&E!==r&&n.call(E,a)&&(w=E);var _=v.prototype=b.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function r(o,i,a,s){var c=f(e[o],e,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==B(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function S(t,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=T(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function T(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,T(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function O(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(B(t)+" is not iterable")}return m.prototype=v,o(_,"constructor",{value:v,configurable:!0}),o(v,"constructor",{value:m,configurable:!0}),m.displayName=u(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,u(e,c,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},x(L.prototype),u(L.prototype,s,(function(){return this})),t.AsyncIterator=L,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(_),u(_,c,"Generator"),u(_,a,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=O,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),I(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:O(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function C(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function M(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){C(i,n,o,a,s,"next",e)}function s(e){C(i,n,o,a,s,"throw",e)}a(void 0)}))}}function H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q(n.key),n)}}function $(e,t,r){return t&&G(e.prototype,t),r&&G(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function q(e){var t=function(e,t){if("object"!=B(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=B(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==B(t)?t:t+""}var V=function(){return $((function e(){H(this,e),this._locked=!1,this._waiting=[]}),[{key:"acquire",value:(e=M(U().mark((function e(){var t=this;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._locked){e.next=5;break}return e.next=3,new Promise((function(e){return t._waiting.push(e)}));case 3:e.next=0;break;case 5:this._locked=!0;case 6:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})},{key:"release",value:function(){(this._locked=!1,this._waiting.length>0)&&this._waiting.shift()()}}]);var e}(),Y=function(){return $((function e(t){H(this,e),this.concurrentLimit=3,this.progressCallback=null,this.chunkQueue=[],this.downloadedChunks=[],this.maxRetries=3,this.failedChunks=[],this.report=new P(t),this.mimeType="application/octet-stream",this.lock=new V,this.paused=!1}),[{key:"setProgressCallback",value:function(e){this.progressCallback=e}},{key:"checkUrl",value:(a=M(U().mark((function e(t){var r;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{method:"HEAD"});case 3:return r=e.sent,e.abrupt("return",r.ok);case 7:return e.prev=7,e.t0=e.catch(0),c("Error checking URL:",e.t0),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(e){return a.apply(this,arguments)})},{key:"downloadChunk",value:(i=M(U().mark((function e(t,r,n){var o,i,a,s,u=arguments;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=u.length>3&&void 0!==u[3]?u[3]:0,e.prev=1,e.next=4,fetch(t,{headers:{Range:"bytes=".concat(r,"-").concat(n)}});case 4:if(!(i=e.sent).ok){e.next=18;break}return e.next=8,i.blob();case 8:if(a=e.sent,s=n-r+1,c("Downloading chunk ".concat(r,"-").concat(n,": expected size ").concat(s,", actual size ").concat(a.size)),a.size===s){e.next=13;break}throw new Error("Chunk size mismatch: expected ".concat(s,", but got ").concat(a.size));case 13:return this.downloadedChunks.push({start:r,blob:a}),this.mimeType=i.headers.get("Content-Type"),e.abrupt("return",a);case 18:throw new Error("Failed to download chunk: ".concat(r,"-").concat(n,", status: ").concat(i.status));case 19:e.next=32;break;case 21:if(e.prev=21,e.t0=e.catch(1),!(o<this.maxRetries)){e.next=30;break}return c("Chunk download failed, retrying attempt ".concat(o+1," for chunk ").concat(r,"-").concat(n)),e.next=27,new Promise((function(e){return setTimeout(e,1e3)}));case 27:return e.abrupt("return",this.downloadChunk(t,r,n,o+1));case 30:throw this.failedChunks.push({start:r,end:n}),new Error("Chunk download failed after ".concat(this.maxRetries," attempts: ").concat(r,"-").concat(n));case 32:case"end":return e.stop()}}),e,this,[[1,21]])}))),function(e,t,r){return i.apply(this,arguments)})},{key:"downloadFile",value:(o=M(U().mark((function e(t,r,n,o,i){var a,s,l,f,h,p,d,y,g;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Math.ceil(i/t.length),s=[],e.prev=2,l=Date.now(),e.next=6,this.concurrentDownload(t,i,a);case 6:if(this.downloadedChunks.every((function(e,r){var n=r<t.length-1?a:i%a;return e.blob.size===n}))){e.next=11;break}return c("Some chunks were incomplete. Retrying..."),e.next=11,this.retryMissingChunks(this.failedChunks,t);case 11:if((f=this.mergeChunks(this.downloadedChunks,this.mimeType)).size===i){e.next=14;break}throw new Error("File size mismatch: expected ".concat(i,", but got ").concat(f.size));case 14:return h=window.URL.createObjectURL(f),(p=document.createElement("a")).href=h,p.download=o,document.body.appendChild(p),p.click(),window.URL.revokeObjectURL(h),document.body.removeChild(p),d=Date.now(),y=d-l,g=Math.floor(i/y*1e3),t.forEach((function(e){var t=new URL(e).hostname.split(".")[0];s.push({status:1,msg:"successful",elapsedTime:y,transferRate:g,size:i,traceId:r,nodeId:t,cId:n,log:""})})),this.report.creatReportData(s,"download"),e.abrupt("return",Promise.resolve({code:0,msg:"Download successful"}));case 30:return e.prev=30,e.t0=e.catch(2),t.forEach((function(t){var o=new URL(t).hostname.split(".")[0];s.push({status:-1,msg:e.t0.message,elapsedTime:-1,transferRate:-1,size:i,traceId:r,nodeId:o,cId:n,log:e.t0.stack||""})})),this.report.creatReportData(s,"download"),u(e.t0),e.abrupt("return",{code:-1,msg:"Download failed: "+e.t0});case 36:case"end":return e.stop()}}),e,this,[[2,30]])}))),function(e,t,r,n,i){return o.apply(this,arguments)})},{key:"concurrentDownload",value:(n=M(U().mark((function e(t,r,n){var o,i,a,s,u,l,f,h,p,d,y,g=this;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=t.slice(),i=0,a=Math.ceil(r/n),s=0;s<a;s++)u=s*n,l=Math.min(r-1,(s+1)*n-1),this.chunkQueue.push({start:u,end:l});for(f=[],h=new Array(o.length).fill(!1),p=function(){var e=Math.min(100,i/r*100).toFixed(2);g.progressCallback&&g.progressCallback(e)},d=function(){var e=M(U().mark((function e(t,r){var n,o;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,e.next=4,g.lock.acquire();case 4:if(g.chunkQueue.length>0&&(n=g.chunkQueue.shift()),g.lock.release(),n){e.next=8;break}return e.abrupt("break",21);case 8:return e.prev=8,e.next=11,g.downloadChunk(t,n.start,n.end);case 11:o=e.sent,i+=o.size,p(),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(8),c("Failed to download chunk ".concat(n.start,"-").concat(n.end," from ").concat(t,":"),e.t0);case 19:e.next=0;break;case 21:h[r]=!1;case 22:case"end":return e.stop()}}),e,null,[[8,16]])})));return function(t,r){return e.apply(this,arguments)}}(),y=0;y<o.length;y++)y<this.concurrentLimit&&(h[y]=!0,f.push(d(o[y],y)));return e.next=11,Promise.all(f);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"retryMissingChunks",value:(r=M(U().mark((function e(t,r){var n,o,i,a,s,u,l,f;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=z(t),e.prev=1,n.s();case 3:if((o=n.n()).done){e.next=37;break}i=o.value,a=!1,s=z(r),e.prev=7,s.s();case 9:if((u=s.n()).done){e.next=26;break}return l=u.value,e.prev=11,c("Re-download chunk ".concat(i.start,"-").concat(i.end," from ").concat(l)),e.next=15,this.downloadChunk(l,i.start,i.end);case 15:return f=e.sent,this.downloadedChunks.push({start:i.start,blob:f}),a=!0,e.abrupt("break",26);case 21:e.prev=21,e.t0=e.catch(11),c("Failed to re-download chunk ".concat(i.start,"-").concat(i.end," from ").concat(l,":"),e.t0);case 24:e.next=9;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(7),s.e(e.t1);case 31:return e.prev=31,s.f(),e.finish(31);case 34:a||c("Re-download chunk ".concat(i.start,"-").concat(i.end," failed after all attempts."));case 35:e.next=3;break;case 37:e.next=42;break;case 39:e.prev=39,e.t2=e.catch(1),n.e(e.t2);case 42:return e.prev=42,n.f(),e.finish(42);case 45:case"end":return e.stop()}}),e,this,[[1,39,42,45],[7,28,31,34],[11,21]])}))),function(e,t){return r.apply(this,arguments)})},{key:"mergeChunks",value:function(e,t){var r=e.sort((function(e,t){return e.start-t.start}));return new Blob(r.map((function(e){return e.blob})),{type:t})}},{key:"downloadFiles",value:(t=M(U().mark((function e(t,r,n,o,i){return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){var s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType="blob",s.onprogress=function(e){var t=e.loaded/o*100;t>100&&(t=100),i(r,t)},s.onload=function(){if(200===s.status){var t=document.createElement("a"),n=window.URL.createObjectURL(s.response);t.href=n,t.download=r,document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(n),document.body.removeChild(t),e({code:0,msg:"Download successful"})}else a({code:-1,msg:"Download failed"+s.statusText})},s.onerror=function(){a({code:-1,msg:"Download onerror"})},n.signal.addEventListener("abort",(function(){s.abort(),a({code:-1,msg:"Download abort"})})),s.send()})));case 1:case"end":return e.stop()}}),e)}))),function(e,r,n,o,i){return t.apply(this,arguments)})},{key:"downloadFromMultipleUrls",value:(e=M(U().mark((function e(t,r,n,o,i,a){var s,c,u,l,f,h,p,d,y,g,b,m=this;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=new AbortController,u=[],l=!1,f=0,h=[],p=function(e,t){l||t>f&&(f=t,a&&a(f.toFixed(2)))},d=z(t),e.prev=7,g=U().mark((function e(){var t,a,s,f,d;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=y.value,a=Date.now(),s=new URL(t),f=s.hostname.split(".")[0],d=function(){var e=M(U().mark((function e(){var s,u,d,y,g;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=0;case 1:if(!(s<3)){e.next=29;break}if(!l){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,m.downloadFiles(t+"&format=tar",o+".tar",c,i,p);case 7:return u=e.sent,l=!0,c.abort(),d=Date.now(),y=d-a,g=Math.floor(i/y*1e3),h.push({status:1,msg:"successful",elapsedTime:y,transferRate:g,size:i,traceId:r,nodeId:f,cId:n,log:""}),m.report.creatReportData(h,"download"),e.abrupt("return",Promise.resolve(u));case 18:if(e.prev=18,e.t0=e.catch(4),s++,!l){e.next=23;break}return e.abrupt("return");case 23:if(!(s>=3)){e.next=27;break}return h.push({status:2,msg:"failed",elapsedTime:0,transferRate:0,size:i,traceId:r,nodeId:f,cId:n,log:(b={},v=f,w=e.t0,(v=q(v))in b?Object.defineProperty(b,v,{value:w,enumerable:!0,configurable:!0,writable:!0}):b[v]=w,b)}),m.report.creatReportData(h,"download"),e.abrupt("return",{code:-1,msg:"Download failed"});case 27:e.next=1;break;case 29:case"end":return e.stop()}var b,v,w}),e,null,[[4,18]])})));return function(){return e.apply(this,arguments)}}(),u.push(d());case 6:case"end":return e.stop()}}),e)})),d.s();case 10:if((y=d.n()).done){e.next=14;break}return e.delegateYield(g(),"t0",12);case 12:e.next=10;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(7),d.e(e.t1);case 19:return e.prev=19,d.f(),e.finish(19);case 22:return e.next=24,Promise.allSettled(u);case 24:return b=e.sent,e.abrupt("return",l?(null===(s=b.find((function(e){return"fulfilled"===e.status&&e.value&&0===e.value.code})))||void 0===s?void 0:s.value)||{code:-1,msg:"No successful download result found"}:{code:-1,msg:"All url download failed"});case 26:case"end":return e.stop()}}),e,null,[[7,16,19,22]])}))),function(t,r,n,o,i,a){return e.apply(this,arguments)})}]);var e,t,r,n,o,i,a}();const W=Y,K=new Uint8Array(0);function J(e){const t=e.match(/../g);return null!=t?new Uint8Array(t.map((e=>parseInt(e,16)))):K}function Q(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}var Z=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var i=e.charAt(o),a=i.charCodeAt(0);if(255!==r[a])throw new TypeError(i+" is ambiguous");r[a]=o}var s=e.length,c=e.charAt(0),u=Math.log(s)/Math.log(256),l=Math.log(256)/Math.log(s);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,o=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*u+1>>>0,a=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var f=0,h=i-1;(0!==l||f<o)&&-1!==h;h--,f++)l+=s*a[h]>>>0,a[h]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");o=f,t++}if(" "!==e[t]){for(var p=i-o;p!==i&&0===a[p];)p++;for(var d=new Uint8Array(n+(i-p)),y=n;p!==i;)d[y++]=a[p++];return d}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,o=0,i=t.length;o!==i&&0===t[o];)o++,r++;for(var a=(i-o)*l+1>>>0,u=new Uint8Array(a);o!==i;){for(var f=t[o],h=0,p=a-1;(0!==f||h<n)&&-1!==p;p--,h++)f+=256*u[p]>>>0,u[p]=f%s>>>0,f=f/s>>>0;if(0!==f)throw new Error("Non-zero carry");n=h,o++}for(var d=a-n;d!==a&&0===u[d];)d++;for(var y=c.repeat(r);d<a;++d)y+=e.charAt(u[d]);return y},decodeUnsafe:f,decode:function(e){var r=f(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const X=Z;class ee{name;prefix;baseEncode;constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class te{name;prefix;baseDecode;prefixCodePoint;constructor(e,t,r){this.name=e,this.prefix=t;const n=t.codePointAt(0);if(void 0===n)throw new Error("Invalid prefix character");this.prefixCodePoint=n,this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return ne(this,e)}}class re{decoders;constructor(e){this.decoders=e}or(e){return ne(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(null!=r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function ne(e,t){return new re({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}class oe{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new ee(e,t,r),this.decoder=new te(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function ie({name:e,prefix:t,encode:r,decode:n}){return new oe(e,t,r,n)}function ae({name:e,prefix:t,alphabet:r}){const{encode:n,decode:o}=X(r,e);return ie({prefix:t,name:e,encode:n,decode:e=>Q(o(e))})}function se({name:e,prefix:t,bitsPerChar:r,alphabet:n}){return ie({prefix:t,name:e,encode:e=>function(e,t,r){const n="="===t[t.length-1],o=(1<<r)-1;let i="",a=0,s=0;for(let n=0;n<e.length;++n)for(s=s<<8|e[n],a+=8;a>r;)a-=r,i+=t[o&s>>a];if(0!==a&&(i+=t[o&s<<r-a]),n)for(;i.length*r&7;)i+="=";return i}(e,n,r),decode:t=>function(e,t,r,n){const o={};for(let e=0;e<t.length;++e)o[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const a=new Uint8Array(i*r/8|0);let s=0,c=0,u=0;for(let t=0;t<i;++t){const i=o[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,s+=r,s>=8&&(s-=8,a[u++]=255&c>>s)}if(s>=r||255&c<<8-s)throw new SyntaxError("Unexpected end of data");return a}(t,n,r,e)})}const ce=se({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ue=(se({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),se({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),se({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),se({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),se({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),se({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),se({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),se({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ae({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"})),le=(ae({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),ae({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));ae({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var fe=function e(t,r,n){r=r||[],n=n||0;var o=n;for(;t>=de;)r[n++]=255&t|he,t/=128;for(;t&pe;)r[n++]=255&t|he,t>>>=7;return r[n]=0|t,e.bytes=n-o+1,r},he=128,pe=-128,de=Math.pow(2,31);var ye=function e(t,r){var n,o=0,i=(r=r||0,0),a=r,s=t.length;do{if(a>=s)throw e.bytes=0,new RangeError("Could not decode varint");n=t[a++],o+=i<28?(n&be)<<i:(n&be)*Math.pow(2,i),i+=7}while(n>=ge);return e.bytes=a-r,o},ge=128,be=127;var me=Math.pow(2,7),ve=Math.pow(2,14),we=Math.pow(2,21),ke=Math.pow(2,28),Ee=Math.pow(2,35),_e=Math.pow(2,42),xe=Math.pow(2,49),Le=Math.pow(2,56),Se=Math.pow(2,63);const Te={encode:fe,decode:ye,encodingLength:function(e){return e<me?1:e<ve?2:e<we?3:e<ke?4:e<Ee?5:e<_e?6:e<xe?7:e<Le?8:e<Se?9:10}};function Ae(e,t=0){return[Te.decode(e,t),Te.decode.bytes]}function Ie(e,t,r=0){return Te.encode(e,t,r),t}function Re(e){return Te.encodingLength(e)}function Oe(e,t){const r=t.byteLength,n=Re(e),o=n+Re(r),i=new Uint8Array(o+r);return Ie(e,i,0),Ie(r,i,n),i.set(t,o),new De(e,r,t,i)}class De{code;size;digest;bytes;constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}function Ne(e,t){const{bytes:r,version:n}=e;return 0===n?function(e,t,r){const{prefix:n}=r;if(n!==le.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const o=t.get(n);if(null==o){const o=r.encode(e).slice(1);return t.set(n,o),o}return o}(r,Pe(e),t??le.encoder):function(e,t,r){const{prefix:n}=r,o=t.get(n);if(null==o){const o=r.encode(e);return t.set(n,o),o}return o}(r,Pe(e),t??ce.encoder)}const je=new WeakMap;function Pe(e){const t=je.get(e);if(null==t){const t=new Map;return je.set(e,t),t}return t}class ze{code;version;multihash;bytes;"/";constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Fe)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Be)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return ze.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Oe(e,t);return ze.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return ze.equals(this,e)}static equals(e,t){const r=t;return null!=r&&e.code===r.code&&e.version===r.version&&function(e,t){if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(e.bytes,r.bytes)}}(e.multihash,r.multihash)}toString(e){return Ne(this,e)}toJSON(){return{"/":Ne(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof ze)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:o}=t;return new ze(e,r,n,o??Ue(e,r,n.bytes))}if(!0===t[Ce]){const{version:e,multihash:r,code:n}=t,o=function(e){const t=Q(e),[r,n]=Ae(t),[o,i]=Ae(t.subarray(n)),a=t.subarray(n+i);if(a.byteLength!==o)throw new Error("Incorrect length");return new De(r,o,a,t)}(r);return ze.create(e,n,o)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Fe)throw new Error(`Version 0 CID must use dag-pb (code: ${Fe}) block encoding`);return new ze(e,t,r,r.bytes);case 1:{const n=Ue(e,t,r.bytes);return new ze(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return ze.create(0,Fe,e)}static createV1(e,t){return ze.create(1,e,t)}static decode(e){const[t,r]=ze.decodeFirst(e);if(0!==r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=ze.inspectBytes(e),r=t.size-t.multihashSize,n=Q(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const o=n.subarray(t.multihashSize-t.digestSize),i=new De(t.multihashCode,t.digestSize,o,n);return[0===t.version?ze.createV0(i):ze.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=Ae(e.subarray(t));return t+=n,r};let n=r(),o=Fe;if(18===n?(n=0,t=0):o=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,a=r(),s=r(),c=t+s;return{version:n,codec:o,multihashCode:a,digestSize:s,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=function(e,t){switch(e[0]){case"Q":{const r=t??le;return[le.prefix,r.decode(`${le.prefix}${e}`)]}case le.prefix:{const r=t??le;return[le.prefix,r.decode(e)]}case ce.prefix:{const r=t??ce;return[ce.prefix,r.decode(e)]}case ue.prefix:{const r=t??ue;return[ue.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}(e,t),o=ze.decode(n);if(0===o.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return Pe(o).set(r,e),o}}const Fe=112,Be=18;function Ue(e,t,r){const n=Re(e),o=n+Re(t),i=new Uint8Array(o+r.byteLength);return Ie(e,i,0),Ie(t,i,n),i.set(r,o),i}const Ce=Symbol.for("@ipld/js-cid/CID"),Me=new TextDecoder;function He(e,t){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(t>=e.length)throw new Error("protobuf: unexpected end of data");const o=e[t++];if(r+=n<28?(127&o)<<n:(127&o)*2**n,o<128)break}return[r,t]}function Ge(e,t){let r;[r,t]=He(e,t);const n=t+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(t,n),n]}function $e(e,t){let r;return[r,t]=He(e,t),[7&r,r>>3,t]}function qe(e){const t={},r=e.length;let n=0;for(;n<r;){let r,o;if([r,o,n]=$e(e,n),1===o){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Hash`);if(void 0!==t.Name)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,n]=Ge(e,n)}else if(2===o){if(void 0!==t.Name)throw new Error("protobuf: (PBLink) duplicate Name section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Name`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,n]=Ge(e,n),t.Name=Me.decode(o)}else{if(3!==o)throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${o}`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(0!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Tsize`);[t.Tsize,n]=He(e,n)}}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return t}const Ve=new TextEncoder,Ye=2**32,We=2**31;function Ke(e,t){let r=t.length;if("number"==typeof e.Tsize){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");r=Ze(t,r,e.Tsize)-1,t[r]=24}if("string"==typeof e.Name){const n=Ve.encode(e.Name);r-=n.length,t.set(n,r),r=Ze(t,r,n.length)-1,t[r]=18}return e.Hash&&(r-=e.Hash.length,t.set(e.Hash,r),r=Ze(t,r,e.Hash.length)-1,t[r]=10),t.length-r}function Je(e){const t=function(e){let t=0;if(e.Data){const r=e.Data.length;t+=1+r+Xe(r)}if(e.Links)for(const r of e.Links){const e=Qe(r);t+=1+e+Xe(e)}return t}(e),r=new Uint8Array(t);let n=t;if(e.Data&&(n-=e.Data.length,r.set(e.Data,n),n=Ze(r,n,e.Data.length)-1,r[n]=10),e.Links)for(let t=e.Links.length-1;t>=0;t--){const o=Ke(e.Links[t],r.subarray(0,n));n-=o,n=Ze(r,n,o)-1,r[n]=18}return r}function Qe(e){let t=0;if(e.Hash){const r=e.Hash.length;t+=1+r+Xe(r)}if("string"==typeof e.Name){const r=Ve.encode(e.Name).length;t+=1+r+Xe(r)}return"number"==typeof e.Tsize&&(t+=1+Xe(e.Tsize)),t}function Ze(e,t,r){const n=t-=Xe(r);for(;r>=We;)e[t++]=127&r|128,r/=128;for(;r>=128;)e[t++]=127&r|128,r>>>=7;return e[t]=r,n}function Xe(e){return e%2==0&&e++,Math.floor((function(e){let t=0;e>=Ye&&(e=Math.floor(e/Ye),t=32);e>=65536&&(e>>>=16,t+=16);e>=256&&(e>>>=8,t+=8);return t+et[e]}(e)+6)/7)}const et=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],tt=["Data","Links"],rt=["Hash","Name","Tsize"],nt=new TextEncoder;function ot(e,t){if(e===t)return 0;const r=e.Name?nt.encode(e.Name):[],n=t.Name?nt.encode(t.Name):[];let o=r.length,i=n.length;for(let e=0,t=Math.min(o,i);e<t;++e)if(r[e]!==n[e]){o=r[e],i=n[e];break}return o<i?-1:i<o?1:0}function it(e,t){return!Object.keys(e).some((e=>!t.includes(e)))}function at(e){if("object"==typeof e.asCID){const t=ze.asCID(e);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if("object"!=typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(e.Hash){let r=ze.asCID(e.Hash);try{r||("string"==typeof e.Hash?r=ze.parse(e.Hash):e.Hash instanceof Uint8Array&&(r=ze.decode(e.Hash)))}catch(e){throw new TypeError(`Invalid DAG-PB form: ${e.message}`)}r&&(t.Hash=r)}if(!t.Hash)throw new TypeError("Invalid DAG-PB form");return"string"==typeof e.Name&&(t.Name=e.Name),"number"==typeof e.Tsize&&(t.Tsize=e.Tsize),t}function st(e){if((e instanceof Uint8Array||"string"==typeof e)&&(e={Data:e}),"object"!=typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(void 0!==e.Data)if("string"==typeof e.Data)t.Data=nt.encode(e.Data);else{if(!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form");t.Data=e.Data}if(void 0!==e.Links){if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form");t.Links=e.Links.map(at),t.Links.sort(ot)}else t.Links=[];return t}function ct(e){!function(e){if(!e||"object"!=typeof e||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form");if(!it(e,tt))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(void 0!==e.Data&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let t=0;t<e.Links.length;t++){const r=e.Links[t];if(!r||"object"!=typeof r||Array.isArray(r)||r instanceof Uint8Array||r["/"]&&r["/"]===r.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!it(r,rt))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(void 0===r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(null==r.Hash||!r.Hash["/"]||r.Hash["/"]!==r.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(void 0!==r.Name&&"string"!=typeof r.Name)throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(void 0!==r.Tsize){if("number"!=typeof r.Tsize||r.Tsize%1!=0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(r.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(t>0&&-1===ot(r,e.Links[t-1]))throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}(e);const t={};return e.Links&&(t.Links=e.Links.map((e=>{const t={};return e.Hash&&(t.Hash=e.Hash.bytes),void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),e.Data&&(t.Data=e.Data),Je(t)}function ut(e){const t=function(e){const t=e.length;let r,n,o=0,i=!1;for(;o<t;){let t,a;if([t,a,o]=$e(e,o),2!==t)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${t}`);if(1===a){if(n)throw new Error("protobuf: (PBNode) duplicate Data section");[n,o]=Ge(e,o),r&&(i=!0)}else{if(2!==a)throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${a}`);{if(i)throw new Error("protobuf: (PBNode) duplicate Links section");let t;r||(r=[]),[t,o]=Ge(e,o),r.push(qe(t))}}}if(o>t)throw new Error("protobuf: (PBNode) unexpected end of data");const a={};return n&&(a.Data=n),a.Links=r||[],a}(function(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}(e)),r={};return t.Data&&(r.Data=t.Data),t.Links&&(r.Links=t.Links.map((e=>{const t={};try{t.Hash=ze.decode(e.Hash)}catch(e){}if(!t.Hash)throw new Error("Invalid Hash field found in link, expected CID");return void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),r}var lt=__webpack_require__(946);const ft=lt.Reader,ht=lt.Writer,pt=lt.util,dt=lt.roots.unixfs||(lt.roots.unixfs={}),yt=dt.Data=(()=>{function e(e){if(this.blocksizes=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Type=0,e.prototype.Data=pt.newBuffer([]),e.prototype.filesize=pt.Long?pt.Long.fromBits(0,0,!0):0,e.prototype.blocksizes=pt.emptyArray,e.prototype.hashType=pt.Long?pt.Long.fromBits(0,0,!0):0,e.prototype.fanout=pt.Long?pt.Long.fromBits(0,0,!0):0,e.prototype.mode=0,e.prototype.mtime=null,e.encode=function(e,t){if(t||(t=ht.create()),t.uint32(8).int32(e.Type),null!=e.Data&&Object.hasOwnProperty.call(e,"Data")&&t.uint32(18).bytes(e.Data),null!=e.filesize&&Object.hasOwnProperty.call(e,"filesize")&&t.uint32(24).uint64(e.filesize),null!=e.blocksizes&&e.blocksizes.length)for(var r=0;r<e.blocksizes.length;++r)t.uint32(32).uint64(e.blocksizes[r]);return null!=e.hashType&&Object.hasOwnProperty.call(e,"hashType")&&t.uint32(40).uint64(e.hashType),null!=e.fanout&&Object.hasOwnProperty.call(e,"fanout")&&t.uint32(48).uint64(e.fanout),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(56).uint32(e.mode),null!=e.mtime&&Object.hasOwnProperty.call(e,"mtime")&&dt.UnixTime.encode(e.mtime,t.uint32(66).fork()).ldelim(),t},e.decode=function(e,t){e instanceof ft||(e=ft.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new dt.Data;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.Type=e.int32();break;case 2:n.Data=e.bytes();break;case 3:n.filesize=e.uint64();break;case 4:if(n.blocksizes&&n.blocksizes.length||(n.blocksizes=[]),2==(7&o))for(var i=e.uint32()+e.pos;e.pos<i;)n.blocksizes.push(e.uint64());else n.blocksizes.push(e.uint64());break;case 5:n.hashType=e.uint64();break;case 6:n.fanout=e.uint64();break;case 7:n.mode=e.uint32();break;case 8:n.mtime=dt.UnixTime.decode(e,e.uint32());break;default:e.skipType(7&o)}}if(!n.hasOwnProperty("Type"))throw pt.ProtocolError("missing required 'Type'",{instance:n});return n},e.fromObject=function(e){if(e instanceof dt.Data)return e;var t=new dt.Data;switch(e.Type){case"Raw":case 0:t.Type=0;break;case"Directory":case 1:t.Type=1;break;case"File":case 2:t.Type=2;break;case"Metadata":case 3:t.Type=3;break;case"Symlink":case 4:t.Type=4;break;case"HAMTShard":case 5:t.Type=5}if(null!=e.Data&&("string"==typeof e.Data?pt.base64.decode(e.Data,t.Data=pt.newBuffer(pt.base64.length(e.Data)),0):e.Data.length&&(t.Data=e.Data)),null!=e.filesize&&(pt.Long?(t.filesize=pt.Long.fromValue(e.filesize)).unsigned=!0:"string"==typeof e.filesize?t.filesize=parseInt(e.filesize,10):"number"==typeof e.filesize?t.filesize=e.filesize:"object"==typeof e.filesize&&(t.filesize=new pt.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0))),e.blocksizes){if(!Array.isArray(e.blocksizes))throw TypeError(".Data.blocksizes: array expected");t.blocksizes=[];for(var r=0;r<e.blocksizes.length;++r)pt.Long?(t.blocksizes[r]=pt.Long.fromValue(e.blocksizes[r])).unsigned=!0:"string"==typeof e.blocksizes[r]?t.blocksizes[r]=parseInt(e.blocksizes[r],10):"number"==typeof e.blocksizes[r]?t.blocksizes[r]=e.blocksizes[r]:"object"==typeof e.blocksizes[r]&&(t.blocksizes[r]=new pt.LongBits(e.blocksizes[r].low>>>0,e.blocksizes[r].high>>>0).toNumber(!0))}if(null!=e.hashType&&(pt.Long?(t.hashType=pt.Long.fromValue(e.hashType)).unsigned=!0:"string"==typeof e.hashType?t.hashType=parseInt(e.hashType,10):"number"==typeof e.hashType?t.hashType=e.hashType:"object"==typeof e.hashType&&(t.hashType=new pt.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0))),null!=e.fanout&&(pt.Long?(t.fanout=pt.Long.fromValue(e.fanout)).unsigned=!0:"string"==typeof e.fanout?t.fanout=parseInt(e.fanout,10):"number"==typeof e.fanout?t.fanout=e.fanout:"object"==typeof e.fanout&&(t.fanout=new pt.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0))),null!=e.mode&&(t.mode=e.mode>>>0),null!=e.mtime){if("object"!=typeof e.mtime)throw TypeError(".Data.mtime: object expected");t.mtime=dt.UnixTime.fromObject(e.mtime)}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.blocksizes=[]),t.defaults){if(r.Type=t.enums===String?"Raw":0,t.bytes===String?r.Data="":(r.Data=[],t.bytes!==Array&&(r.Data=pt.newBuffer(r.Data))),pt.Long){var n=new pt.Long(0,0,!0);r.filesize=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.filesize=t.longs===String?"0":0;if(pt.Long){n=new pt.Long(0,0,!0);r.hashType=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.hashType=t.longs===String?"0":0;if(pt.Long){n=new pt.Long(0,0,!0);r.fanout=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.fanout=t.longs===String?"0":0;r.mode=0,r.mtime=null}if(null!=e.Type&&e.hasOwnProperty("Type")&&(r.Type=t.enums===String?dt.Data.DataType[e.Type]:e.Type),null!=e.Data&&e.hasOwnProperty("Data")&&(r.Data=t.bytes===String?pt.base64.encode(e.Data,0,e.Data.length):t.bytes===Array?Array.prototype.slice.call(e.Data):e.Data),null!=e.filesize&&e.hasOwnProperty("filesize")&&("number"==typeof e.filesize?r.filesize=t.longs===String?String(e.filesize):e.filesize:r.filesize=t.longs===String?pt.Long.prototype.toString.call(e.filesize):t.longs===Number?new pt.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0):e.filesize),e.blocksizes&&e.blocksizes.length){r.blocksizes=[];for(var o=0;o<e.blocksizes.length;++o)"number"==typeof e.blocksizes[o]?r.blocksizes[o]=t.longs===String?String(e.blocksizes[o]):e.blocksizes[o]:r.blocksizes[o]=t.longs===String?pt.Long.prototype.toString.call(e.blocksizes[o]):t.longs===Number?new pt.LongBits(e.blocksizes[o].low>>>0,e.blocksizes[o].high>>>0).toNumber(!0):e.blocksizes[o]}return null!=e.hashType&&e.hasOwnProperty("hashType")&&("number"==typeof e.hashType?r.hashType=t.longs===String?String(e.hashType):e.hashType:r.hashType=t.longs===String?pt.Long.prototype.toString.call(e.hashType):t.longs===Number?new pt.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0):e.hashType),null!=e.fanout&&e.hasOwnProperty("fanout")&&("number"==typeof e.fanout?r.fanout=t.longs===String?String(e.fanout):e.fanout:r.fanout=t.longs===String?pt.Long.prototype.toString.call(e.fanout):t.longs===Number?new pt.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0):e.fanout),null!=e.mode&&e.hasOwnProperty("mode")&&(r.mode=e.mode),null!=e.mtime&&e.hasOwnProperty("mtime")&&(r.mtime=dt.UnixTime.toObject(e.mtime,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,lt.util.toJSONOptions)},e.DataType=function(){const e={},t=Object.create(e);return t[e[0]="Raw"]=0,t[e[1]="Directory"]=1,t[e[2]="File"]=2,t[e[3]="Metadata"]=3,t[e[4]="Symlink"]=4,t[e[5]="HAMTShard"]=5,t}(),e})(),gt=(dt.UnixTime=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Seconds=pt.Long?pt.Long.fromBits(0,0,!1):0,e.prototype.FractionalNanoseconds=0,e.encode=function(e,t){return t||(t=ht.create()),t.uint32(8).int64(e.Seconds),null!=e.FractionalNanoseconds&&Object.hasOwnProperty.call(e,"FractionalNanoseconds")&&t.uint32(21).fixed32(e.FractionalNanoseconds),t},e.decode=function(e,t){e instanceof ft||(e=ft.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new dt.UnixTime;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.Seconds=e.int64();break;case 2:n.FractionalNanoseconds=e.fixed32();break;default:e.skipType(7&o)}}if(!n.hasOwnProperty("Seconds"))throw pt.ProtocolError("missing required 'Seconds'",{instance:n});return n},e.fromObject=function(e){if(e instanceof dt.UnixTime)return e;var t=new dt.UnixTime;return null!=e.Seconds&&(pt.Long?(t.Seconds=pt.Long.fromValue(e.Seconds)).unsigned=!1:"string"==typeof e.Seconds?t.Seconds=parseInt(e.Seconds,10):"number"==typeof e.Seconds?t.Seconds=e.Seconds:"object"==typeof e.Seconds&&(t.Seconds=new pt.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber())),null!=e.FractionalNanoseconds&&(t.FractionalNanoseconds=e.FractionalNanoseconds>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(pt.Long){var n=new pt.Long(0,0,!1);r.Seconds=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.Seconds=t.longs===String?"0":0;r.FractionalNanoseconds=0}return null!=e.Seconds&&e.hasOwnProperty("Seconds")&&("number"==typeof e.Seconds?r.Seconds=t.longs===String?String(e.Seconds):e.Seconds:r.Seconds=t.longs===String?pt.Long.prototype.toString.call(e.Seconds):t.longs===Number?new pt.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber():e.Seconds),null!=e.FractionalNanoseconds&&e.hasOwnProperty("FractionalNanoseconds")&&(r.FractionalNanoseconds=e.FractionalNanoseconds),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,lt.util.toJSONOptions)},e})(),dt.Metadata=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.MimeType="",e.encode=function(e,t){return t||(t=ht.create()),null!=e.MimeType&&Object.hasOwnProperty.call(e,"MimeType")&&t.uint32(10).string(e.MimeType),t},e.decode=function(e,t){e instanceof ft||(e=ft.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new dt.Metadata;e.pos<r;){var o=e.uint32();if(o>>>3==1)n.MimeType=e.string();else e.skipType(7&o)}return n},e.fromObject=function(e){if(e instanceof dt.Metadata)return e;var t=new dt.Metadata;return null!=e.MimeType&&(t.MimeType=String(e.MimeType)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.MimeType=""),null!=e.MimeType&&e.hasOwnProperty("MimeType")&&(r.MimeType=e.MimeType),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,lt.util.toJSONOptions)},e})(),yt.DataType),bt=Object.freeze([]),mt=new Uint8Array(0),vt=Object.freeze({}),wt=parseInt("0644",8),kt=parseInt("0755",8),Et=112,_t="UnixFS",xt=(e,t)=>(Object(globalThis).debug&&console.log({data:e,links:t}),ct(st({Data:yt.encode(e).finish(),Links:t}))),Lt=e=>({type:gt.Raw,content:e}),St=e=>Tt(mt,e),Tt=(e,t)=>({type:gt.File,layout:"simple",content:e,metadata:ar(t)}),At=e=>({type:gt.File,layout:"simple",content:e}),It=(e,t)=>({type:gt.File,layout:"advanced",parts:e,metadata:ar(t)}),Rt=e=>({type:gt.File,layout:"advanced",parts:e}),Ot=(e,t,r)=>({type:gt.File,layout:"complex",content:e,parts:t,metadata:ar(r)}),Dt=(e,t)=>({type:gt.Directory,metadata:ar(t),entries:e}),Nt=(e,t,r,n,o=vt)=>({type:gt.HAMTShard,bitfield:t,fanout:qt(r),hashType:Vt(n),entries:e,metadata:ar(o)}),jt=(e,t,r,n)=>({type:gt.HAMTShard,bitfield:t,fanout:qt(r),hashType:Vt(n),entries:e}),Pt=e=>xt({Type:gt.Raw,Data:e.byteLength>0?e:void 0,filesize:e.byteLength,blocksizes:bt},[]),zt=(e,t=!1)=>{const r=t?vt:Object(e).metadata;switch(e.layout){case"simple":return Mt(e.content,r);case"advanced":return Ut(e.parts,r);case"complex":return Ht(e.content,e.parts,r);default:throw new TypeError(`File with unknown layout "${Object(e).layout}" was passed`)}},Ft=e=>Mt(e,vt),Bt=e=>xt({Type:gt.File,blocksizes:e.map(rr),filesize:er(e)},e.map(Ct)),Ut=(e,t=vt)=>xt({Type:gt.File,blocksizes:e.map(rr),filesize:er(e),...ir(t)},e.map(Ct)),Ct=e=>({Name:"",Tsize:e.dagByteLength,Hash:e.cid}),Mt=(e,t=vt)=>xt({Type:gt.File,Data:e.byteLength>0?e:void 0,filesize:e.byteLength,blocksizes:[],...ir(t)},[]),Ht=(e,t,r=vt)=>xt({Type:gt.File,Data:e,filesize:e.byteLength+er(t),blocksizes:t.map(rr)},t.map(Ct)),Gt=e=>xt({Type:e.type,...or(e.metadata||vt)},e.entries.map(nr)),$t=({bitfield:e,fanout:t,hashType:r,entries:n,metadata:o=vt})=>xt({Type:gt.HAMTShard,Data:e.byteLength>0?e:void 0,fanout:qt(t),hashType:Vt(r),...or(o)},n.map(nr)),qt=e=>{if(Math.log2(e)%1==0)return e;throw new TypeError(`Expected hamt size to be a power of two instead got ${e}`)},Vt=e=>{if(Number.isInteger(e))return e;throw new TypeError(`Expected an integer value instead got ${e}`)},Yt=(e,t=vt)=>({type:gt.Symlink,content:e,metadata:ar(t)}),Wt=(e,t=!1)=>{const r=t?vt:Object(e).metadata;return xt({Type:gt.Symlink,Data:e.content,...ir(r||vt)},[])},Kt=(e,t=!0)=>{switch(e.type){case gt.Raw:return Pt(e.content);case gt.File:return zt(e);case gt.Directory:return Gt(e);case gt.HAMTShard:return $t(e);case gt.Symlink:return Wt(e);default:throw new Error(`Unknown node type ${Object(e).type}`)}},Jt=e=>{const t=ut(e),r=yt.decode(t.Data),{Type:n,Data:o,mtime:i,mode:a,blocksizes:s,...c}=yt.toObject(r,{defaults:!1,arrays:!0,longs:Number,objects:!1}),u={...a&&{mode:a},...Qt(i)},l=t.Links;switch(r.Type){case gt.Raw:return Lt(o);case gt.File:return 0===l.length?new fr(o,u):0===o.byteLength?new hr(Zt(c.blocksizes,l),u):new pr(o,Zt(c.blocksizes,l),u);case gt.Directory:return Dt(Xt(l),u);case gt.HAMTShard:return Nt(Xt(l),o||mt,c.fanout,c.hashType,u);case gt.Symlink:return Yt(o,u);default:throw new TypeError(`Unsupported node type ${r.Type}`)}},Qt=e=>null==e?void 0:{mtime:{secs:e.Seconds,nsecs:e.FractionalNanoseconds||0}},Zt=(e,t)=>{const r=[],n=e.length;for(;0<n;)r.push({cid:t[0].Hash,dagByteLength:t[0].Tsize||0,contentByteLength:e[0]});return r},Xt=e=>e.map((e=>({cid:e.Hash,name:e.Name||"",dagByteLength:e.Tsize||0}))),er=e=>e.reduce(((e,t)=>e+t.contentByteLength),0),tr=(e,t)=>t.reduce(((e,t)=>e+t.dagByteLength),e.byteLength),rr=e=>e.contentByteLength,nr=({name:e,dagByteLength:t,cid:r})=>({Name:e,Tsize:t,Hash:r}),or=e=>ir(e,kt),ir=({mode:e,mtime:t},r=wt)=>({mode:null!=e?cr(e,r):void 0,mtime:null!=t?sr(t):void 0}),ar=e=>null==e?vt:{...null==e.mode?void 0:{mode:ur(e.mode)},...null==e.mtime?void 0:{mtime:e.mtime}},sr=e=>null==e?void 0:0!==e.nsecs?{Seconds:e.secs,FractionalNanoseconds:e.nsecs}:{Seconds:e.secs},cr=(e,t)=>{const r=null==e?void 0:ur(e);return r===t||null==r?void 0:r},ur=e=>4095&e|4294963200&e,lr=({content:e=mt,parts:t=bt,metadata:r=vt,...n})=>0===t.length?new fr(e,r):0===e.byteLength?new hr(t,r):new pr(e,t,r);class fr{constructor(e,t){this.content=e,this.metadata=t,this.layout="simple",this.type=gt.File}get filesize(){return this.content.byteLength}encode(){return Mt(this.content,this.metadata)}}class hr{constructor(e,t){this.parts=e,this.metadata=t}get layout(){return"advanced"}get type(){return gt.File}get fileSize(){return er(this.parts)}get blockSizes(){return this.parts.map(rr)}encode(){return Ut(this.parts,this.metadata)}}class pr{constructor(e,t,r){this.content=e,this.parts=t,this.metadata=r}get layout(){return"complex"}get type(){return gt.File}get fileSize(){return this.content.byteLength+er(this.parts)}get blockSizes(){return this.parts.map(rr)}encode(){return Ht(this.content,this.parts,this.metadata)}}const dr=e=>{switch(e.type){case gt.Raw:case gt.Symlink:return e.content.byteLength;case gt.File:switch(e.layout){case"simple":return e.content.byteLength;case"advanced":return er(e.parts);case"complex":return e.content.byteLength+er(e.parts)}default:return 0}},yr=function*(e){const t=yield*e;yield*wr(t)};function*gr(){return yield Tr}const br=function*(){yield Ar};const mr=function*(e){const t=yield*gr();if(vr(e)){let r,n=!1;if(e.then((e=>{n=!1,r=e,Dr(t)}),(e=>{n=!0,r=e,Dr(t)})),yield*br(),n)throw r;return r}return Or(function*(e){Dr(e)}(t)),yield*br(),e};const vr=e=>null!=e&&"function"==typeof e.then,wr=function*(e){yield e},kr=function*(e){const t=[];for(const r of Object.entries(e)){const[e,n]=r;n!==Wr&&t.push(yield*jr(_r(n,e)))}yield*Fr(t)},Er=e=>e.length>0?function*(e){const t=[];for(const r of e)t.push(yield*jr(r));yield*Fr(t)}(e.map(yr)):Wr;const _r=(e,t)=>e===Wr?Wr:e instanceof xr?new xr([...e.tags,t],e.source):new xr([t],e);class xr{constructor(e,t){this.tags=e,this.source=t,this.controller}[Symbol.iterator](){return this.controller||(this.controller=this.source[Symbol.iterator]()),this}box(e){if(e.done)return e;switch(e.value){case Ar:case Tr:return e;default:{const t=e;let{value:r}=t;for(const e of this.tags)r=Sr(e,r);return t.value=r,t}}}next(e){return this.box(this.controller.next(e))}throw(e){return this.box(this.controller.throw(e))}return(e){return this.box(this.controller.return(e))}get[Symbol.toStringTag](){return"TaggedEffect"}}const Lr=()=>Wr,Sr=(e,t)=>({type:e,[e]:t});const Tr=Symbol("current"),Ar=Symbol("suspend");class Ir{static of(e){return e.group||Kr}static enqueue(e,t){e.group=t,t.stack.active.push(e)}constructor(e,t=[],r=new Set,n=new Rr(t,r)){this.driver=e,this.parent=Ir.of(e),this.stack=n,this.id=++Hr}}class Rr{constructor(e=[],t=new Set){this.active=e,this.idle=t}static size({active:e,idle:t}){return e.length+t.size}}const Or=e=>Dr(e[Symbol.iterator]()),Dr=e=>{let t=Ir.of(e);for(t.stack.active.push(e),t.stack.idle.delete(e);t.parent;){const{idle:e,active:r}=t.parent.stack;if(!e.has(t.driver))break;e.delete(t.driver),r.push(t.driver),t=t.parent}if(Kr.status===Gr)for(Kr.status=$r;;)try{for(const e of Nr(Kr));Kr.status=Gr;break}catch(e){Kr.stack.active.shift()}},Nr=function*(e){const{active:t}=e.stack;let r=t[0];for(e.stack.idle.delete(r);r;){let n=Vr;e:for(;!n.done&&r===t[0];){const t=n.value;switch(t){case Ar:e.stack.idle.add(r);break e;case Tr:n=r.next(r);break;default:n=r.next(yield t)}}t.shift(),r=t[0],e.stack.idle.delete(r)}};const jr=(e,t)=>new Mr(e,t),Pr=(e,t)=>zr(e,{ok:!1,error:t});function*zr(e,t){try{const r=e,n=t.ok?r.return(t.value):r.throw(t.error);if(!n.done)if(n.value===Ar){const{idle:e}=Ir.of(r).stack;e.add(r)}else Dr(r)}catch(e){}}function*Fr(e){if(0===e.length)return;const t=yield*gr(),r=new Ir(t);let n=null;for(const t of e){const{result:e}=t;e?e.ok||n||(n=e):Br(t,r)}try{if(n)throw n.error;for(;yield*Nr(r),Rr.size(r.stack)>0;)yield*br()}catch(e){for(const t of r.stack.active)yield*Pr(t,e);for(const t of r.stack.idle)yield*Pr(t,e),Dr(t);throw e}}const Br=(e,t)=>{const r=Ir.of(e);if(r!==t){const{active:n,idle:o}=r.stack,i=t.stack;if(e.group=t,o.has(e))o.delete(e),i.idle.add(e);else{const t=n.indexOf(e);t>=0&&(n.splice(t,1),i.active.push(e))}}};function*Ur(e){e.status===Gr&&(yield*e),e.result||(yield*Fr([e]));const t=e.result;if(t.ok)return t.value;throw t.error}class Cr{constructor(e){this.handler=e,this.result}get promise(){const{result:e}=this,t=null==e?new Promise(((e,t)=>{this.handler.onsuccess=e,this.handler.onfailure=t})):e.ok?Promise.resolve(e.value):Promise.reject(e.error);return Object.defineProperty(this,"promise",{value:t}),t}then(e,t){return this.activate().promise.then(e,t)}catch(e){return this.activate().promise.catch(e)}finally(e){return this.activate().promise.finally(e)}activate(){return this}}class Mr extends Cr{constructor(e,t=Yr,r={},n=Vr){super(r),this.id=++Hr,this.name=t.name||"",this.task=e,this.state=n,this.status=Gr,this.result,this.handler=r,this.controller}*resume(){Dr(this)}join(){return Ur(this)}abort(e){return Pr(this,e)}exit(e){return((e,t)=>zr(e,{ok:!0,value:t}))(this,e)}get[Symbol.toStringTag](){return"Fork"}*[Symbol.iterator](){return this.activate()}activate(){return this.controller=this.task[Symbol.iterator](),this.status=$r,Dr(this),this}panic(e){this.result={ok:!1,error:e},this.status=qr;const{handler:t}=this;throw t.onfailure&&t.onfailure(e),e}step(e){if(this.state=e,e.done){this.result={ok:!0,value:e.value},this.status=qr;const{handler:t}=this;t.onsuccess&&t.onsuccess(e.value)}return e}next(e){try{return this.step(this.controller.next(e))}catch(e){return this.panic(e)}}return(e){try{return this.step(this.controller.return(e))}catch(e){return this.panic(e)}}throw(e){try{return this.step(this.controller.throw(e))}catch(e){return this.panic(e)}}}let Hr=0;const Gr="idle",$r="active",qr="finished",Vr={done:!1,value:Tr},Yr={},Wr=function*(){}(),Kr=new class{constructor(){this.status=Gr,this.stack=new Rr,this.id=0}};function Jr(){}Object.defineProperties(Jr,{prototype:{value:new Proxy(Object.prototype,{get:(e,t,r)=>"symbol"==typeof t?Reflect.get(e,t,r):r.get(t)})}});const Qr=()=>new Xr,Zr=(e,t=0,r=e.byteLength)=>{const n=[],o=t<0?e.byteLength-t:t,i=r<0?e.byteLength-r:r;if(0===o&&i>=e.byteLength)return e;if(o>i||o>e.byteLength||i<=0)return Qr();let a=0,s=0;for(const t of e.segments){const e=s+t.byteLength;if(0===a){if(i<=e){const e=t.subarray(o-s,i-s);n.push(e),a=e.byteLength;break}if(o<e){const e=o===s?t:t.subarray(o-s);n.push(e),a=e.byteLength}}else{if(i<=e){const r=i===e?t:t.subarray(0,i-s);n.push(r),a+=r.byteLength;break}n.push(t),a+=t.byteLength}s=e}return new Xr(n,e.byteOffset+o,a)};class Xr extends Jr{constructor(e=[],t=0,r=0){super(),this.segments=e,this.byteLength=r,this.length=r,this.byteOffset=t}[Symbol.iterator](){return function*(e){for(const t of e.segments)yield*t}(this)}slice(e,t){return Zr(this,e,t)}subarray(e,t){return Zr(this,e,t)}push(e){return((e,t)=>t.byteLength>0?(e.segments.push(t),new Xr(e.segments,e.byteOffset,e.byteLength+t.byteLength)):e)(this,e)}get(e){return((e,t)=>{if(t<e.byteLength){let r=0;for(const n of e.segments){if(t<r+n.byteLength)return n[t-r];r+=n.byteLength}}})(this,e)}copyTo(e,t){return((e,t,r)=>{let n=r;for(const r of e.segments)t.set(r,n),n+=r.byteLength;return t})(this,e,t)}}const en=e=>{throw new Error(e)},tn=(e,t,...r)=>en(String.raw(e,JSON.stringify(t),...r)),rn=new Uint8Array(0),nn=[],on=e=>({config:e,buffer:Qr()}),an=(e,t,r)=>{const n=e.chunker,o=[];let i=0;for(const e of n.cut(n.context,t,r))if(e>0){const r=t.subarray(i,i+e);o.push(r),i+=e}return{config:e,chunks:o,buffer:t.subarray(i)}},sn=(e,t)=>{let r=un(t,{});for(const t of e){const{ready:e,has:n,wants:o}=pn(t.children,r.links);r=0===o.length?un(r,{links:ln(void 0,n),linked:[{id:t.id,links:e}]}):un(r,{needs:ln(t.id,o),nodes:{[t.id]:{children:t.children,count:o.length}}})}return r},cn=(e,t,r)=>{const n=r.needs[e],o=r.nodes[n];if(null!=o){if(1===o.count){const{ready:i,has:a}=pn(o.children,{...r.links,[e]:t});return un(r,{needs:{[e]:void 0},links:ln(void 0,a),nodes:{[n]:void 0},linked:[{id:n,links:i}]})}return un(r,{needs:{[e]:void 0},links:{[e]:t},nodes:{[n]:{...o,count:o.count-1}}})}return un(r,{links:{[e]:t}})},un=(e,{needs:t,nodes:r,links:n,linked:o})=>{const i=e.mutable?e:{...e},a=e.mutable?yn:void 0;return t&&(i.needs=fn(e.needs,t,a)),r&&(i.nodes=fn(e.nodes,r,a)),n&&(i.links=fn(e.links,n,a)),i.linked=o?hn(e.linked||dn,o,dn):e.linked||[],i},ln=(e,t)=>{const r={};for(const n of t)r[n]=e;return r},fn=(e,t,r=e)=>{const n=e===r?{...e}:e;for(const e of Object.entries(t)){const[t,r]=e;null==r?delete n[t]:n[t]=r}return n},hn=(e,t,r=e)=>{if(e===r)return[...e,...t];for(const r of t)e.push(r);return e},pn=(e,t)=>{const r=[],n=[],o=[];for(const i of e){const e=t[i];e?(r.push(i),o.push(e)):n.push(i)}return{has:r,wants:n,ready:o}},dn=Object.freeze([]),yn=Object.freeze({}),gn=(e,t)=>{switch(e.type){case"write":return bn(t,e.bytes);case"link":return mn(t,e.link);case"block":case"end":return{state:t,effect:Lr()};case"close":return vn(t);default:return tn`File Writer got unknown message ${e}`}},bn=(e,t)=>{if("open"===e.status){const{chunks:r,...n}=((e,t)=>t.byteLength>0?an(e.config,e.buffer.push(t),!1):{...e,chunks:nn})(e.chunker,t),{nodes:o,leaves:i,layout:a}=e.config.fileLayout.write(e.layout,r),{linked:s,...c}=sn(o,e.nodeQueue),u=[...wn(i,e.config),...En(s,e.config)];return{state:{...e,chunker:n,layout:a,nodeQueue:c},effect:kr({link:Er(u)})}}return en("Unable to perform write on closed file")},mn=(e,{id:t,link:r,block:n})=>{let{linked:o,...i}=cn(t,r,e.nodeQueue);const a=En(o,e.config),s="closed"===e.status&&t===e.rootID?{...e,status:"linked",link:r,nodeQueue:i}:{...e,nodeQueue:i},c="closed"===e.status&&t===e.rootID&&e.end?e.end.resume():Lr();return{state:s,effect:kr({link:Er(a),block:xn(e.writer,n),end:c})}},vn=e=>{if("open"===e.status){const{chunks:t}=(e=>an(e.config,e.buffer,!0))(e.chunker),{layout:r,...n}=e.config.fileLayout.write(e.layout,t),{root:o,...i}=e.config.fileLayout.close(r,e.metadata),[a,s]=Sn(o)?[[...n.nodes,...i.nodes],[...n.leaves,...i.leaves,o]]:[[...n.nodes,...i.nodes,o],[...n.leaves,...i.leaves]],{linked:c,...u}=sn(a,e.nodeQueue),l=[...wn(s,e.config),...En(c,e.config)],f=jr(br());return{state:{...e,chunker:null,layout:null,rootID:o.id,status:"closed",end:f,nodeQueue:u},effect:kr({link:Er(l),end:Ur(f)})}}return{state:e,effect:Lr()}},wn=(e,t)=>e.map((e=>kn(t,e,t.fileChunkEncoder))),kn=function*({hasher:e,linker:t},{id:r,content:n},o){const i=o.encode(n?Ln(n):rn),a=yield*mr(e.digest(i)),s=t.createLink(o.code,a);return{id:r,block:{cid:s,bytes:i},link:{cid:s,contentByteLength:n?n.byteLength:0,dagByteLength:i.byteLength}}},En=(e,t)=>e.map((e=>_n(t,e))),_n=function*(e,{id:t,links:r},n){const o=e.fileEncoder.encode({type:gt.File,layout:"advanced",parts:r,metadata:n}),i=yield*mr(Promise.resolve(e.hasher.digest(o))),a=e.linker.createLink(e.fileEncoder.code,i);return{id:t,block:{bytes:o,cid:a},link:{cid:a,contentByteLength:er(r),dagByteLength:tr(o,r)}}},xn=function*(e,t){(e.desiredSize||0)<=0&&(yield*mr(e.ready)),e.write(t)},Ln=e=>e instanceof Uint8Array?e:e.copyTo(new Uint8Array(e.byteLength),0),Sn=e=>null==e.children,Tn="fixed",An={maxChunkSize:262144},In="Stateless",Rn=e=>({type:"Stateless",context:{maxChunkSize:e},name:Tn,cut:On}),On=({maxChunkSize:e},{byteLength:t},r)=>{const n=t/e|0,o=new Array(n).fill(e),i=r?t-n*e:0;return i>0&&o.push(i),o};function Dn({name:e,code:t,encode:r}){return new Nn(e,t,r)}class Nn{name;code;encode;constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Oe(this.code,t):t.then((e=>Oe(this.code,e)))}throw Error("Unknown type, must be binary type")}}function jn(e){return async t=>new Uint8Array(await crypto.subtle.digest(e,t))}const Pn=Dn({name:"sha2-256",code:18,encode:jn("SHA-256")});Dn({name:"sha2-512",code:19,encode:jn("SHA-512")});class zn{constructor(e,t,r){this.id=e,this.children=t,this.metadata=r}}const Fn={width:174},Bn=({width:e}=Fn)=>({width:e,head:null,leafIndex:[],nodeIndex:[],lastID:0}),Un=(e,t)=>{if(0===t.length)return{layout:e,nodes:Gn,leaves:Gn};{let{lastID:r}=e;const[n,o]=e.head?[null,(t.unshift(e.head),t)]:1===t.length&&0===e.leafIndex.length?[t[0],Gn]:[null,t];if(0===o.length)return{layout:{...e,head:n},nodes:Gn,leaves:Gn};{const t=[...e.leafIndex],i=[];for(const e of o){const n={id:++r,content:e};i.push(n),t.push(n.id)}return t.length>e.width?Cn({...e,leafIndex:t,head:n,lastID:r},i):{layout:{...e,head:n,leafIndex:t,lastID:r},leaves:i,nodes:Gn}}}},Cn=(e,t=Gn,r=[],n=!1)=>{let{lastID:o}=e;const i=e.nodeIndex.map((e=>[...e])),a=[...e.leafIndex],{width:s}=e;for(;a.length>s||a.length>0&&n;){Hn(i,1);const e=new zn(++o,a.splice(0,s));i[0].push(e.id),r.push(e)}let c=0;for(;c<i.length;){const e=i[c];for(c++;e.length>s||e.length>0&&n&&c<i.length;){const t=new zn(++o,e.splice(0,s));Hn(i,c+1),i[c].push(t.id),r.push(t)}}return{layout:{...e,lastID:o,leafIndex:a,nodeIndex:i},leaves:t,nodes:r}},Mn=(e,t)=>{const r=e;if(e.head)return{root:{id:1,content:e.head,metadata:t},leaves:Gn,nodes:Gn};if(0===e.leafIndex.length)return{root:{id:1,metadata:t},leaves:Gn,nodes:Gn};{const{nodes:e,layout:n}=Cn(r,Gn,[],!0),{nodeIndex:o}=n,i=o[o.length-1];if(1===i.length){const t=e[e.length-1];return e.length=e.length-1,{root:t,nodes:e,leaves:Gn}}return{root:new zn(n.lastID+1,i,t),nodes:e,leaves:Gn}}},Hn=(e,t)=>{for(;e.length<t;)e.push([]);return e},Gn=[],$n=()=>{return{chunker:t,fileChunkEncoder:Vn,smallFileEncoder:Vn,fileEncoder:e,fileLayout:(r=174,{open:()=>Bn({width:r}),write:Un,close:Mn}),hasher:Pn,linker:{createLink:ze.createV1}};var r},qn=e=>({...$n(),...e}),Vn={code:Et,name:_t,encode:Ft},Yn=({writer:e,metadata:t={},settings:r=$n()})=>new Kn(((e,t,r)=>({status:"open",metadata:t,config:r,writer:e,chunker:on({chunker:r.chunker}),layout:r.fileLayout.open(),nodeQueue:{mutable:!0,needs:{},nodes:{},links:{},linked:dn}}))(e,t,qn(r))),Wn=(e,t)=>jr(function*(e,t){const r=yield*gr(),n=new Ir(r);for(Ir.enqueue(e[Symbol.iterator](),n);;){for(const e of Nr(n))Ir.enqueue(t(e)[Symbol.iterator](),n);if(!(Rr.size(n.stack)>0))break;yield*br()}}(t,(t=>{const{state:r,effect:n}=gn(t,e.state);return e.state=r,n})));class Kn{constructor(e){this.state=e}get writer(){return this.state.writer}get settings(){return this.state.config}write(e){return(async(e,t)=>(await Wn(e,wr({type:"write",bytes:t})),e))(this,e)}close(e){return(async(e,{releaseLock:t=!1,closeWriter:r=!1}={})=>{await Wn(e,wr({type:"close"}));const{state:n}=e;if("linked"===n.status)return r?await e.state.writer.close():t&&e.state.writer.releaseLock(),n.link;en(`Expected writer to be in 'linked' state after close, but it is in "${n.status}" instead`)})(this,e)}}const Jn=$n,Qn=({writer:e,settings:t=Jn(),metadata:r={}})=>new ro({writer:e,metadata:r,settings:t,entries:new Map,closed:!1}),Zn=(e,t,r,{overwrite:n=!1}={})=>{const o=eo(e.state);if(t.includes("/"))throw new Error(`Directory entry name "${t}" contains forbidden "/" character`);if(!n&&o.entries.has(t))throw new Error(`Directory already contains entry with name "${t}"`);return o.entries.set(t,r),e},Xn=(e,t)=>(eo(e.state).entries.delete(t),e),eo=e=>{if(e.closed)throw new Error("Can not change written directory, but you can .fork() and make changes to it");return e},to=function*({state:e}){for(const[t,{dagByteLength:r,cid:n}]of e.entries)yield{name:t,dagByteLength:r,cid:n}};class ro{constructor(e){this.state=e}get writer(){return this.state.writer}get settings(){return this.state.settings}links(){return to(this)}set(e,t,r){return Zn(this,e,t,r)}remove(e){return Xn(this,e)}fork(e){return(({state:e},{writer:t=e.writer,metadata:r=e.metadata,settings:n=e.settings}={})=>new ro({writer:t,metadata:r,settings:n,entries:new Map(e.entries.entries()),closed:!1}))(this,e)}close(e){return(async(e,{closeWriter:t=!1,releaseLock:r=!1}={})=>{const{writer:n,settings:o,metadata:i}=eo(e.state);e.state.closed=!0;const a=[...to(e)],s=Dt(a,i),c=Gt(s),u=await o.hasher.digest(c),l=o.linker.createLink(Et,u);return(n.desiredSize||0)<=0&&await n.ready,n.write({cid:l,bytes:c}),t?await n.close():r&&n.releaseLock(),{cid:l,dagByteLength:tr(c,a)}})(this,e)}entries(){return this.state.entries.entries()}has(e){return this.state.entries.has(e)}get size(){return this.state.entries.size}}const no=(e=32)=>{if(32!==e)throw new Error(`Uint32 BitField does not support size: ${e}`);return 0},oo=(e,t)=>{let r=no(t);for(const t of e)r=so(r,t);return r},io=e=>32,ao=(e,t=31)=>lo(e&((e,t)=>1<<((e,t)=>e>>>t&31)(e,t))(t,0)-1),so=(e,t)=>e|1<<t,co=(e,t)=>e&(255^1<<t),uo=(e,t)=>!!(e>>t&1),lo=e=>{const t=e-(e>>1&1431655765),r=(858993459&t)+(t>>2&858993459);return 16843009*(r+(r>>4)&252645135)>>24},fo=(e,t)=>e&t,ho=(e,t)=>e|t,po=e=>Uint8Array.of(e>>24&255,e>>16&255,e>>8&255,255&e),yo=e=>{if(4!==e.length)throw new Error(`Expected 4 bytes instead got ${e.length}`);return(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3]};var go=__webpack_require__(437);const bo=new TextEncoder,mo=go.x64.hash126,vo=({bitWidth:e=5,hash:t=mo})=>{if(e>32)throw new RangeError(`Can not use bitWidth ${e} which exceeds the hashSize 4`);const r=4294967295>>>32-e;return{at:(t,n)=>t>>>n*e&r,from:e=>t(bo.encode(e)),size:Math.ceil(32/e)}};class wo{constructor(e,t,r,n,o){this.edit=e,this.config=o,this.datamap=t,this.nodemap=r,this.children=n}get nodeArity(){return this.config.BitField.popcount(this.nodemap)}get dataArity(){return this.config.BitField.popcount(this.datamap)}empty(){return To(this.config)}lookup(e,t,r,n){return Io(this,e,t,r,n)}associate(e,t,r,n,o,i){return Oo(this,e,t,r,n,o,i)}dissociate(e,t,r,n,o){return No(this,e,t,r,n,o)}fork(e=null){return Po(this,e)}entries(){return jo(this)}keys(){return zo(this)}values(){return Fo(this)}}class ko{constructor(e,t,r,n){this.edit=e,this.count=t,this.children=r,this.config=n}get nodeArity(){return 0}get dataArity(){return this.count}lookup(e,t,r,n){return Eo(this,r,n)}associate(e,t,r,n,o,i){return _o(this,e,r,n,o,i)}dissociate(e,t,r,n,o){return xo(this,e,r,n,o)}fork(e=null){return Lo(this,e)}entries(){return jo(this)}keys(){return zo(this)}values(){return Fo(this)}}const Eo=(e,t,r)=>{const{children:n,count:o}=e,i=So(n,o,t);return n[i]===t?n[i+1]:r},_o=(e,t,r,n,o,i)=>{const{children:a,count:s}=e,c=So(a,s,n);if(a[c]!==n){const n=e.fork(t);return i.value=!0,n.count+=1,n.children.splice(c,r,o),n}if(a[c+1]!==o){const r=e.fork(t);return r.children[c+1]=o,r}return e},xo=(e,t,r,n,o)=>{const{children:i,count:a,config:s}=e,c=So(i,a,n);if(i[c]!==n)return e;if(o.value=!0,2===a){const e=0===c?2:0;return Oo(To(s),t,0,r,i[e],i[e+1],o)}{const r=e.fork(t);return r.children.splice(c,2),r.count-=1,r}},Lo=(e,t=null)=>Ko(e.edit,t)?e:new ko(t,e.count,e.children.slice(),e.config),So=(e,t,r)=>{let n=0;for(;n<t&&e[n]>r;)n+=2;return n},To=(e,t=null)=>new wo(t,e.BitField.empty(Math.pow(2,e.bitWidth)),e.BitField.empty(Math.pow(2,e.bitWidth)),[],e),Ao=(e,t,r)=>Io(e,0,e.config.Path.from(t),t,r),Io=(e,t,r,n,o)=>{const{datamap:i,nodemap:a,config:s}=e,{Path:c,BitField:u}=s,l=c.at(r,t);if(u.get(i,l)){const t=u.popcount(i,l);return Go(e,t)===n?qo(e,t):o}if(u.get(a,l)){return Yo(e,l).lookup(t+1,r,n,o)}return o},Ro=(e,t,r,n,o)=>Oo(e,t,0,e.config.Path.from(r),r,n,o),Oo=(e,t,r,n,o,i,a)=>{const{datamap:s,nodemap:c,config:u}=e,{Path:l,BitField:f}=u,h=l.at(n,r);if(f.get(s,h)){const c=f.popcount(s,h),p=Go(e,c);if(o===p)return qo(e,c)===i?e:Bo(e,t,c,i);{const s=Ho(u,t,r+1,l.from(p),p,qo(e,c),n,o,i);return a.value=!0,Mo(e,t,h,s)}}if(f.get(c,h)){const s=Yo(e,h),c=s.associate(t,r+1,n,o,i,a);return s===c?e:Co(e,t,h,c)}{const r=f.popcount(s,h);a.value=!0;const n=e.fork(t);return n.datamap=f.set(s,h),n.children.splice($o(r),0,o,i),n}},Do=(e,t,r,n)=>No(e,t,0,e.config.Path.from(r),r,n),No=(e,t,r,n,o,i)=>{const{datamap:a,nodemap:s,config:c}=e,{BitField:u,Path:l}=c,f=l.at(n,r);if(u.get(a,f)){const r=u.popcount(a,f);if(o===Go(e,r)){i.value=!0;const n=Po(e,t);return n.datamap=u.unset(e.datamap,f),n.children.splice($o(r),2),n}return e}if(u.get(s,f)){const a=Yo(e,f),s=a.dissociate(t,r+1,n,o,i);return Jo(s)?Qo(e)?s:Uo(e,t,f,s):a===s?e:Co(e,t,f,s)}return e},jo=function*({children:e}){let t=0;const r=e.length;for(;t<r;){const r=e[t];if("string"!=typeof r)break;{t+=1;const n=e[t];yield[r,n],t+=1}}for(;t<r;){const r=e[t];yield*r.entries(),t+=1}},Po=(e,t)=>{if(Ko(e.edit,t))return e;return new wo(t,e.datamap,e.nodemap,e.children.slice(),e.config)},zo=function*({children:e}){let t=0;const r=e.length;for(;t<r;){const r=e[t];if("string"!=typeof r)break;yield r,t+=2}for(;t<r;){const r=e[t];yield*r.keys(),t+=1}},Fo=function*({children:e}){let t=0;const r=e.length;for(;t<r;){if("string"!=typeof e[t])break;t+=1,yield e[t],t+=1}for(;t<r;){const r=e[t];yield*r.values(),t+=1}},Bo=(e,t,r,n)=>{const o=e.fork(t);return o.children[Vo(r)]=n,o},Uo=(e,t,r,n)=>{const{datamap:o,nodemap:i,config:a}=e,{BitField:s}=a,c=Po(e,t);return c.children.splice(Wo(e,r),1),c.children.splice($o(s.popcount(o,r)),0,n.children[0],n.children[1]),c.datamap=s.set(o,r),c.nodemap=s.unset(i,r),c},Co=(e,t,r,n)=>{const o=Po(e,t);return o.children[Wo(e,r)]=n,o},Mo=(e,t,r,n)=>{const{nodemap:o,datamap:i,config:a}=e,{BitField:s}=a,c=s.popcount(i,r),u=$o(c),l=Wo(e,r),f=Po(e,t);return f.datamap=s.unset(i,r),f.children.splice(u,2),f.nodemap=s.set(o,r),f.children.splice(l-1,0,n),f},Ho=(e,t,r,n,o,i,a,s,c)=>{const{BitField:u,Path:l}=e;if(l.size<r)return new ko(t,2,[o,i,s,c],e);{const f=l.at(n,r),h=l.at(a,r);return f===h?new wo(t,u.empty(Math.pow(2,e.bitWidth)),u.from([f],Math.pow(2,e.bitWidth)),[Ho(e,t,r+1,n,o,i,a,s,c)],e):new wo(t,u.from([f,h],Math.pow(2,e.bitWidth)),u.empty(Math.pow(2,e.bitWidth)),f<h?[o,i,s,c]:[s,c,o,i],e)}},Go=({children:e},t)=>e[$o(t)],$o=e=>2*e,qo=({children:e},t)=>e[Vo(t)],Vo=e=>2*e+1,Yo=(e,t)=>e.children[Wo(e,t)],Wo=({children:e,nodemap:t,config:r},n)=>e.length-1-r.BitField.popcount(t,n),Ko=(e,t)=>null!=e&&e===t,Jo=e=>0===e.nodeArity&&1===e.dataArity,Qo=({config:{BitField:e},datamap:t,nodemap:r})=>0===e.popcount(t)&&1===e.popcount(r);Dn({name:"murmur3-32",code:35,encode:e=>function(e){const t=new Array(4);for(let r=0;r<4;r++)t[r]=255&e,e>>=8;return new Uint8Array(t)}(go.x86.hash32(e))}),Dn({name:"murmur3-128",code:34,encode:e=>J(go.x64.hash128(e))});const Zo=Dn({name:"murmur3-x64-64",code:34,encode:e=>J(go.x64.hash128(e)).subarray(0,8)}),Xo=new TextEncoder,ei=e=>Zo.encode(e),ti=({bitWidth:e=8,hash:t=ei}={})=>{const r=t(new Uint8Array).byteLength;return{from:e=>t(Xo.encode(e)),at:(t,n)=>{const o=n*e;if(o>r)throw new RangeError("Out of bounds");return ri(t,o,e)},size:Math.ceil(8*r/e)}},ri=(e,t,r)=>{let n=t/8|0,o=t%8,i=r,a=0;for(;i>0&&n<e.byteLength;){const t=8-o,r=t<i?t:i;a=(a<<r)+((255>>o&e[n])>>8-o-r),i-=r,n++,o=0}return a},ni=(e=256)=>{if(e%8!=0)throw new Error("Must be multiple of 8");return new Uint8Array(e/8)},oi=(e,t)=>{let r=ni(t);for(const t of e){const{byte:e,byteOffset:n,bitOffset:o}=ai(r,t);r[n]=e|1<<o}return r},ii=e=>8*e.byteLength,ai=(e,t)=>{const r=e.byteLength-1-(t/8|0),n=t%8;return{byte:e[r],byteOffset:r,bitOffset:n}},si=(e,t,r)=>{if(e[t]!==r){const n=e.slice(0);return n[t]=r,n}return e},ci=(e,t)=>{const{byte:r,byteOffset:n,bitOffset:o}=ai(e,t);return si(e,n,r|1<<o)},ui=(e,t)=>{const{byte:r,byteOffset:n,bitOffset:o}=ai(e,t);return si(e,n,r&(255^1<<o))},li=(e,t)=>{var{byte:r,bitOffset:n}=ai(e,t);return!!(r>>n&1)},fi=e=>e,hi=e=>e,pi=(e,t=8*e.byteLength)=>{const{byteOffset:r,bitOffset:n,byte:o}=ai(e,t);let i=ao(o,n),a=e.byteLength-1;for(;a>r;){const t=e[a];i+=lo(t),a--}return i},di=(e,t)=>{const r=e.slice();let n=0;for(;n<e.length;)r[n]|=t[n],n++;return r},yi=(e,t)=>{const r=e.slice();let n=0;for(;n<e.length;)r[n]&=t[n],n++;return r},gi=new RangeError("Not Found"),bi=({bitWidth:e=5,BitField:t=(5===e?n:i),Path:r=(5===e?vo({bitWidth:e}):ti({bitWidth:e}))}={})=>({bitWidth:e,BitField:t,Path:r}),mi=(e,t)=>Ao(e.root,t,gi)!==gi,vi=e=>{const t={},r=bi(e);return new ki(t,0,To(r,t),r)};class wi{constructor(e=0,t,r){this.count=e,this.root=t,this.config=r}get size(){return this.count}clone(){return new wi(this.count,this.root,this.config)}empty(){return new wi(0,To(this.config,null),this.config)}has(e){return mi(this,e)}get(e){return Ao(this.root,e,void 0)}set(e,t){const r={value:!1},n=Ro(this.root,null,e,t,r);return n===this.root?this:new wi(r.value?this.count+1:this.count,n,this.config)}delete(e){const t=Do(this.root,null,e,{value:!1});return t===this.root?this:new wi(this.count-1,t,this.config)}get bitField(){return this.config.BitField.or(this.root.datamap,this.root.nodemap)}[Symbol.iterator](){return this.entries()}entries(){return this.root.entries()}keys(){return this.root.keys()}values(){return this.root.values()}createBuilder(){return new ki({},this.count,this.root,this.config)}}class ki{constructor(e,t,r,n){this.edit=e,this.count=t,this.root=r,this.config=n}get size(){if(this.edit)return this.count;throw new Error(".size was accessed on the finalized builder")}set(e,t){if(this.edit){const r={value:!1},n=Ro(this.root,this.edit,e,t,r);return this.root!==n&&(this.root=n),r.value&&(this.count+=1),this}throw new Error(".set was called on the finalized builder")}delete(e){if(this.edit){if(0===this.count)return this;const t={value:!1},r=Do(this.root,this.edit,e,t);return r!==this.root&&(this.root=r),t.value&&(this.count-=1),this}throw new Error(".delete was called on the finalized builder")}build(){if(this.edit)return this.edit=null,new wi(this.count,this.root,this.config);throw new Error(".build was called on the finalized builder")}}const Ei=new TextEncoder,_i=e=>Zo.encode(e),xi=(e,t=0,{bitWidth:r=8,hash:n,hashSize:o})=>{const i=8*o;let a=0,s=r,c=r*t;for(;s>0;){const t=c/i|0,r=n(0===t?e:Li(e,t)),o=i<=c?c%i:c,u=i-o,l=u<s?u:s;a=(a<<l)+ri(r,o,l),s-=l,c+=l}return a},Li=(e,t)=>{const r=new Uint8Array(e.byteLength+1).fill(t,e.byteLength);return r.set(e),r},Si={bitWidth:8,Path:(({bitWidth:e=8,hash:t=_i})=>{const r=t(new Uint8Array).byteLength,n={bitWidth:e,hash:t,hashSize:r};return{at:(e,t)=>xi(e,t,n),from:e=>Ei.encode(e),size:1/0}})({bitWidth:8})},Ti=(e=Si)=>vi(e),Ai=(e,t=Si)=>((e,t)=>{const r=vi(t);for(const[t,n]of e)r.set(t,n);return r.build()})(e,t),Ii=e=>{let t=0;for(;t<e.byteLength;){if(0!==e[t])return e.subarray(t);t+=1}return e.subarray(t)};function Ri({enumerable:e=!0,configurable:t=!1}={}){return{enumerable:e,configurable:t,writable:!1}}function*Oi(e,t){if(null!=t&&"object"==typeof t)if(Array.isArray(t))for(const[r,n]of t.entries()){const t=[...e,r],o=ze.asCID(n);null!=o?yield[t.join("/"),o]:"object"==typeof n&&(yield*Di(n,t))}else{const r=ze.asCID(t);null!=r?yield[e.join("/"),r]:yield*Di(t,e)}}function*Di(e,t){if(null==e||e instanceof Uint8Array)return;const r=ze.asCID(e);null!=r&&(yield[t.join("/"),r]);for(const[r,n]of Object.entries(e)){const e=[...t,r];yield*Oi(e,n)}}function*Ni(e,t){if(Array.isArray(t))for(const[r,n]of t.entries()){const t=[...e,r];yield t.join("/"),"object"==typeof n&&null==ze.asCID(n)&&(yield*ji(n,t))}else yield*ji(t,e)}function*ji(e,t){if(null!=e&&"object"==typeof e)for(const[r,n]of Object.entries(e)){const e=[...t,r];yield e.join("/"),null==n||n instanceof Uint8Array||"object"!=typeof n||null!=ze.asCID(n)||(yield*Ni(e,n))}}class Pi{cid;bytes;value;asBlock;constructor({cid:e,bytes:t,value:r}){if(null==e||null==t||void 0===r)throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=r,this.asBlock=this,Object.defineProperties(this,{cid:Ri(),bytes:Ri(),value:Ri(),asBlock:Ri()})}links(){return Di(this.value,[])}tree(){return ji(this.value,[])}get(e="/"){return function(e,t){let r=e;for(const[e,n]of t.entries()){if(r=r[n],null==r)throw new Error(`Object has no property at ${t.slice(0,e+1).map((e=>`[${JSON.stringify(e)}]`)).join("")}`);const o=ze.asCID(r);if(null!=o)return{value:o,remaining:t.slice(e+1).join("/")}}return{value:r}}(this.value,e.split("/").filter(Boolean))}}const zi=$n,Fi=async(e,{closeWriter:t=!1,releaseLock:r=!1}={})=>{const{writer:n,settings:o,metadata:i}=(e=>{if(e.closed)throw new Error("Can not change written HAMT directory, but you can .fork() and make changes to it");return e})(e.state);e.state.closed=!0;const{entries:a}=e.state;if(!(a instanceof Ci))throw new Error(`not a HAMT: ${a}`);const s=a.builder.build(),c=Bi(s,s.root,o);let u=null;for await(const e of c)u=e,(n.desiredSize||0)<=0&&await n.ready,n.write(e);if(null==u)throw new Error("no root block yielded");return t?await n.close():r&&n.releaseLock(),{cid:u.cid,dagByteLength:tr(u.bytes,u.value.entries)}},Bi=async function*(e,t,r){const n=[];for(const o of function*(e){const{config:t,datamap:r,nodemap:n}=e,{BitField:o}=t,i=o.size(r);let a=0,s=0;for(;a<i;){const t=a.toString(16).toUpperCase().padStart(2,"0");if(o.get(r,a)){const r=Go(e,s);yield{prefix:t,key:r,value:qo(e,s)},s++}else o.get(n,a)&&(yield{prefix:t,node:Yo(e,a)});a++}}(t))if("key"in o)n.push({name:`${o.prefix??""}${o.key??""}`,dagByteLength:o.value.dagByteLength,cid:o.value.cid});else{let t=null;for await(const n of Bi(e,o.node,r))yield n,t=n;if(null==t)throw new Error("no root block yielded");n.push({name:o.prefix,dagByteLength:tr(t.bytes,t.value.entries),cid:t.cid})}const o=jt(n,(({datamap:e,nodemap:t,config:{BitField:r}})=>Ii(r.toBytes(r.or(e,t))))(t),(e=>Math.pow(2,e.config.bitWidth))(e),Zo.code);yield await async function(e,t){const r=$t(e),n=await t.hasher.digest(r),o=t.linker.createLink(112,n);return new Pi({cid:o,bytes:r,value:e})}(o,r)};class Ui{constructor(e){this.state=e}get writer(){return this.state.writer}get settings(){return this.state.settings}set(e,t,r){return Zn(this,e,t,r)}remove(e){return Xn(this,e)}fork(e){return(({state:e},{writer:t=e.writer,metadata:r=e.metadata,settings:n=e.settings}={})=>new Ui({writer:t,metadata:r,settings:n,entries:new Ci(Ai(e.entries.entries()).createBuilder()),closed:!1}))(this,e)}close(e){return Fi(this,e)}entries(){return this.state.entries.entries()}has(e){return this.state.entries.has(e)}get size(){return this.state.entries.size}}class Ci extends Map{constructor(e=Ti()){super(),this.builder=e}clear(){this.builder=Ti()}delete(e){const{root:t}=this.builder;return this.builder.delete(e),this.builder.root!==t}forEach(e,t=this){for(const[r,n]of this.builder.root.entries())e.call(t,n,r,this)}get(e){return((e,t,r)=>Ao(e.root,t,r))(this.builder,e)}has(e){return mi(this.builder,e)}set(e,t){return this.builder.set(e,t),this}get size(){return this.builder.size}[Symbol.iterator](){return this.builder.root.entries()}entries(){return this.builder.root.entries()}keys(){return this.builder.root.keys()}values(){return this.builder.root.values()}}class Mi{constructor({writer:e,settings:t}){this.writer=e,this.settings=qn(t)}createFileWriter({settings:e=this.settings,metadata:t}={}){return Yn({writer:this.writer,settings:e,metadata:t})}createDirectoryWriter({settings:e=this.settings,metadata:t}={}){return Qn({writer:this.writer,settings:e,metadata:t})}close(e){return(async(e,{releaseLock:t=!0,closeWriter:r=!0}={})=>(r?await e.writer.close():t&&e.writer.releaseLock(),e))(this,e)}}const Hi="raw",Gi=85;function $i(e){return Q(e)}function qi(e){return Q(e)}const Vi=((e=104857600)=>({highWaterMark:e,size:e=>e.bytes.length}))(),Yi=qn({fileChunkEncoder:a,smallFileEncoder:a});class Wi{#e;constructor(e){this.#e=e}async finalize(e){const t=Yn(e);return await this.#e.stream().pipeTo(new WritableStream({async write(e){await t.write(e)}})),t.close()}}class Ki{entries=new Map;async finalize(e){const t=this.entries.size<=1e3?Qn(e):(({writer:e,settings:t=zi(),metadata:r={}})=>new Ui({writer:e,metadata:r,settings:t,entries:new Ci,closed:!1}))(e);for(const[r,n]of this.entries){const o=await n.finalize(e);t.set(r,o)}return t.close()}}function Ji(e,t=Yi){const r=new Ki;for(const t of e){const e=t.name.split("/");""!==e[0]&&"."!==e[0]||e.shift();let n=r;for(const[r,o]of e.entries()){if(r===e.length-1){n.entries.set(o,new Wi(t));break}let i=n.entries.get(o);if(null==i&&(i=new Ki,n.entries.set(o,i)),!(i instanceof Ki))throw new Error(`"${o}" cannot be a file and a directory`);n=i}}const{readable:n,writable:o}=new TransformStream({},Vi),i=(({writable:e,settings:t=$n()})=>new Mi({writer:e.getWriter(),settings:t}))({writable:o,settings:t});return(async()=>{await r.finalize(i),await i.close()})(),n}var Qi=__webpack_require__(203);const Zi=["string","number","bigint","symbol"],Xi=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function ea(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(Zi.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(function(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}(e))return"Buffer";const r=function(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(Xi.includes(t))return t;return}(e);return r||"Object"}class ta{constructor(e,t,r){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}ta.uint=new ta(0,"uint",!0),ta.negint=new ta(1,"negint",!0),ta.bytes=new ta(2,"bytes",!0),ta.string=new ta(3,"string",!0),ta.array=new ta(4,"array",!1),ta.map=new ta(5,"map",!1),ta.tag=new ta(6,"tag",!1),ta.float=new ta(7,"float",!0),ta.false=new ta(7,"false",!0),ta.true=new ta(7,"true",!0),ta.null=new ta(7,"null",!0),ta.undefined=new ta(7,"undefined",!0),ta.break=new ta(7,"break",!0);class ra{constructor(e,t,r){this.type=e,this.value=t,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const na=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"==typeof globalThis.Buffer.isBuffer,oa=new TextDecoder,ia=new TextEncoder;function aa(e){return na&&globalThis.Buffer.isBuffer(e)}function sa(e){return e instanceof Uint8Array?aa(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const ca=na?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):ya(e,t,r):(e,t,r)=>r-t>64?oa.decode(e.subarray(t,r)):ya(e,t,r),ua=na?e=>e.length>64?globalThis.Buffer.from(e):da(e):e=>e.length>64?ia.encode(e):da(e),la=e=>Uint8Array.from(e),fa=na?(e,t,r)=>aa(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),ha=na?(e,t)=>(e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),sa(globalThis.Buffer.concat(e,t))):(e,t)=>{const r=new Uint8Array(t);let n=0;for(let t of e)n+t.length>r.length&&(t=t.subarray(0,r.length-n)),r.set(t,n),n+=t.length;return r},pa=na?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function da(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let o=e.charCodeAt(n);o<128?t[r++]=o:o<2048?(t[r++]=o>>6|192,t[r++]=63&o|128):55296==(64512&o)&&n+1<e.length&&56320==(64512&e.charCodeAt(n+1))?(o=65536+((1023&o)<<10)+(1023&e.charCodeAt(++n)),t[r++]=o>>18|240,t[r++]=o>>12&63|128,t[r++]=o>>6&63|128,t[r++]=63&o|128):(t[r++]=o>>12|224,t[r++]=o>>6&63|128,t[r++]=63&o|128)}return t}function ya(e,t,r){const n=[];for(;t<r;){const o=e[t];let i=null,a=o>239?4:o>223?3:o>191?2:1;if(t+a<=r){let r,n,s,c;switch(a){case 1:o<128&&(i=o);break;case 2:r=e[t+1],128==(192&r)&&(c=(31&o)<<6|63&r,c>127&&(i=c));break;case 3:r=e[t+1],n=e[t+2],128==(192&r)&&128==(192&n)&&(c=(15&o)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:r=e[t+1],n=e[t+2],s=e[t+3],128==(192&r)&&128==(192&n)&&128==(192&s)&&(c=(15&o)<<18|(63&r)<<12|(63&n)<<6|63&s,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,a=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),t+=a}return function(e){const t=e.length;if(t<=ga)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=ga));return r}(n)}const ga=4096;class ba{constructor(e=256){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const r=t.length-(this.maxCursor-this.cursor)-1;t.set(e,r)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=pa(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(1===this.chunks.length){const r=this.chunks[0];e&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=fa(r,0,this.cursor)}else t=ha(this.chunks,this.cursor);return e&&this.reset(),t}}const ma="CBOR decode error:",va="CBOR encode error:",wa=[];function ka(e,t,r){if(e.length-t<r)throw new Error(`${ma} not enough data for type`)}wa[23]=1,wa[24]=2,wa[25]=3,wa[26]=5,wa[27]=9;const Ea=[24,256,65536,4294967296,BigInt("18446744073709551616")];function _a(e,t,r){ka(e,t,1);const n=e[t];if(!0===r.strict&&n<Ea[0])throw new Error(`${ma} integer encoded in more bytes than necessary (strict decode)`);return n}function xa(e,t,r){ka(e,t,2);const n=e[t]<<8|e[t+1];if(!0===r.strict&&n<Ea[1])throw new Error(`${ma} integer encoded in more bytes than necessary (strict decode)`);return n}function La(e,t,r){ka(e,t,4);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===r.strict&&n<Ea[2])throw new Error(`${ma} integer encoded in more bytes than necessary (strict decode)`);return n}function Sa(e,t,r){ka(e,t,8);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],i=(BigInt(n)<<BigInt(32))+BigInt(o);if(!0===r.strict&&i<Ea[3])throw new Error(`${ma} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(!0===r.allowBigInt)return i;throw new Error(`${ma} integers outside of the safe integer range are not supported`)}function Ta(e,t){return Aa(e,0,t.value)}function Aa(e,t,r){if(r<Ea[0]){const n=Number(r);e.push([t|n])}else if(r<Ea[1]){const n=Number(r);e.push([24|t,n])}else if(r<Ea[2]){const n=Number(r);e.push([25|t,n>>>8,255&n])}else if(r<Ea[3]){const n=Number(r);e.push([26|t,n>>>24&255,n>>>16&255,n>>>8&255,255&n])}else{const n=BigInt(r);if(!(n<Ea[4]))throw new Error(`${ma} encountered BigInt larger than allowable range`);{const r=[27|t,0,0,0,0,0,0,0];let o=Number(n&BigInt(4294967295)),i=Number(n>>BigInt(32)&BigInt(4294967295));r[8]=255&o,o>>=8,r[7]=255&o,o>>=8,r[6]=255&o,o>>=8,r[5]=255&o,r[4]=255&i,i>>=8,r[3]=255&i,i>>=8,r[2]=255&i,i>>=8,r[1]=255&i,e.push(r)}}}Ta.encodedSize=function(e){return Aa.encodedSize(e.value)},Aa.encodedSize=function(e){return e<Ea[0]?1:e<Ea[1]?2:e<Ea[2]?3:e<Ea[3]?5:9},Ta.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};const Ia=BigInt(-1),Ra=BigInt(1);function Oa(e,t){const r=t.value,n="bigint"==typeof r?r*Ia-Ra:-1*r-1;Aa(e,t.type.majorEncoded,n)}function Da(e,t,r,n){ka(e,t,r+n);const o=fa(e,t+r,t+r+n);return new ra(ta.bytes,o,r+n)}function Na(e,t,r,n){return Da(e,t,1,r)}function ja(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===ta.string?ua(e.value):e.value),e.encodedBytes}function Pa(e,t){const r=ja(t);Aa(e,t.type.majorEncoded,r.length),e.push(r)}function za(e,t,r,n,o){const i=r+n;ka(e,t,i);const a=new ra(ta.string,ca(e,t+r,t+i),i);return!0===o.retainStringBytes&&(a.byteValue=fa(e,t+r,t+i)),a}function Fa(e,t,r,n){return za(e,t,1,r,n)}Oa.encodedSize=function(e){const t=e.value,r="bigint"==typeof t?t*Ia-Ra:-1*t-1;return r<Ea[0]?1:r<Ea[1]?2:r<Ea[2]?3:r<Ea[3]?5:9},Oa.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},Pa.encodedSize=function(e){const t=ja(e);return Aa.encodedSize(t.length)+t.length},Pa.compareTokens=function(e,t){return r=ja(e),n=ja(t),r.length<n.length?-1:r.length>n.length?1:function(e,t){if(aa(e)&&aa(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}(r,n);var r,n};const Ba=Pa;function Ua(e,t,r,n){return new ra(ta.array,n,r)}function Ca(e,t,r,n){return Ua(0,0,1,r)}function Ma(e,t){Aa(e,ta.array.majorEncoded,t.value)}function Ha(e,t,r,n){return new ra(ta.map,n,r)}function Ga(e,t,r,n){return Ha(0,0,1,r)}function $a(e,t){Aa(e,ta.map.majorEncoded,t.value)}function qa(e,t,r,n){return new ra(ta.tag,r,1)}function Va(e,t){Aa(e,ta.tag.majorEncoded,t.value)}Ma.compareTokens=Ta.compareTokens,Ma.encodedSize=function(e){return Aa.encodedSize(e.value)},$a.compareTokens=Ta.compareTokens,$a.encodedSize=function(e){return Aa.encodedSize(e.value)},Va.compareTokens=Ta.compareTokens,Va.encodedSize=function(e){return Aa.encodedSize(e.value)};const Ya=20,Wa=21,Ka=22,Ja=23;function Qa(e,t,r){if(r){if(!1===r.allowNaN&&Number.isNaN(e))throw new Error(`${ma} NaN values are not supported`);if(!1===r.allowInfinity&&(e===1/0||e===-1/0))throw new Error(`${ma} Infinity values are not supported`)}return new ra(ta.float,e,t)}function Za(e,t,r){const n=t.value;if(!1===n)e.push([ta.float.majorEncoded|Ya]);else if(!0===n)e.push([ta.float.majorEncoded|Wa]);else if(null===n)e.push([ta.float.majorEncoded|Ka]);else if(void 0===n)e.push([ta.float.majorEncoded|Ja]);else{let t,i=!1;r&&!0===r.float64||(rs(n),t=ns(ts,1),n===t||Number.isNaN(n)?(ts[0]=249,e.push(ts.slice(0,3)),i=!0):(os(n),t=is(ts,1),n===t&&(ts[0]=250,e.push(ts.slice(0,5)),i=!0))),i||(o=n,es.setFloat64(0,o,!1),t=as(ts,1),ts[0]=251,e.push(ts.slice(0,9)))}var o}Za.encodedSize=function(e,t){const r=e.value;if(!1===r||!0===r||null==r)return 1;if(!t||!0!==t.float64){rs(r);let e=ns(ts,1);if(r===e||Number.isNaN(r))return 3;if(os(r),e=is(ts,1),r===e)return 5}return 9};const Xa=new ArrayBuffer(9),es=new DataView(Xa,1),ts=new Uint8Array(Xa,0);function rs(e){if(e===1/0)es.setUint16(0,31744,!1);else if(e===-1/0)es.setUint16(0,64512,!1);else if(Number.isNaN(e))es.setUint16(0,32256,!1);else{es.setFloat32(0,e);const t=es.getUint32(0),r=(2139095040&t)>>23,n=8388607&t;if(255===r)es.setUint16(0,31744,!1);else if(0===r)es.setUint16(0,(2147483648&e)>>16|n>>13,!1);else{const e=r-127;e<-24?es.setUint16(0,0):e<-14?es.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):es.setUint16(0,(2147483648&t)>>16|e+15<<10|n>>13,!1)}}}function ns(e,t){if(e.length-t<2)throw new Error(`${ma} not enough data for float16`);const r=(e[t]<<8)+e[t+1];if(31744===r)return 1/0;if(64512===r)return-1/0;if(32256===r)return NaN;const n=r>>10&31,o=1023&r;let i;return i=0===n?o*2**-24:31!==n?(o+1024)*2**(n-25):0===o?1/0:NaN,32768&r?-i:i}function os(e){es.setFloat32(0,e,!1)}function is(e,t){if(e.length-t<4)throw new Error(`${ma} not enough data for float32`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function as(e,t){if(e.length-t<8)throw new Error(`${ma} not enough data for float64`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}function ss(e,t,r){throw new Error(`${ma} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function cs(e){return()=>{throw new Error(`${ma} ${e}`)}}Za.compareTokens=Ta.compareTokens;const us=[];for(let e=0;e<=23;e++)us[e]=ss;us[24]=function(e,t,r,n){return new ra(ta.uint,_a(e,t+1,n),2)},us[25]=function(e,t,r,n){return new ra(ta.uint,xa(e,t+1,n),3)},us[26]=function(e,t,r,n){return new ra(ta.uint,La(e,t+1,n),5)},us[27]=function(e,t,r,n){return new ra(ta.uint,Sa(e,t+1,n),9)},us[28]=ss,us[29]=ss,us[30]=ss,us[31]=ss;for(let e=32;e<=55;e++)us[e]=ss;us[56]=function(e,t,r,n){return new ra(ta.negint,-1-_a(e,t+1,n),2)},us[57]=function(e,t,r,n){return new ra(ta.negint,-1-xa(e,t+1,n),3)},us[58]=function(e,t,r,n){return new ra(ta.negint,-1-La(e,t+1,n),5)},us[59]=function(e,t,r,n){const o=Sa(e,t+1,n);if("bigint"!=typeof o){const e=-1-o;if(e>=Number.MIN_SAFE_INTEGER)return new ra(ta.negint,e,9)}if(!0!==n.allowBigInt)throw new Error(`${ma} integers outside of the safe integer range are not supported`);return new ra(ta.negint,Ia-BigInt(o),9)},us[60]=ss,us[61]=ss,us[62]=ss,us[63]=ss;for(let e=64;e<=87;e++)us[e]=Na;us[88]=function(e,t,r,n){return Da(e,t,2,_a(e,t+1,n))},us[89]=function(e,t,r,n){return Da(e,t,3,xa(e,t+1,n))},us[90]=function(e,t,r,n){return Da(e,t,5,La(e,t+1,n))},us[91]=function(e,t,r,n){const o=Sa(e,t+1,n);if("bigint"==typeof o)throw new Error(`${ma} 64-bit integer bytes lengths not supported`);return Da(e,t,9,o)},us[92]=ss,us[93]=ss,us[94]=ss,us[95]=cs("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)us[e]=Fa;us[120]=function(e,t,r,n){return za(e,t,2,_a(e,t+1,n),n)},us[121]=function(e,t,r,n){return za(e,t,3,xa(e,t+1,n),n)},us[122]=function(e,t,r,n){return za(e,t,5,La(e,t+1,n),n)},us[123]=function(e,t,r,n){const o=Sa(e,t+1,n);if("bigint"==typeof o)throw new Error(`${ma} 64-bit integer string lengths not supported`);return za(e,t,9,o,n)},us[124]=ss,us[125]=ss,us[126]=ss,us[127]=cs("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)us[e]=Ca;us[152]=function(e,t,r,n){return Ua(0,0,2,_a(e,t+1,n))},us[153]=function(e,t,r,n){return Ua(0,0,3,xa(e,t+1,n))},us[154]=function(e,t,r,n){return Ua(0,0,5,La(e,t+1,n))},us[155]=function(e,t,r,n){const o=Sa(e,t+1,n);if("bigint"==typeof o)throw new Error(`${ma} 64-bit integer array lengths not supported`);return Ua(0,0,9,o)},us[156]=ss,us[157]=ss,us[158]=ss,us[159]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${ma} indefinite length items not allowed`);return Ua(0,0,1,1/0)};for(let e=160;e<=183;e++)us[e]=Ga;us[184]=function(e,t,r,n){return Ha(0,0,2,_a(e,t+1,n))},us[185]=function(e,t,r,n){return Ha(0,0,3,xa(e,t+1,n))},us[186]=function(e,t,r,n){return Ha(0,0,5,La(e,t+1,n))},us[187]=function(e,t,r,n){const o=Sa(e,t+1,n);if("bigint"==typeof o)throw new Error(`${ma} 64-bit integer map lengths not supported`);return Ha(0,0,9,o)},us[188]=ss,us[189]=ss,us[190]=ss,us[191]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${ma} indefinite length items not allowed`);return Ha(0,0,1,1/0)};for(let e=192;e<=215;e++)us[e]=qa;us[216]=function(e,t,r,n){return new ra(ta.tag,_a(e,t+1,n),2)},us[217]=function(e,t,r,n){return new ra(ta.tag,xa(e,t+1,n),3)},us[218]=function(e,t,r,n){return new ra(ta.tag,La(e,t+1,n),5)},us[219]=function(e,t,r,n){return new ra(ta.tag,Sa(e,t+1,n),9)},us[220]=ss,us[221]=ss,us[222]=ss,us[223]=ss;for(let e=224;e<=243;e++)us[e]=cs("simple values are not supported");us[244]=ss,us[245]=ss,us[246]=ss,us[247]=function(e,t,r,n){if(!1===n.allowUndefined)throw new Error(`${ma} undefined values are not supported`);return!0===n.coerceUndefinedToNull?new ra(ta.null,null,1):new ra(ta.undefined,void 0,1)},us[248]=cs("simple values are not supported"),us[249]=function(e,t,r,n){return Qa(ns(e,t+1),3,n)},us[250]=function(e,t,r,n){return Qa(is(e,t+1),5,n)},us[251]=function(e,t,r,n){return Qa(as(e,t+1),9,n)},us[252]=ss,us[253]=ss,us[254]=ss,us[255]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${ma} indefinite length items not allowed`);return new ra(ta.break,void 0,1)};const ls=[];for(let e=0;e<24;e++)ls[e]=new ra(ta.uint,e,1);for(let e=-1;e>=-24;e--)ls[31-e]=new ra(ta.negint,e,1);ls[64]=new ra(ta.bytes,new Uint8Array(0),1),ls[96]=new ra(ta.string,"",1),ls[128]=new ra(ta.array,0,1),ls[160]=new ra(ta.map,0,1),ls[244]=new ra(ta.false,!1,1),ls[245]=new ra(ta.true,!0,1),ls[246]=new ra(ta.null,null,1);const fs={float64:!1,mapSorter:function(e,t){const r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);const o=r.type.major,i=hs[o].compareTokens(r,n);0===i&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone");return i},quickEncodeToken:function(e){switch(e.type){case ta.false:return la([244]);case ta.true:return la([245]);case ta.null:return la([246]);case ta.bytes:return e.value.length?void 0:la([64]);case ta.string:return""===e.value?la([96]):void 0;case ta.array:return 0===e.value?la([128]):void 0;case ta.map:return 0===e.value?la([160]):void 0;case ta.uint:return e.value<24?la([Number(e.value)]):void 0;case ta.negint:if(e.value>=-24)return la([31-Number(e.value)])}}};const hs=function(){const e=[];return e[ta.uint.major]=Ta,e[ta.negint.major]=Oa,e[ta.bytes.major]=Pa,e[ta.string.major]=Ba,e[ta.array.major]=Ma,e[ta.map.major]=$a,e[ta.tag.major]=Va,e[ta.float.major]=Za,e}(),ps=new ba;class ds{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${va} object contains circular references`);return new ds(t,e)}}const ys={null:new ra(ta.null,null),undefined:new ra(ta.undefined,void 0),true:new ra(ta.true,!0),false:new ra(ta.false,!1),emptyArray:new ra(ta.array,0),emptyMap:new ra(ta.map,0)},gs={number:(e,t,r,n)=>Number.isInteger(e)&&Number.isSafeInteger(e)?new ra(e>=0?ta.uint:ta.negint,e):new ra(ta.float,e),bigint:(e,t,r,n)=>e>=BigInt(0)?new ra(ta.uint,e):new ra(ta.negint,e),Uint8Array:(e,t,r,n)=>new ra(ta.bytes,e),string:(e,t,r,n)=>new ra(ta.string,e),boolean:(e,t,r,n)=>e?ys.true:ys.false,null:(e,t,r,n)=>ys.null,undefined:(e,t,r,n)=>ys.undefined,ArrayBuffer:(e,t,r,n)=>new ra(ta.bytes,new Uint8Array(e)),DataView:(e,t,r,n)=>new ra(ta.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),Array(e,t,r,n){if(!e.length)return!0===r.addBreakTokens?[ys.emptyArray,new ra(ta.break)]:ys.emptyArray;n=ds.createCheck(n,e);const o=[];let i=0;for(const t of e)o[i++]=bs(t,r,n);return r.addBreakTokens?[new ra(ta.array,e.length),o,new ra(ta.break)]:[new ra(ta.array,e.length),o]},Object(e,t,r,n){const o="Object"!==t,i=o?e.keys():Object.keys(e),a=o?e.size:i.length;if(!a)return!0===r.addBreakTokens?[ys.emptyMap,new ra(ta.break)]:ys.emptyMap;n=ds.createCheck(n,e);const s=[];let c=0;for(const t of i)s[c++]=[bs(t,r,n),bs(o?e.get(t):e[t],r,n)];return function(e,t){t.mapSorter&&e.sort(t.mapSorter)}(s,r),r.addBreakTokens?[new ra(ta.map,a),s,new ra(ta.break)]:[new ra(ta.map,a),s]}};gs.Map=gs.Object,gs.Buffer=gs.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))gs[`${e}Array`]=gs.DataView;function bs(e,t={},r){const n=ea(e),o=t&&t.typeEncoders&&t.typeEncoders[n]||gs[n];if("function"==typeof o){const i=o(e,n,t,r);if(null!=i)return i}const i=gs[n];if(!i)throw new Error(`${va} unsupported type: ${n}`);return i(e,n,t,r)}function ms(e,t,r,n){if(Array.isArray(t))for(const o of t)ms(e,o,r,n);else r[t.type.major](e,t,n)}function vs(e,t,r){const n=bs(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){const e=r.quickEncodeToken(n);if(e)return e;const o=t[n.type.major];if(o.encodedSize){const e=o.encodedSize(n,r),t=new ba(e);if(o(t,n,r),1!==t.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return sa(t.chunks[0])}}return ps.reset(),ms(ps,n,t,r),ps.toBytes(!0)}Symbol.for("DONE"),Symbol.for("BREAK");const ws={float64:!0,typeEncoders:{Object:function(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const t=ze.asCID(e);if(!t)return null;const r=new Uint8Array(t.bytes.byteLength+1);return r.set(t.bytes,1),[new ra(ta.tag,42),new ra(ta.bytes,r)]},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}};const ks={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};ks.tags[42]=function(e){if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return ze.decode(e.subarray(1))};ks.tags.slice();const Es=e=>{return t=e,r=ws,r=Object.assign({},fs,r),vs(t,hs,r);var t,r};class _s extends TransformStream{constructor(e=[]){super({start:t=>t.enqueue(function(e){const t=Es({version:1,roots:e}),r=Qi.encode(t.length),n=new Uint8Array(r.length+t.length);return n.set(r,0),n.set(t,r.length),n}(e)),transform:(e,t)=>{t.enqueue(function(e){const t=Qi.encode(e.cid.bytes.length+e.bytes.length),r=new Uint8Array(t.length+e.cid.bytes.length+e.bytes.length);return r.set(t),r.set(e.cid.bytes,t.length),r.set(e.bytes,t.length+e.cid.bytes.length),r}(e)),this.finalBlock=e}}),this.finalBlock=null}}function xs(e){return xs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xs(e)}function Ls(e,t,r){return(t=Ds(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ss(e){return function(e){if(Array.isArray(e))return Ts(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ts(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ts(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ts(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function As(){As=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),s=new R(n||[]);return o(a,"_invoke",{value:S(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",g={};function b(){}function m(){}function v(){}var w={};u(w,a,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(O([])));E&&E!==r&&n.call(E,a)&&(w=E);var _=v.prototype=b.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function r(o,i,a,s){var c=f(e[o],e,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==xs(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function S(t,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=T(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function T(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,T(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function O(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(xs(t)+" is not iterable")}return m.prototype=v,o(_,"constructor",{value:v,configurable:!0}),o(v,"constructor",{value:m,configurable:!0}),m.displayName=u(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,u(e,c,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},x(L.prototype),u(L.prototype,s,(function(){return this})),t.AsyncIterator=L,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(_),u(_,c,"Generator"),u(_,a,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=O,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),I(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:O(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function Is(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function Rs(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Is(i,n,o,a,s,"next",e)}function s(e){Is(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Os(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ds(n.key),n)}}function Ds(e){var t=function(e,t){if("object"!=xs(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=xs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==xs(t)?t:t+""}var Ns=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Http=t,this.report=new P(this.Http)},t=[{key:"getUploadAddresses",value:(y=Rs(As().mark((function e(){var t;return As().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.Http.getData("/api/v1/storage/get_upload_info?t="+(new Date).getTime()+"&need_trace=true");case 3:return t=e.sent,e.abrupt("return",t.data);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",u({code:s.FAILURE,msg:e.t0}));case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return y.apply(this,arguments)})},{key:"getTempFileUploadAddresses",value:(d=Rs(As().mark((function e(){var t;return As().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.Http.getData("/api/v1/storage/temp_file/get_upload_file?t="+(new Date).getTime()+"&need_trace=true");case 3:return t=e.sent,e.abrupt("return",t.data);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",u({code:s.FAILURE,msg:e.t0}));case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return d.apply(this,arguments)})},{key:"createAsset",value:(p=Rs(As().mark((function e(t){var r;return As().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.Http.postData("/api/v1/storage/create_asset",t);case 3:return r=e.sent,e.abrupt("return",r);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",u({code:s.FAILURE,msg:e.t0}));case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e){return p.apply(this,arguments)})},{key:"tempFileUpload",value:(h=Rs(As().mark((function e(t){var r;return As().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.Http.postData("/api/v1/storage/temp_file/upload",t);case 3:return c(88888,r=e.sent),e.abrupt("return",r);case 8:return e.prev=8,e.t0=e.catch(0),c(333,e.t0),e.abrupt("return",u({code:s.FAILURE,msg:e.t0}));case 12:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(e){return h.apply(this,arguments)})},{key:"uploadBlobToAddresses",value:(f=Rs(As().mark((function e(t,r,n,o){var i,a,c,u,l,f,h,p,d=this;return As().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new Map,a=[],c=!1,u=[],l=function(){return a.forEach((function(e){e.signal.aborted||e.abort()}))},f=n.map((function(e,n){var s=new AbortController;a.push(s);var f=Date.now(),h=new URL(e.CandidateAddr).hostname.split(".")[0];return d.uploadFile(e.CandidateAddr,e.Token,r,s.signal,(function(e,t,r){i.set(n,r);var a=i.size>0?Math.max.apply(Math,Ss(i.values())):0;o&&o(e,t,a)})).then((function(r){var n,o,i=Date.now()-f,a=Math.floor((null!==(n=t.asset_size)&&void 0!==n?n:0)/i*1e3);if(u.push({status:0==r.code?1:2,msg:r.msg,elapsedTime:i,transferRate:a,size:null!==(o=t.asset_size)&&void 0!==o?o:0,traceId:e.TraceID,nodeId:h,cId:t.asset_cid,log:0==r.code?"":Ls({},h,r.msg)}),!c)return c=!0,l(),r})).catch((function(r){var n;return u.push({status:2,msg:r,elapsedTime:0,transferRate:0,size:null!==(n=t.asset_size)&&void 0!==n?n:0,traceId:e.TraceID,nodeId:h,cId:null,log:Ls({},h,r)}),Promise.reject(r)}))})),e.prev=6,e.next=9,Promise.any(f);case 9:return p=e.sent,this.report.creatReportData(u,"upload"),p.cId=null!==(h=t.asset_cid)&&void 0!==h?h:"",e.abrupt("return",p);case 15:return e.prev=15,e.t0=e.catch(6),this.report.creatReportData(u,"upload"),e.abrupt("return",{code:s.UPLOAD_FILE_ERROR,msg:"All upload addresses failed."});case 19:case"end":return e.stop()}}),e,this,[[6,15]])}))),function(e,t,r,n){return f.apply(this,arguments)})},{key:"uploadFile",value:(l=Rs(As().mark((function e(t,r,n,o,i){var a;return As().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.Http.uploadFile(t,r,n,null,i,o);case 3:if(0===(a=e.sent).code){e.next=6;break}return e.abrupt("return",u({code:a.code,msg:"Failed to upload file: "+a.msg}));case 6:return e.abrupt("return",a);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",u({code:s.FAILURE,msg:"Failed to upload file: "+e.t0}));case 12:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e,t,r,n,o){return l.apply(this,arguments)})},{key:"onFileUpload",value:(a=Rs(As().mark((function e(t){var r,n,o,i,a,c,l,f,h,p,d,y,g,k,E,_,x,L=arguments;return As().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=L.length>1&&void 0!==L[1]?L[1]:{areaId:[],groupId:0,assetType:0,extraId:"",retryCount:2},n=L.length>2?L[2]:void 0,o=L.length>3?L[3]:void 0,e.prev=3,i=r.areaId,a=void 0===i?[]:i,c=r.groupId,l=void 0===c?0:c,f=r.assetType,h=void 0===f?0:f,p=r.extraId,d=void 0===p?"":p,y=r.retryCount,g=void 0===y?2:y,!(k=b(a))){e.next=8;break}return e.abrupt("return",k);case 8:if(!(E=m(l))){e.next=11;break}return e.abrupt("return",E);case 11:if(!(_=v(h))){e.next=14;break}return e.abrupt("return",_);case 14:if(-1!=l){e.next=18;break}if(!(x=w(t.size))){e.next=18;break}return e.abrupt("return",x);case 18:if(0!==h){e.next=24;break}return e.next=21,this.handleFileUpload(t,a,l,d,g,n);case 21:case 26:return e.abrupt("return",e.sent);case 24:return e.next=26,this.handleFolderUpload(t,a,l,d,g,n,o);case 27:e.next=32;break;case 29:return e.prev=29,e.t0=e.catch(3),e.abrupt("return",u({code:s.FAILURE,msg:"Failed to upload file: "+JSON.stringify(e.t0)}));case 32:case"end":return e.stop()}}),e,this,[[3,29]])}))),function(e){return a.apply(this,arguments)})},{key:"handleFileUpload",value:(i=Rs(As().mark((function e(t,r,n,o){var i,a,c,l,f,h,p,d,y,g,b,m,v,w,k,E=this,_=arguments;return As().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=_.length>4&&void 0!==_[4]?_[4]:2,c=_.length>5?_[5]:void 0,-1!=n){e.next=8;break}return e.next=5,this.getTempFileUploadAddresses();case 5:l=e.sent,e.next=11;break;case 8:return e.next=10,this.getUploadAddresses();case 10:l=e.sent;case 11:return f=l.List,h=null!==(i=l.TraceID)&&void 0!==i?i:"",p=new Map,d=[],y=!1,g=[],b=function(){return d.forEach((function(e){return e.abort()}))},m=function(e){return new Promise((function(t){return setTimeout(t,e)}))},v=function(){var e=Rs(As().mark((function e(i,s,l){var f,w,k,_,x,L,S,T;return As().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=new AbortController,d.push(f),w=Date.now(),k=i.NodeID.replace(/^c_/,""),e.prev=4,e.next=7,E.uploadFile(i.UploadURL,i.Token,t,f.signal,(function(e,t,r){p.set(s,r);var n=p.size>0?Math.max.apply(Math,Ss(p.values())):0;c&&c(e,t,n)}));case 7:if(_=e.sent,x=Date.now(),L=x-w,S=Math.floor(t.size/L*1e3),g.push({status:0==_.code?1:2,msg:_.msg,elapsedTime:L,transferRate:S,size:t.size,traceId:h,nodeId:k,cId:_.cid,log:0==_.code?"":Ls({},k,_.msg)}),0!==_.code){e.next=28;break}if(y){e.next=26;break}if(y=!0,b(),-1==n){e.next=25;break}return e.next=19,E.createAsset({asset_name:t.name,asset_type:"file",asset_size:t.size,area_id:r,group_id:n,asset_cid:_.cid,node_id:i.NodeID,extra_id:o});case 19:if(1017!=e.sent.err){e.next=22;break}return e.abrupt("return",u({code:0,data:{cid:_.cid}}));case 22:case 25:return e.abrupt("return",u({code:0,msg:"Upload success",data:{cid:_.cid}}));case 26:e.next=29;break;case 28:return e.abrupt("return",u({code:_.code,msg:_.msg,data:{cid:_.cid}}));case 29:e.next=40;break;case 31:if(e.prev=31,e.t0=e.catch(4),!(l>0)){e.next=38;break}return T=1e3*(a-l+1),e.next=37,m(T);case 37:return e.abrupt("return",v(i,s,l-1));case 38:return g.push({status:2,msg:e.t0.message||"Unknown error",elapsedTime:0,transferRate:0,size:t.size,traceId:h,nodeId:k,cId:null,log:Ls({},k,e.t0.message)}),e.abrupt("return",Promise.reject(e.t0));case 40:case"end":return e.stop()}}),e,null,[[4,31]])})));return function(t,r,n){return e.apply(this,arguments)}}(),w=f.map((function(e,t){return v(e,t,a)})),e.prev=21,e.next=24,Promise.any(w);case 24:return k=e.sent,this.report.creatReportData(g,"upload"),e.abrupt("return",k);case 29:return e.prev=29,e.t0=e.catch(21),this.report.creatReportData(g,"upload"),e.abrupt("return",u({code:s.UPLOAD_FILE_ERROR,msg:"All upload addresses failed."}));case 33:case"end":return e.stop()}}),e,this,[[21,29]])}))),function(e,t,r,n){return i.apply(this,arguments)})},{key:"handleFolderUpload",value:(o=Rs(As().mark((function e(t,r,n,o){var i,a,c,l,f,h,p,d=this,y=arguments;return As().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=y.length>4&&void 0!==y[4]?y[4]:2,a=y.length>5?y[5]:void 0,c=y.length>6?y[6]:void 0,p=new Promise((function(e,p){var y;Ji(t).pipeThrough(new TransformStream({transform:function(e,t){f=e.cid,t.enqueue(e)}})).pipeThrough(new _s).pipeTo(new WritableStream({write:function(e){if(l){var t=new Uint8Array(l.length+e.length);t.set(l),t.set(e,l.length),l=t}else l=e;c&&c("writing")},close:(y=Rs(As().mark((function s(){var y,g,b,m,v;return As().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(s.prev=0,c&&c("close"),h=new Blob([l]),y=t[0].webkitRelativePath.split("/")[0],g={asset_name:y,asset_type:"folder",asset_size:h.size,area_id:r,group_id:n,asset_cid:f.toString(),extra_id:o,need_trace:!0},-1==n){s.next=17;break}return s.next=8,d.createAsset(g);case 8:if(0!==(b=s.sent).code){s.next=14;break}return s.next=12,d.uploadToAddresses(h,g,b.data,a,i,e,p,c);case 12:s.next=15;break;case 14:1017==b.err?e(u({code:0,msg:"Upload success",data:{cid:f.toString()}})):e(u({code:b.code,msg:null!==(m=b.msg)&&void 0!==m?m:""}));case 15:s.next=26;break;case 17:return s.next=19,d.tempFileUpload(g);case 19:if(0!==(v=s.sent).code){s.next=25;break}return s.next=23,d.uploadToAddresses(h,g,v.data,a,i,e,p,c);case 23:s.next=26;break;case 25:e(u({code:v.code,msg:v.msg}));case 26:s.next=31;break;case 28:s.prev=28,s.t0=s.catch(0),p(u({code:-1,msg:s.t0}));case 31:case"end":return s.stop()}}),s,null,[[0,28]])}))),function(){return y.apply(this,arguments)}),abort:function(e){c&&c("abort"),p(u({code:s.UPLOAD_FILE_ERROR,msg:e}))}})).catch((function(e){p(u({code:s.UPLOAD_FILE_ERROR,msg:e}))}))})),e.next=6,p;case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)}))),function(e,t,r,n){return o.apply(this,arguments)})},{key:"uploadToAddresses",value:(n=Rs(As().mark((function e(t,r,n,o,i,a,s,c){var l;return As().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.uploadBlobToAddresses(r,t,n,o);case 3:if(0!==(l=e.sent).code){e.next=8;break}a(u({code:0,msg:l.msg,data:{cid:l.cid}})),e.next=14;break;case 8:if(!(i>0)){e.next=13;break}return e.next=11,this.uploadToAddresses(t,r,n,o,i-1,a,s,c);case 11:e.next=14;break;case 13:s(u({code:-1,msg:"File upload failed after multiple attempts"}));case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),s(u({code:-1,msg:e.t0}));case 19:case"end":return e.stop()}}),e,this,[[0,16]])}))),function(e,t,r,o,i,a,s,c){return n.apply(this,arguments)})}],t&&Os(e.prototype,t),r&&Os(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,n,o,i,a,l,f,h,p,d,y}();const js=Ns;function Ps(){Ps=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),s=new R(n||[]);return o(a,"_invoke",{value:S(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",g={};function b(){}function m(){}function v(){}var w={};u(w,a,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(O([])));E&&E!==r&&n.call(E,a)&&(w=E);var _=v.prototype=b.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function r(o,i,a,s){var c=f(e[o],e,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==zs(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function S(t,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=T(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function T(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,T(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function O(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(zs(t)+" is not iterable")}return m.prototype=v,o(_,"constructor",{value:v,configurable:!0}),o(v,"constructor",{value:m,configurable:!0}),m.displayName=u(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,u(e,c,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},x(L.prototype),u(L.prototype,s,(function(){return this})),t.AsyncIterator=L,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(_),u(_,c,"Generator"),u(_,a,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=O,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),I(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:O(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function zs(e){return zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zs(e)}function Fs(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function Bs(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Fs(i,n,o,a,s,"next",e)}function s(e){Fs(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Us(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cs(n.key),n)}}function Cs(e){var t=function(e,t){if("object"!=zs(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=zs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==zs(t)?t:t+""}var Ms=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Http=t},t=[{key:"onShare",value:(i=Bs(Ps().mark((function e(){var t,r,n,o,i,a,c,l,f,h,p,d,y,g,b,m,v,w,k,E,_=arguments;return Ps().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=_.length>0&&void 0!==_[0]?_[0]:{id:null,expireAt:null,shortPass:"",hasDay:!1,hasDomain:!0},e.prev=1,"object"===zs(t)&&null!==t){e.next=4;break}return e.abrupt("return",u({code:s.ASSET_OBJ_ERROR}));case 4:if(r=t.id,n=t.expireAt,o=t.shortPass,i=t.hasDay,a=t.hasDomain,c=void 0===a||a,r){e.next=7;break}return e.abrupt("return",u({code:s.ID_KEY_EMPTY}));case 7:return l=/^\d+$/.test(r),f=l?"groupid=".concat(r):"cid=".concat(r),e.next=11,this.Http.getData("/api/v1/storage/get_asset_group_info?".concat(f));case 11:if((h=e.sent)&&0===h.code&&h.data){e.next=14;break}return e.abrupt("return",u({code:s.REQUEST_ERROR}));case 14:if(!l){e.next=24;break}if(m=h.data.data.Group){e.next=18;break}return e.abrupt("return",u({code:s.REQUEST_ERROR}));case 18:p=m.ShareStatus,d=m.UserID,y=m.ID,g="folder",e.next=32;break;case 24:if((v=h.data.data.AssetOverview)&&v.UserAssetDetail&&v.AssetRecord){e.next=27;break}return e.abrupt("return",u({code:s.REQUEST_ERROR,msg:"AssetOverview data is incomplete."}));case 27:p=v.UserAssetDetail.ShareStatus,d=v.UserAssetDetail.UserID,y=v.AssetRecord.CID,g=v.UserAssetDetail.AssetType,b=v.UserAssetDetail.area_ids;case 32:if(0!==p){e.next=40;break}return w={isNumeric:l,UserID:d,Cid:y,AssetType:g,expireAt:n,shortPass:o,area_ids:b,hasDay:i,hasDomain:c},e.next=36,this.onCreateShareLink(w);case 36:return k=e.sent,e.abrupt("return",k);case 40:return e.next=42,this.onUpdateShareLink(d,y,n,o,i,c);case 42:return E=e.sent,e.abrupt("return",E);case 44:e.next=49;break;case 46:return e.prev=46,e.t0=e.catch(1),e.abrupt("return",u({code:s.FAILURE,msg:e.t0}));case 49:case"end":return e.stop()}}),e,this,[[1,46]])}))),function(){return i.apply(this,arguments)})},{key:"onCreateShareLink",value:(o=Bs(Ps().mark((function e(t){var r,n,o,i,a,c,l,f,h,p,d,y,g,b,m,v,w,k,E,_,S;return Ps().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.isNumeric,n=t.UserID,o=t.Cid,i=t.AssetType,a=t.expireAt,c=t.shortPass,l=t.area_ids,f=t.hasDay,h=t.hasDomain,e.prev=1,d=r?"/groupPreview":"/distributionstatus",y="".concat(p="https://storage.titannet.io").concat(d,"?cid=").concat(o,"&AssetType=").concat(i,"&address=").concat(n),l&&l.length>0&&(g="area_id=".concat(encodeURIComponent(l.join(","))),y+="&".concat(g)),b=Math.floor(new Date(4101509461e3).getTime()/1e3),!a){e.next=12;break}if(!(m=L(a))){e.next=11;break}return e.abrupt("return",m);case 11:b=f?this.getFutureTimestamp(a):a;case 12:if(v="/api/v1/storage/create_link?username=".concat(n,"&cid=").concat(o,"&url=").concat(encodeURIComponent(y),"&expire_time=").concat(b),!c){e.next=18;break}if(!(w=x(c))){e.next=17;break}return e.abrupt("return",w);case 17:v+="&short_pass=".concat(c);case 18:return!r&&l&&l.length>0&&(k=l.map((function(e){return"area_id=".concat(encodeURIComponent(e))})).join("&"),v+="&".concat(k)),e.next=21,this.Http.getData(v);case 21:if(0!==(E=e.sent).code){e.next=31;break}return _="/api/v1/storage/share_status_set?user_id=".concat(n,"&cid=").concat(o),!r&&l&&l.length>0&&(S=l.map((function(e){return"area_id=".concat(encodeURIComponent(e))})).join("&"),_+="&".concat(S)),e.next=27,this.Http.getData(_);case 27:return E.data.url=h?"".concat(p).concat(encodeURI(E.data.url)):encodeURI(E.data.url),e.abrupt("return",u({code:E.code,msg:E.msg,data:E.data}));case 31:return e.abrupt("return",u({code:E.code,msg:E.msg,data:E.data}));case 32:e.next=37;break;case 34:return e.prev=34,e.t0=e.catch(1),e.abrupt("return",u({code:s.FAILURE,msg:e.t0}));case 37:case"end":return e.stop()}}),e,this,[[1,34]])}))),function(e){return o.apply(this,arguments)})},{key:"getFutureTimestamp",value:function(e){var t=new Date,r=new Date(t.getTime()+24*e*60*60*1e3);return Math.floor(r.getTime()/1e3)}},{key:"onUpdateShareLink",value:(n=Bs(Ps().mark((function e(t,r,n,o,i,a){var s,c,l,f,h,p,d,y,g,b,m,v;return Ps().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Http.getData("/api/v1/storage/share_link_info?username=".concat(t,"&cid=").concat(r));case 2:if(s=e.sent,c=s.data.link,l=c.id,f=c.short_pass,h=c.expire_at,p=c.short_link,d=f,y=new Date(h).getTime()/1e3,!o){e.next=11;break}if(!(g=x(o))){e.next=10;break}return e.abrupt("return",g);case 10:d=o;case 11:if(!n){e.next=16;break}if(!(b=L(n))){e.next=15;break}return e.abrupt("return",b);case 15:y=i?this.getFutureTimestamp(n):n;case 16:return m={id:l,expire_at:y,short_pass:d},e.next=19,this.Http.postData("/api/v1/storage/share_link_update",m);case 19:return 0==(v=e.sent).code&&(v.data.url=a?"https://storage.titannet.io"+encodeURI(p):encodeURI(p)),e.abrupt("return",u({code:v.code,msg:v.msg,data:v.data}));case 22:case"end":return e.stop()}}),e,this)}))),function(e,t,r,o,i,a){return n.apply(this,arguments)})}],t&&Us(e.prototype,t),r&&Us(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,n,o,i}();const Hs=Ms;function Gs(e){return Gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gs(e)}function $s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function qs(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$s(Object(r),!0).forEach((function(t){Vs(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Vs(e,t,r){return(t=Qs(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ys(){Ys=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),s=new R(n||[]);return o(a,"_invoke",{value:S(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",g={};function b(){}function m(){}function v(){}var w={};u(w,a,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(O([])));E&&E!==r&&n.call(E,a)&&(w=E);var _=v.prototype=b.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function r(o,i,a,s){var c=f(e[o],e,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==Gs(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function S(t,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=T(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function T(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,T(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function O(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Gs(t)+" is not iterable")}return m.prototype=v,o(_,"constructor",{value:v,configurable:!0}),o(v,"constructor",{value:m,configurable:!0}),m.displayName=u(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,u(e,c,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},x(L.prototype),u(L.prototype,s,(function(){return this})),t.AsyncIterator=L,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(_),u(_,c,"Generator"),u(_,a,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=O,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),I(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:O(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function Ws(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function Ks(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Ws(i,n,o,a,s,"next",e)}function s(e){Ws(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Js(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qs(n.key),n)}}function Qs(e){var t=function(e,t){if("object"!=Gs(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Gs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Gs(t)?t:t+""}var Zs=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Http=t},t=[{key:"updateToken",value:function(e){if(!("string"==typeof e&&e.trim().length>0))return u({code:s.BAD_REQUEST,msg:"Invalid API token provided."});this.Http.updateToken(e)}},{key:"onAreaId",value:(L=Ks(Ys().mark((function e(){return Ys().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.Http.getData("/api/v1/storage/get_area_id");case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",u({code:s.INTERNAL_SERVER_ERROR,msg:"Failed to get area ID: "+e.t0}));case 9:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(){return L.apply(this,arguments)})},{key:"onCreateGroup",value:(x=Ks(Ys().mark((function e(t,r){var n,o;return Ys().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(n=y(t))){e.next=5;break}return c(n),e.abrupt("return",n);case 5:if(!(o=k(r))){e.next=9;break}return c(o),e.abrupt("return",n);case 9:return e.next=11,this.Http.getData("/api/v1/storage/create_group?name=".concat(encodeURIComponent(t),"&parent=").concat(r));case 11:return e.abrupt("return",e.sent);case 14:return e.prev=14,e.t0=e.catch(0),e.abrupt("return",u({code:s.INTERNAL_SERVER_ERROR,msg:"Failed to create group: "+e.t0}));case 17:case"end":return e.stop()}}),e,this,[[0,14]])}))),function(e,t){return x.apply(this,arguments)})},{key:"onAssetGroupList",value:(w=Ks(Ys().mark((function e(t,r,n){var o,i,a;return Ys().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(o=k(r))){e.next=5;break}return c(o),e.abrupt("return",o);case 5:if(!(i=E(t))){e.next=9;break}return c(i),e.abrupt("return",i);case 9:if(!(a=_(n))){e.next=13;break}return c(a),e.abrupt("return",a);case 13:return e.next=15,this.Http.getData("/api/v1/storage/get_asset_group_list?page=".concat(t,"&parent=").concat(r,"&page_size=").concat(n));case 15:return e.abrupt("return",e.sent);case 18:return e.prev=18,e.t0=e.catch(0),e.abrupt("return",u({code:s.INTERNAL_SERVER_ERROR,msg:"Failed to asset list: "+e.t0}));case 21:case"end":return e.stop()}}),e,this,[[0,18]])}))),function(e,t,r){return w.apply(this,arguments)})},{key:"renameGroup",value:(v=Ks(Ys().mark((function e(){var t,r,n,o,i,a=arguments;return Ys().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:{groupId:-1,name:""},e.prev=1,!(r=y(t.name))){e.next=6;break}return c(r),e.abrupt("return",r);case 6:if(!(n=m(t.groupId))){e.next=9;break}return e.abrupt("return",n);case 9:return o={group_id:t.groupId,new_name:t.name},e.next=12,this.Http.postData("/api/v1/storage/rename_group",o);case 12:return c("TitanSDK:renameGroup:",i=e.sent),e.abrupt("return",i);case 17:return e.prev=17,e.t0=e.catch(1),e.abrupt("return",u({code:s.INTERNAL_SERVER_ERROR,msg:"Failed to rename group: "+e.t0}));case 20:case"end":return e.stop()}}),e,this,[[1,17]])}))),function(){return v.apply(this,arguments)})},{key:"renameAsset",value:(b=Ks(Ys().mark((function e(){var t,r,n,o,i,a=arguments;return Ys().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:{assetId:-1,name:""},e.prev=1,!(r=y(t.name))){e.next=6;break}return c(r),e.abrupt("return",r);case 6:if(!(n=g(t.assetId))){e.next=9;break}return e.abrupt("return",n);case 9:return o={asset_cid:t.assetId,new_name:t.name},e.next=12,this.Http.postData("/api/v1/storage/rename_group",o);case 12:return c("TitanSDK:renameAsset:",i=e.sent),e.abrupt("return",i);case 17:return e.prev=17,e.t0=e.catch(1),e.abrupt("return",u({code:s.INTERNAL_SERVER_ERROR,msg:"Failed to rename asset: "+e.t0}));case 20:case"end":return e.stop()}}),e,this,[[1,17]])}))),function(){return b.apply(this,arguments)})},{key:"deleteGroup",value:(d=Ks(Ys().mark((function e(){var t,r,n,o=arguments;return Ys().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:{groupId:-1},e.prev=1,!(r=m(t.groupId))){e.next=5;break}return e.abrupt("return",r);case 5:return e.next=7,this.Http.getData("/api/v1/storage/delete_group?group_id=".concat(t.groupId));case 7:return c("TitanSDK:deleteGroup:",n=e.sent),e.abrupt("return",n);case 12:return e.prev=12,e.t0=e.catch(1),e.abrupt("return",u({code:s.INTERNAL_SERVER_ERROR,msg:"Failed to delete group: "+e.t0}));case 15:case"end":return e.stop()}}),e,this,[[1,12]])}))),function(){return d.apply(this,arguments)})},{key:"getAssetGroupInfo",value:(p=Ks(Ys().mark((function e(){var t,r,n,o=arguments;return Ys().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:{cId:-1,groupId:-1},e.prev=1,-1!==t.cId||-1!==t.groupId){e.next=4;break}return e.abrupt("return",u({code:s.ID_KEY_EMPTY,msg:"At least one ID (cId or groupId) is required"}));case 4:if(!t.cId){e.next=12;break}return e.next=7,this.Http.getData("/api/v1/storage/get_asset_group_info?cid=".concat(t.cId));case 7:return c("TitanSDK:getAssetGroupInfo:",r=e.sent),e.abrupt("return",r);case 12:if(!t.groupId){e.next=18;break}return e.next=15,this.Http.getData("/api/v1/storage/get_asset_group_info?groupid=".concat(t.groupId));case 15:return c("TitanSDK:getAssetGroupInfo:",n=e.sent),e.abrupt("return",n);case 18:e.next=23;break;case 20:return e.prev=20,e.t0=e.catch(1),e.abrupt("return",u({code:s.INTERNAL_SERVER_ERROR,msg:""+e.t0}));case 23:case"end":return e.stop()}}),e,this,[[1,20]])}))),function(){return p.apply(this,arguments)})},{key:"deleteAsset",value:(h=Ks(Ys().mark((function e(){var t,r,n,o,i=arguments;return Ys().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:{assetId:-1,areaId:[]},e.prev=1,-1!==t.assetId){e.next=4;break}return e.abrupt("return",u({code:s.ID_KEY_EMPTY,msg:"Asset ID is required"}));case 4:return r="/api/v1/storage/delete_asset?asset_cid=".concat(t.assetId),t.areaId&&t.areaId.length>0&&(n=t.areaId.map((function(e){return"area_id=".concat(encodeURIComponent(e))})).join("&"),r+="&".concat(n)),e.next=8,this.Http.getData(r);case 8:return c("TitanSDK:deleteAsset:",o=e.sent),e.abrupt("return",o);case 13:return e.prev=13,e.t0=e.catch(1),e.abrupt("return",u({code:s.INTERNAL_SERVER_ERROR,msg:"Failed to delete asset: "+e.t0}));case 16:case"end":return e.stop()}}),e,this,[[1,13]])}))),function(){return h.apply(this,arguments)})},{key:"userInfo",value:(f=Ks(Ys().mark((function e(){var t,r,n,o,i;return Ys().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,this.Http.getData("/api/v1/storage/get_storage_size");case 4:return t=e.sent,e.next=8,this.Http.getData("/api/v1/storage/get_vip_info");case 8:return r=e.sent,e.next=12,this.Http.getData("/api/v1/storage/get_asset_count");case 12:return n=e.sent,o=qs(qs(qs({},t.data),r.data),n.data),c("TitanSDK:userInfo:",i={code:0,data:o}),e.abrupt("return",i);case 19:return e.prev=19,e.t0=e.catch(0),e.abrupt("return",u({code:s.INTERNAL_SERVER_ERROR,msg:"Failed to retrieve user information: "+e.t0}));case 22:case"end":return e.stop()}}),e,this,[[0,19]])}))),function(){return f.apply(this,arguments)})},{key:"onShare",value:(l=Ks(Ys().mark((function e(){var t,r,n=arguments;return Ys().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{id:null,expireAt:null,shortPass:"",hasDay:!1,hasDomain:!0},e.prev=1,r=new Hs(this.Http),e.abrupt("return",r.onShare(t));case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",u({code:s.INTERNAL_SERVER_ERROR,msg:""+e.t0}));case 9:case"end":return e.stop()}}),e,this,[[1,6]])}))),function(){return l.apply(this,arguments)})},{key:"getUploadAddresses",value:(a=Ks(Ys().mark((function e(){var t;return Ys().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.Http.getData("/api/v1/storage/get_upload_info?t="+(new Date).getTime());case 3:if(0===(t=e.sent).code){e.next=6;break}return e.abrupt("return",u({code:t.code,msg:"Failed to get upload addresses: "+t}));case 6:return e.abrupt("return",t.data.List);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",u({code:s.INTERNAL_SERVER_ERROR,msg:"Failed to get upload addresses: "+e.t0}));case 12:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return a.apply(this,arguments)})},{key:"createAsset",value:(i=Ks(Ys().mark((function e(t){var r;return Ys().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.Http.postData("/api/v1/storage/create_asset",t);case 3:if(0===(r=e.sent).code){e.next=6;break}return e.abrupt("return",u({code:r.code,msg:"Failed to create asset "}));case 6:return e.abrupt("return",r);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",u({code:s.INTERNAL_SERVER_ERROR,msg:"Failed to create asset: "+e.t0}));case 12:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e){return i.apply(this,arguments)})},{key:"onFileUpload",value:(o=Ks(Ys().mark((function e(t){var r,n,o,i=arguments;return Ys().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{areaId:[],groupId:0,assetType:0,extraId:"",retryCount:2},n=i.length>2?i[2]:void 0,o=i.length>3?i[3]:void 0,this.uploadLoader=new js(this.Http),e.next=6,this.uploadLoader.onFileUpload(t,r,n,o);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"onFileDown",value:(n=Ks(Ys().mark((function e(){var t,r,n,o,i,a,l,f,h,p,d,y,b,m,v,w,k,E,_,x=arguments;return Ys().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=x.length>1?x[1]:void 0,n=(t=x.length>0&&void 0!==x[0]?x[0]:{areaId:[],assetCid:"",assetType:"",userId:"",hasTempFile:!1,tempFileName:""}).assetCid,o=t.assetType,i=t.userId,a=t.areaId,l=t.hasTempFile,f=t.tempFileName,!(h=g(n))){e.next=6;break}return e.abrupt("return",h);case 6:return p="/api/v1/storage/share_asset?asset_cid="+n,i&&(p="/api/v1/storage/open_asset?user_id="+i+"&asset_cid="+n,a&&a.length>0&&(d=a.map((function(e){return"area_id=".concat(encodeURIComponent(e))})).join("&"),p+="&".concat(d))),l&&(p="/api/v1/storage/temp_file/download/"+n),e.next=11,this.Http.getData(p);case 11:if(0!==(y=e.sent).code){e.next=40;break}if(b=function(e){var t=new URL(e);return new URLSearchParams(t.search).get("filename")},m=y.data.url,(v=b(m[0]))||(v=f),w=y.data.size,k=y.data.trace_id,E=new W(this.Http),"folder"!=o){e.next=28;break}return e.next=23,E.downloadFromMultipleUrls(m,k,n,v,w,r);case 23:return c("downresult",_=e.sent),e.abrupt("return",_);case 28:if("file"!=o){e.next=37;break}return E.setProgressCallback((function(e){r&&r(e)})),e.next=32,E.downloadFile(m,k,n,v,w);case 32:return c("downresult.file",_=e.sent),e.abrupt("return",_);case 37:return e.abrupt("return",u({code:s.Dowload_Type_ERROR,msg:"Failed to downresult: "}));case 38:e.next=41;break;case 40:return e.abrupt("return",y);case 41:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}],t&&Js(e.prototype,t),r&&Js(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,n,o,i,a,l,f,h,p,d,b,v,w,x,L}();const Xs=Zs;function ec(e){return ec="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ec(e)}function tc(){tc=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),s=new R(n||[]);return o(a,"_invoke",{value:S(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",g={};function b(){}function m(){}function v(){}var w={};u(w,a,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(O([])));E&&E!==r&&n.call(E,a)&&(w=E);var _=v.prototype=b.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function r(o,i,a,s){var c=f(e[o],e,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==ec(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function S(t,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=T(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function T(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,T(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function O(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(ec(t)+" is not iterable")}return m.prototype=v,o(_,"constructor",{value:v,configurable:!0}),o(v,"constructor",{value:m,configurable:!0}),m.displayName=u(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,u(e,c,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},x(L.prototype),u(L.prototype,s,(function(){return this})),t.AsyncIterator=L,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(_),u(_,c,"Generator"),u(_,a,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=O,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),I(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:O(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function rc(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function nc(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){rc(i,n,o,a,s,"next",e)}function s(e){rc(i,n,o,a,s,"throw",e)}a(void 0)}))}}function oc(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ic(n.key),n)}}function ic(e){var t=function(e,t){if("object"!=ec(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ec(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ec(t)?t:t+""}var ac,sc,cc,uc=function(){function e(t){var r=t.token,n=t.url,o=t.debug,i=void 0!==o&&o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.commService=new Xs(new p(r,n,i)),this.debug=i}return t=e,r=[{key:"updateToken",value:(k=nc(tc().mark((function e(t){var r;return tc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.commService.updateToken(t),e.abrupt("return",r);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"listRegions",value:(w=nc(tc().mark((function e(){var t;return tc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.commService.onAreaId();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"createFolder",value:(v=nc(tc().mark((function e(){var t,r,n=arguments;return tc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{name:"",parent:0},e.next=3,this.commService.onCreateGroup(t.name,t.parent);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"listDirectoryContents",value:(m=nc(tc().mark((function e(){var t,r,n=arguments;return tc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{page:1,parent:0,pageSize:10},e.next=3,this.commService.onAssetGroupList(t.page,t.parent,t.pageSize);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"renameFolder",value:(b=nc(tc().mark((function e(){var t,r,n=arguments;return tc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{groupId:-1,name:""},e.next=3,this.commService.renameGroup(t);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"renameAsset",value:(g=nc(tc().mark((function e(){var t,r,n=arguments;return tc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{assetId:-1,name:""},e.next=3,this.commService.renameAsset(t);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"deleteFolder",value:(y=nc(tc().mark((function e(){var t,r,n=arguments;return tc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{groupId:-1},e.next=3,this.commService.deleteGroup(t);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"deleteAsset",value:(h=nc(tc().mark((function e(){var t,r,n=arguments;return tc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{assetId:-1,areaId:[]},e.next=3,this.commService.deleteAsset(t);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"getUserProfile",value:(f=nc(tc().mark((function e(){var t;return tc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.commService.userInfo();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"getltemDetails",value:(l=nc(tc().mark((function e(){var t,r,n=arguments;return tc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{cId:-1,groupId:-1},e.next=3,this.commService.getAssetGroupInfo(t);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"createSharedLink",value:(a=nc(tc().mark((function e(){var t,r,n=arguments;return tc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{id:null,expireAt:null,shortPass:"",hasDay:!1,hasDomain:!0},e.next=3,this.commService.onShare(t);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"uploadAsset",value:(i=nc(tc().mark((function e(t,r,n,o){var i;return tc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.commService.onFileUpload(t,r,n,o);case 2:return i=e.sent,e.abrupt("return",i);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return i.apply(this,arguments)})},{key:"downloadAsset",value:(o=nc(tc().mark((function e(){var t,r,n,o=arguments;return tc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{areaId:[],assetCid:"",assetType:"",userId:"",hasTempFile:!1,tempFileName:""},r=o.length>1?o[1]:void 0,e.next=4,this.commService.onFileDown(t,r);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})}],n=[{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{token:"",debug:!1,url:""};try{var r=d(t.token);if(r)return c(r),r;localStorage.setItem("titanOptions",JSON.stringify(t)),e.instance=new e(t);var n=u({code:s.SUCCESSFULLY});return c(n),n}catch(e){return u({code:s.InitSdk_ERROR})}}},{key:"getInstance",value:function(){if(!e.instance){var t=JSON.parse(localStorage.getItem("titanOptions")),r=d(t.token);r&&c(r),e.instance=new e(t)}return e.instance}}],r&&oc(t.prototype,r),n&&oc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n,o,i,a,l,f,h,y,g,b,m,v,w,k}();ac=uc,cc=null,(sc=ic(sc="instance"))in ac?Object.defineProperty(ac,sc,{value:cc,enumerable:!0,configurable:!0,writable:!0}):ac[sc]=cc;const lc=uc})(),__webpack_exports__=__webpack_exports__.default,__webpack_exports__})()));